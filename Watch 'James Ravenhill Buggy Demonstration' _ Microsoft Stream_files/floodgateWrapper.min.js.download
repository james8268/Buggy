!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.floodgateWrapper=e():t.floodgateWrapper=e()}(window,(function(){return n={},t.m=e={132:function(t,e,n){var i;window,i=function(){return function(t){function e(e){for(var i,a,s=e[0],u=e[1],l=e[2],d=0,p=[];d<s.length;d++)a=s[d],Object.prototype.hasOwnProperty.call(o,a)&&o[a]&&p.push(o[a][0]),o[a]=0;for(i in u)Object.prototype.hasOwnProperty.call(u,i)&&(t[i]=u[i]);for(c&&c(e);p.length;)p.shift()();return r.push.apply(r,l||[]),n()}function n(){for(var t,e=0;e<r.length;e++){for(var n=r[e],i=!0,s=1;s<n.length;s++){var u=n[s];0!==o[u]&&(i=!1)}i&&(r.splice(e--,1),t=a(a.s=n[0]))}return t}var i={},o={floodgateWrapper:0},r=[];function a(e){if(i[e])return i[e].exports;var n=i[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=t,a.c=i,a.d=function(t,e,n){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},a.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)a.d(n,i,function(e){return t[e]}.bind(null,i));return n},a.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="",Object.defineProperty(a,"p",{get:function(){try{if("string"!=typeof streamFullStaticPath)throw new Error("WebpackRequireFrom: 'streamFullStaticPath' is not a string or not available at runtime. See https://github.com/agoldis/webpack-require-from#troubleshooting");return streamFullStaticPath}catch(t){return""}}});var s=window.webpackJsonp_name_=window.webpackJsonp_name_||[],u=s.push.bind(s);s.push=e,s=s.slice();for(var l=0;l<s.length;l++)e(s[l]);var c=u;return r.push(["./common/FloodgateWrapper.ts","jumper.common"]),n()}({"./common/FloodgateWrapper.ts":function(t,e,n){var i=this&&this.__assign||function(){return(i=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};n("./node_modules/@ms-ofb/officebrowserfeedback/scripts/officebrowserfeedback_floodgate.js");var o=window,r=[{CampaignId:"0695bd4f-5108-4c46-b9f7-bf48c8c4d1bf",StartTimeUtc:"2019-08-28T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],NominationScheme:{Type:0,COMMENT:"33% of the population.",PercentageNumerator:1,PercentageDenominator:3,NominationPeriod:{Type:0,COMMENT:"Number of days: 30",IntervalSeconds:2592e3},CooldownPeriod:{Type:0,COMMENT:"Number of days: 90",IntervalSeconds:7776e3}},SurveyTemplate:{Type:0,ActivationEvent:{Type:1,Sequence:[{Type:0,COMMENT:"5 minutes of active usage.",IsAggregate:!0,Activity:"AppUsageTime",Count:300},{Type:0,COMMENT:"Next resume of your session.",IsAggregate:!1,Activity:"AppResumePortal",Count:1}]}}},{COMMENT:"Response url : https://ocv.microsoft.com/#/survey/8c56a64c-bf80-48ca-a5aa-deaa25d0c404/",CampaignId:"8c56a64c-bf80-48ca-a5aa-deaa25d0c404",StartTimeUtc:"2020-06-15T00:00:00Z",GovernedChannelType:0,Scope:{Type:0,Languages:[{Type:0,Value:"en-US"}]},NominationScheme:{Type:0,COMMENT:"30% of the population.",PercentageNumerator:1,PercentageDenominator:3,NominationPeriod:{Type:0,COMMENT:"Number of days: 30",IntervalSeconds:2592e3},CooldownPeriod:{Type:0,COMMENT:"Number of days: 90",IntervalSeconds:7776e3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,COMMENT:"Cummulative 5 minutes of active usage across sessions",IsAggregate:!0,Activity:"AppUsageTime",Count:300},{Type:0,COMMENT:"User paused a video or reached end of video on the web portal",Activity:"VideoPlayerPausePortal",IsAggregate:!1,Count:1}]},Content:{COMMENT:"Currently english only",Prompt:{Title:"Help us improve your viewing experience",Question:"We just have two questions for you.",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"What type of video were you watching?",RatingValuesAscending:["Other","Meeting","Training","Recorded lecture","Marketing communication","Leadership communication"]},Question:{Question:"What would have improved your experience and why? Make sure not to include personal information."}}},AdditionalDataRequested:["EmailAddress"]}];function a(){var t;o.OfficeBrowserFeedback.floodgate&&(o.OfficeBrowserFeedback.floodgate.start(),(t=o.OfficeBrowserFeedback.floodgate.getEngine())&&((t=t.getActivityListener()).logActivity("AppResume"),t.logActivityStartTime("AppUsageTime"),sessionInfo.IsEmbed?(t.logActivity("AppResumeEmbed"),t.logActivityStartTime("AppUsageTimeEmbed")):(t.logActivity("AppResumePortal"),t.logActivityStartTime("AppUsageTimePortal"))))}function s(){var t;o.OfficeBrowserFeedback.floodgate&&((t=o.OfficeBrowserFeedback.floodgate.getEngine())&&((t=t.getActivityListener()).logActivityStopTime("AppUsageTime"),sessionInfo.IsEmbed?t.logActivityStopTime("AppUsageTimeEmbed"):t.logActivityStopTime("AppUsageTimePortal")),o.OfficeBrowserFeedback.floodgate.stop())}o.initFloodgate=function(t){o.OfficeBrowserFeedback=o.OfficeBrowserFeedback||{},o.OfficeBrowserFeedback.floodgate=o.OfficeBrowserFeedback.floodgate||{},t=t||"en-us";var e=function(t){void 0===t&&(t={}),(t=t||{}).userSession_Id||(t.userSession_Id=sessionInfo.SessionId);var e={appData:JSON.stringify(t)},n="",o="";return sessionInfo&&(n=sessionInfo.PrincipalId,sessionInfo.UserClaim&&(o=sessionInfo.UserClaim.TenantId)),t=function(){var t=-1,e="{}",n="Unknown",i="Other";return portalConfiguration.ECSConfiguration&&portalConfiguration.ECSConfiguration.telemetryRecord&&(e=JSON.stringify(portalConfiguration.ECSConfiguration.telemetryRecord.configIds)||e,t=portalConfiguration.ECSConfiguration.telemetryRecord.ringId||t,n=portalConfiguration.ECSConfiguration.telemetryRecord.audience||n,i=portalConfiguration.ECSConfiguration.telemetryRecord.audienceGroup||i),{ringId:t,flights:e,flightSource:"ECS",audience:n,audienceGroup:i}}(),{application:e,telemetry:i({},t,{loggableUserId:n,platform:"web",tenantId:o,processSessionId:sessionInfo.ClientSessionId}),web:{dataCenter:portalConfiguration.ClusterName}}}();e={appId:2264,stylesUrl:portalConfiguration.BuildNumber+"/bundles/officebrowserfeedback.min.css",intlUrl:portalConfiguration.BuildNumber+"/bundles/",environment:portalConfiguration.IsDevelopmentMode?1:0,locale:t,primaryColour:"#93003D",secondaryColour:"#C30052",sessionId:sessionInfo.SessionId,build:portalConfiguration.BuildNumber,bugForm:!0,screenshot:!1,telemetryGroup:e.telemetry,applicationGroup:e.application,webGroup:e.web};sessionInfo.UserClaim&&sessionInfo.UserClaim.UserInfo&&sessionInfo.UserClaim.UserInfo.DisplayableId&&(e.userEmail=sessionInfo.UserClaim.UserInfo.DisplayableId),o.OfficeBrowserFeedback.initOptions=e,o.OfficeBrowserFeedback.floodgate.initOptions={autoDismiss:1,campaignDefinitions:r},o.OfficeBrowserFeedback.floodgate.initialize().then((function(){a()}),(function(t){console.error(t)})),window.onfocus=function(){a()},window.onblur=function(){s()},window.onunload=function(){s()}},o.initFloodgate(sessionInfo.UserLanguage)},"./node_modules/@ms-ofb/officebrowserfeedback/scripts/officebrowserfeedback_floodgate.js":function(t,e,n){(function(t){var e,i,o;function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}!function t(e,n,i){function o(a,s){if(!n[a]){if(!e[a]){if(r)return r(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}u=n[a]={exports:{}},e[a][0].call(u.exports,(function(t){return o(e[a][1][t]||t)}),u,u.exports,t,e,n,i)}return n[a].exports}for(var r=!1,a=0;a<i.length;a++)o(i[a]);return o}({1:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=t("./src/Api/Api");n.Api=i,t=t("./src/FloodgateEngine"),n.FloodgateEngine=t.FloodgateEngine},{"./src/Api/Api":5,"./src/FloodgateEngine":18}],2:[function(t,e,n){"use strict";var i,o=(r.prototype.getCount=function(t){return this.isValidIndex(t)?this.currentCounts[t]:0},r.prototype.getSessionCount=function(t){return this.isValidIndex(t)?this.currentSessionCounts[t]:0},r.prototype.getStartTime=function(t){return this.isValidIndex(t)?this.currentStartTimes[t]:null},r.prototype.moveSessionCountIntoBaseCount=function(t){if(!this.isValidIndex(t))return 0;var e=this.currentSessionCounts[t];return this.currentSessionCounts[t]=0,e},r.prototype.initCounts=function(t,e,n){void 0===n&&(n=!1);for(var i=0;i<this.trackedActivities.length&&!(this.isOrdered&&i>this.currentIndex);i++)i<e.length&&e[i]&&(this.currentSessionCounts[i]=this.currentCounts[i]=e[i].tracker.getSessionCount(e[i].index),this.currentStartTimes[i]=e[i].tracker.getStartTime(e[i].index)),this.trackedActivities[i].getIsAggregate()&&i<t.length&&(this.currentCounts[i]+=t[i]),this.hasCountCrossedThreshold(i)&&this.finishActivityAtIndex(i);this.isActivated()&&!n&&(this.isActivationByInitPending=!0)},r.prototype.generateActivityIndexList=function(){for(var t=new Array,e=0;e<this.trackedActivities.length;e++){var n=new r.ActivityIndex;n.activity=this.trackedActivities[e].getActivity(),n.index=e,t.push(n)}return t},r.prototype.incrementActivity=function(t,e){if(!this.isValidIndex(t))return r.IncrementResult.Pending;if(e<0)throw new Error("increment must be non-negative");if(this.isOrdered&&t>this.currentIndex)return r.IncrementResult.Pending;var n=!this.hasCountCrossedThreshold(t);return this.currentCounts[t]+=e,this.currentSessionCounts[t]+=e,this.isActivationByInitPending?this.isPermittedIndexForActivationByInit(t)?this.commitActivation():r.IncrementResult.Pending:n&&this.hasCountCrossedThreshold(t)?(this.finishActivityAtIndex(t),this.isActivated()?this.commitActivation():r.IncrementResult.SingleActivityActivated):r.IncrementResult.Pending},r.prototype.startTime=function(t,e){this.isValidIndex(t)&&(this.currentStartTimes[t]=e||new Date)},r.prototype.stopTime=function(t,e){if(!this.isValidIndex(t))return 0;var n=this.currentStartTimes[t];return this.currentStartTimes[t]=null,!n||(e=e||new Date)<n?0:(e.getTime()-n.getTime())/1e3},r.prototype.isValidIndex=function(t){return t<this.trackedActivities.length},r.prototype.isActivated=function(){return(this.currentActivationFlags&this.activationMask)===this.activationMask},r.prototype.finishActivityAtIndex=function(t){if(!this.isValidIndex(t))throw new Error("Index is not valid");this.currentActivationFlags|=1<<t,t+1<this.trackedActivities.length&&(this.currentIndex=t+1)},r.prototype.hasCountCrossedThreshold=function(t){if(!this.isValidIndex(t))throw new Error("Index is not valid");return this.currentCounts[t]>=this.trackedActivities[t].getCount()},r.prototype.isPermittedIndexForActivationByInit=function(t){return!this.isOrdered||t+1===this.currentCounts.length},r.prototype.commitActivation=function(){return this.isActivationByInitPending=!1,r.IncrementResult.AllActivitiesActivated},r);function r(t){if(!t)throw new Error("trackingSet must not be null");if(32<t.getList().length)throw new Error("trackingSet list size must be less than 32");this.isOrdered=t.getIsOrdered(),this.trackedActivities=t.getList(),this.currentIndex=0,this.activationMask=0,this.currentActivationFlags=0,this.isActivationByInitPending=!1,this.currentCounts=new Array(this.trackedActivities.length),this.currentStartTimes=new Array(this.trackedActivities.length),this.currentSessionCounts=new Array(this.trackedActivities.length);for(var e=0;e<this.trackedActivities.length;e++)this.currentCounts[e]=0,this.currentSessionCounts[e]=0;for(e=0;e<this.trackedActivities.length;e++)this.activationMask|=1<<e,this.trackedActivities[e].getCount()<1&&this.trackedActivities[e].setCount(1)}(i=o=o||{}).ActivityIndex=function(){},(i=i.IncrementResult||(i.IncrementResult={}))[i.Pending=0]="Pending",i[i.SingleActivityActivated=1]="SingleActivityActivated",i[i.AllActivitiesActivated=2]="AllActivitiesActivated",e.exports=o},{}],3:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=(o.prototype.getActivity=function(){return this.activity},o.prototype.getCount=function(){return this.count},o.prototype.setCount=function(t){this.count=t},o.prototype.getIsAggregate=function(){return this.isAggregate},o);function o(t,e,n){this.activity=t,this.count=e,this.isAggregate=n}n.ActivityTrackingData=i},{}],4:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=(o.prototype.getIsOrdered=function(){return this.isOrdered},o.prototype.getList=function(){return this.list},o);function o(t,e){this.isOrdered=t,this.list=e}n.ActivityTrackingSet=i},{}],5:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=t("./../ISurveyInfo");n.ISurveyInfo=i,i=t("./IActivityListener"),n.IActivityListener=i,i=t("./IFloodgateSettingIdMap"),n.IFloodgateSettingIdMap=i,i=t("./IFloodgateStorageProvider"),n.IFloodgateStorageProvider=i,i=t("./IFloodgateStringProvider"),n.IFloodgateStringProvider=i,i=t("./ISurvey"),n.ISurvey=i,i=t("./ISurveyComponent"),n.ISurveyComponent=i,t=t("../Campaign/CampaignDefinitionProvider"),n.CampaignDefinition=t.CampaignDefinition},{"../Campaign/CampaignDefinitionProvider":13,"./../ISurveyInfo":24,"./IActivityListener":6,"./IFloodgateSettingIdMap":7,"./IFloodgateStorageProvider":8,"./IFloodgateStringProvider":9,"./ISurvey":11,"./ISurveyComponent":12}],6:[function(t,e,n){"use strict";var i,o,r;function a(){}o=i=i||{},a.AppLaunch="AppLaunch",a.AppUsageTime="AppUsageTime",a.AppResume="AppResume",r=a,o.ActivityName=r,e.exports=i},{}],7:[function(t,e,n){"use strict";var i;(i=i||{}).RoamingSettingIdMap={CampaignStates:1258,GovernedChannelStates:1257,SurveyActivationStats:1259},e.exports=i},{}],8:[function(t,e,n){"use strict";var i,o;(o=(o=i=i||{}).FileType||(o.FileType={}))[o.FloodgateSettings=0]="FloodgateSettings",o[o.SurveyActivationStats=1]="SurveyActivationStats",o[o.SurveyEventActivityStats=2]="SurveyEventActivityStats",o[o.CampaignDefinitions=3]="CampaignDefinitions",o[o.CampaignStates=4]="CampaignStates",o[o.GovernedChannelStates=5]="GovernedChannelStates",o[o.TmsCache_MessageMetadata=6]="TmsCache_MessageMetadata",o[o.TmsCache_UserGovernance=7]="TmsCache_UserGovernance",o[o.TmsCache_CampaignContent=8]="TmsCache_CampaignContent",o[o.Tms_DynamicSettings=9]="Tms_DynamicSettings",o[o.LogLevelSettings=10]="LogLevelSettings",e.exports=i},{}],9:[function(t,e,n){"use strict";var i,o;(o=(o=i=i||{}).StringType||(o.StringType={}))[o.NpsPromptTitle=0]="NpsPromptTitle",o[o.NpsPromptQuestion=1]="NpsPromptQuestion",o[o.NpsPromptYesLabel=2]="NpsPromptYesLabel",o[o.NpsPromptNotNowLabel=3]="NpsPromptNotNowLabel",o[o.NpsRatingQuestion=4]="NpsRatingQuestion",o[o.Nps11RatingValue0=5]="Nps11RatingValue0",o[o.Nps11RatingValue1=6]="Nps11RatingValue1",o[o.Nps11RatingValue2=7]="Nps11RatingValue2",o[o.Nps11RatingValue3=8]="Nps11RatingValue3",o[o.Nps11RatingValue4=9]="Nps11RatingValue4",o[o.Nps11RatingValue5=10]="Nps11RatingValue5",o[o.Nps11RatingValue6=11]="Nps11RatingValue6",o[o.Nps11RatingValue7=12]="Nps11RatingValue7",o[o.Nps11RatingValue8=13]="Nps11RatingValue8",o[o.Nps11RatingValue9=14]="Nps11RatingValue9",o[o.Nps11RatingValue10=15]="Nps11RatingValue10",o[o.Nps5RatingValue1=16]="Nps5RatingValue1",o[o.Nps5RatingValue2=17]="Nps5RatingValue2",o[o.Nps5RatingValue3=18]="Nps5RatingValue3",o[o.Nps5RatingValue4=19]="Nps5RatingValue4",o[o.Nps5RatingValue5=20]="Nps5RatingValue5",o[o.NpsCommentQuestion=21]="NpsCommentQuestion",o[o.PsatPromptTitle=22]="PsatPromptTitle",o[o.PsatPromptQuestion=23]="PsatPromptQuestion",o[o.PsatPromptYesLabel=24]="PsatPromptYesLabel",o[o.PsatPromptNotNowLabel=25]="PsatPromptNotNowLabel",o[o.PsatRatingQuestion=26]="PsatRatingQuestion",o[o.PsatRatingValue1=27]="PsatRatingValue1",o[o.PsatRatingValue2=28]="PsatRatingValue2",o[o.PsatRatingValue3=29]="PsatRatingValue3",o[o.PsatRatingValue4=30]="PsatRatingValue4",o[o.PsatRatingValue5=31]="PsatRatingValue5",o[o.PsatCommentQuestion=32]="PsatCommentQuestion",o[o.BpsPromptTitle=33]="BpsPromptTitle",o[o.BpsPromptQuestion=34]="BpsPromptQuestion",o[o.BpsPromptYesLabel=35]="BpsPromptYesLabel",o[o.BpsPromptNotNowLabel=36]="BpsPromptNotNowLabel",o[o.BpsRatingQuestion=37]="BpsRatingQuestion",o[o.BpsRatingValue1=38]="BpsRatingValue1",o[o.BpsRatingValue2=39]="BpsRatingValue2",o[o.BpsCommentQuestion=40]="BpsCommentQuestion",e.exports=i},{}],10:[function(t,e,n){"use strict";var i,o;(o=(o=i=i||{}).PromptButton||(o.PromptButton={}))[o.Unselected=0]="Unselected",o[o.Yes=1]="Yes",o[o.No=2]="No",e.exports=i},{}],11:[function(t,e,n){"use strict";var i,o,r;(r=(o=i=i||{}).Type||(o.Type={}))[r.Feedback=0]="Feedback",r[r.Nps=1]="Nps",r[r.Psat=2]="Psat",r[r.Bps=3]="Bps",r[r.Fps=4]="Fps",r[r.Nlqs=5]="Nlqs",r[r.GenericMessagingSurface=12]="GenericMessagingSurface",o.DOM_FEEDBACKSURVEY_TAGNAME="FeedbackSurvey",o.DOM_NPS_TAGNAME="Nps",o.DOM_PSAT_TAGNAME="Psat",o.DOM_BPS_TAGNAME="Bps",o.DOM_FPS_TAGNAME="Fps",o.DOM_NLQS_TAGNAME="Nlqs",o.LAUNCHER_TYPE_DEFAULT="survey",e.exports=i},{}],12:[function(t,e,n){"use strict";var i,o,r;(r=(o=i=i||{}).Type||(o.Type={}))[r.Prompt="Prompt"]="Prompt",r[r.Comment="Comment"]="Comment",r[r.Rating="Rating"]="Rating",r[r.MultipleChoice="MultipleChoice"]="MultipleChoice",o.DOM_PROMPT_TAGNAME="Prompt",o.DOM_COMMENT_TAGNAME="Comment",o.DOM_RATING_TAGNAME="Rating",o.DOM_MULTIPLECHOICE_TAGNAME="MultipleChoice",o.JSON_PROMPT_KEYNAME="prompt",o.JSON_PROMPTTITLE_KEYNAME="title",o.JSON_PROMPTYESTEXT_KEYNAME="yesButtonText",o.JSON_PROMPTNOTEXT_KEYNAME="noButtonText",o.JSON_COMMENT_KEYNAME="comment",o.JSON_RATING_KEYNAME="rating",o.JSON_RATINGOPTIONS_KEYNAME="options",o.JSON_QUESTION_KEYNAME="question",o.JSON_MULTIPLECHOICE_KEYNAME="multipleChoice",o.JSON_APPLICATION_KEYNAME="application",o.JSON_EXTENDEDMANIFESTDATA_KEYNAME="extendedManifestData",o.JSON_SURVEYSTRINGS_KEYNAME="surveyStrings",o.JSON_SURVEYSPECIFICDATA_KEYNAME="surveySpecificData",e.exports=i},{}],13:[function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var r=t("../Api/IFloodgateStorageProvider"),a=t("../FloodgateEngine"),s=t("../GovernedChannel"),u=t("../ISurveyInfo"),l=t("../Utils"),c=t("es6-promise"),d=(p.deserialize=function(t){var e;return t&&0===t.Type&&(e=f.deserialize(t)),void 0===e?null:e},p.prototype.validate=function(){return!0},p);function p(){}n.CampaignLanguageRange=d;var g,f=(o(h,g=d),h.deserialize=function(t){var e=new h;return t&&(e.languageSubTag=t.Value),e.validate()?e:null},h.prototype.isInRange=function(t){return!l.isNullOrUndefined(t)&&(t=l.extractLanguageSubtag(t),!l.isNullOrUndefined(t)&&t.toLocaleUpperCase()===this.languageSubTag.toLocaleUpperCase())},h.prototype.validate=function(){return!(!g.prototype.validate.call(this)||l.isNullOrUndefined(this.languageSubTag)||!l.isString(this.languageSubTag)||!l.isValidLanguageSubTag(this.languageSubTag))},h);function h(){return g.call(this)||this}n.CampaignLanguageRangeLanguageSubtag=f;var m=(v.deserialize=function(t){var e;if(l.isNullOrUndefined(t))return null;switch(t.Type){case 0:e=S.deserialize(t);break;case 1:e=T.deserialize(t)}return void 0===e?null:e},v.prototype.validate=function(){return!0},v);function v(){}n.CampaignScope=m;var y,S=(o(b,y=m),b.deserialize=function(t){return new b},b.prototype.isInScope=function(t){return!0},b.prototype.validate=function(){return!!y.prototype.validate.call(this)},b);function b(){return y.call(this)||this}n.CampaignScopeAny=S;var C,T=(o(w,C=m),w.deserialize=function(t){var e,n,i=new w,o=[];if(l.isNullOrUndefined(t))return null;for(e in t.Languages)!t.Languages.hasOwnProperty(e)||(n=t.Languages[e])&&o.push(d.deserialize(n));return 0===o.length&&(o=null),i.languageRanges=o,i.validate()?i:null},w.prototype.isInScope=function(t){if(l.isNullOrUndefined(this.languageRanges))return!0;if(l.isNullOrUndefined(t)||!t.getLanguage())return!1;for(var e in this.languageRanges)if(this.languageRanges.hasOwnProperty(e)&&this.languageRanges[e].isInRange(t.getLanguage()))return!0;return!1},w.prototype.validate=function(){if(!C.prototype.validate.call(this))return!1;if(this.languageRanges)for(var t in this.languageRanges)if(this.languageRanges.hasOwnProperty(t)&&!this.languageRanges[t])return!1;return!0},w);function w(){return C.call(this)||this}n.CampaignScopeEnvironmentCrossProduct=T;var I=(A.deserialize=function(t){var e;if(l.isNullOrUndefined(t))return null;switch(t.Type){case 0:e=F.deserialize(t);break;case 1:e=N.deserialize(t)}return void 0===e?null:e},A.prototype.validate=function(){return!0},A);function A(){}n.CampaignDuration=I;var E,F=(o(_,E=I),_.deserialize=function(t){var e=new _;return t&&(e.intervalSeconds=t.IntervalSeconds),e.validate()?e:null},_.prototype.asTimeIntervalSeconds=function(){return this.intervalSeconds},_.prototype.validate=function(){return!!E.prototype.validate.call(this)&&!!l.isNumber(this.intervalSeconds)},_);function _(){return E.call(this)||this}n.CampaignDurationTimeInterval=F;var O,N=(o(D,O=I),D.deserialize=function(t){return new D},D.prototype.asTimeIntervalSeconds=function(){return null},D);function D(){return O.call(this)||this}n.CampaignDurationSingleBuildChange=N;var x=(P.deserialize=function(t){var e=new P;if(!l.isNullOrUndefined(t)){e.additionalData=[];for(var n=0,i=t;n<i.length;n++)"EmailAddress"===i[n]&&e.additionalData.push(u.AdditionalDataType.EmailAddress)}return e.validate()?e:null},P.prototype.validate=function(){return!l.isNullOrUndefined(this.additionalData)},P);function P(){}n.CampaignAdditionalDataRequested=x;var L=(U.deserialize=function(t){var e;return t&&0===t.Type&&(e=B.deserialize(t)),void 0===e?null:e},U.prototype.validate=function(){return!0},U);function U(){}n.CampaignDistribution=L;var k,B=(o(M,k=L),M.deserialize=function(t){var e=new M;return t&&(e.maxDelaySeconds=t.MaxDelaySeconds,e.chunks=t.Chunks),e.validate()?e:null},M.prototype.validate=function(){return!(!k.prototype.validate.call(this)||!l.isNumber(this.maxDelaySeconds)||this.maxDelaySeconds<0||!l.isNumber(this.chunks)||this.chunks<0)},M);function M(){return k.call(this)||this}n.CampaignDistributionRamp=B;var R=(V.deserialize=function(t){var e;return t&&0===t.Type&&(e=j.deserialize(t)),void 0===e?null:e},V.prototype.getActiveSurveyTimeIntervalSeconds=function(){var t=this.nominationPeriod.asTimeIntervalSeconds();return l.isNumber(t)?t:this.fallbackSurveyDurationSeconds},V.prototype.calculateSurveyStartTimeFromDate=function(t){return t||new Date},V.prototype.calculateSurveyExpirationTimeFromSurveyStartTime=function(t){return t=t||new Date,l.addSecondsWithoutOverflow(t,this.getActiveSurveyTimeIntervalSeconds())},V.prototype.getCampaignCooldown=function(t){return t?this.cooldownPeriod:this.nominationPeriod},V.prototype.validate=function(){return!(l.isNullOrUndefined(this.nominationPeriod)||(l.isNullOrUndefined(this.cooldownPeriod)&&(this.cooldownPeriod=this.nominationPeriod),!l.isNumber(this.nominationPeriod.asTimeIntervalSeconds())&&(!l.isNumber(this.fallbackSurveyDurationSeconds)||this.fallbackSurveyDurationSeconds<=0)))},V);function V(){}n.CampaignNominationScheme=R;var G,j=(o(z,G=R),z.deserialize=function(t){var e=new z;return l.isNullOrUndefined(t)?null:(t.DistributionModel&&(e.distributionModel=L.deserialize(t.DistributionModel)),t.CooldownPeriod&&(e.cooldownPeriod=I.deserialize(t.CooldownPeriod)),t.NominationPeriod&&(e.nominationPeriod=I.deserialize(t.NominationPeriod)),e.fallbackSurveyDurationSeconds=t.FallbackSurveyDurationSeconds,e.percentageDenominator=t.PercentageDenominator,e.percentageNumerator=t.PercentageNumerator,e.validate()?e:null)},z.prototype.evaluateNominationRules=function(){var t=Math.random();return Math.floor(t*this.percentageDenominator)<this.percentageNumerator},z.prototype.validate=function(){return!(!G.prototype.validate.call(this)||!l.isNumber(this.percentageDenominator)||!l.isNumber(this.percentageNumerator)||this.percentageDenominator<=0||this.percentageNumerator<0||this.percentageNumerator>this.percentageDenominator)},z);function z(){return G.call(this)||this}n.CampaignNominationSchemeRatioPercentage=j;var W=(q.deserialize=function(t){var e;if(l.isNullOrUndefined(t))return null;switch(t.Type){case 0:e=J.deserialize(t);break;case 1:e=K.deserialize(t)}return void 0===e?null:e},q.prototype.validate=function(){return!0},q);function q(){}n.CampaignSurveyEvent=W;var H,J=(o(Q,H=W),Q.deserialize=function(t){var e=new Q;return l.isNullOrUndefined(t)?null:(e.activity=t.Activity,e.count=t.Count,e.isAggregate=t.IsAggregate,e.validate()?e:null)},Q.prototype.validate=function(){return!(!H.prototype.validate.call(this)||l.isNullOrUndefined(this.activity)||!l.isString(this.activity)||!l.isNumber(this.count)||this.count<=0||!l.isBoolean(this.isAggregate))},Q);function Q(){return H.call(this)||this}n.CampaignSurveyEventCountedActivity=J;var Y,K=(o(X,Y=W),X.deserialize=function(t){var e,n,i=new X,o=[];if(l.isNullOrUndefined(t))return null;for(e in t.Sequence)!t.Sequence.hasOwnProperty(e)||(n=t.Sequence[e])&&o.push(J.deserialize(n));return 0===o.length&&(o=null),i.sequence=o,i.validate()?i:null},X.prototype.validate=function(){if(!Y.prototype.validate.call(this))return!1;if(l.isNullOrUndefined(this.sequence))return!1;for(var t in this.sequence)if(this.sequence.hasOwnProperty(t)&&!this.sequence[t])return!1;return!0},X);function X(){return Y.call(this)||this}n.CampaignSurveyEventCountedActivitySequence=K;var Z=($.deserialize=function(t,e){var n=new $;return l.isNullOrUndefined(t)?null:(n.prompt=nt.deserialize(t.Prompt),n.rating=ot.deserialize(t.Rating),n.comment=at.deserialize(t.Question),n.multipleChoice=tt.deserialize(t.MultipleChoice),n.validate(e)?n:null)},$.prototype.validate=function(t){return!(l.isNullOrUndefined(this.prompt)||(t?l.isNullOrUndefined(this.rating)&&l.isNullOrUndefined(this.multipleChoice)&&l.isNullOrUndefined(this.comment):l.isNullOrUndefined(this.rating)||l.isNullOrUndefined(this.comment)))},$);function $(){}n.CampaignSurveyContent=Z;var tt=(et.deserialize=function(t){var e=new et;return l.isNullOrUndefined(t)?null:(e.question=t.Question,e.availableOptions=t.AvailableOptions,e.minNumberOfSelectedOptions=t.MinNumberOfSelectedOptions,e.maxNumberOfSelectedOptions=t.MaxNumberOfSelectedOptions,e.validate()?e:null)},et.prototype.validate=function(){if(l.isNullOrUndefined(this.question)||!l.isString(this.question)||l.isNullOrUndefined(this.availableOptions)||!Array.isArray(this.availableOptions)||this.availableOptions.length<2||l.isNullOrUndefined(this.minNumberOfSelectedOptions)||!l.isNumber(this.minNumberOfSelectedOptions)||l.isNullOrUndefined(this.maxNumberOfSelectedOptions)||!l.isNumber(this.maxNumberOfSelectedOptions))return!1;for(var t in this.availableOptions)if(this.availableOptions.hasOwnProperty(t)&&!l.isString(this.availableOptions[t]))return!1;return!0},et);function et(){}n.CampaignSurveyContentMultipleChoice=tt;var nt=(it.deserialize=function(t){var e=new it;return l.isNullOrUndefined(t)?null:(e.title=t.Title,e.question=t.Question,e.yesLabel=t.YesLabel,e.noLabel=t.NoLabel,e.validate()?e:null)},it.prototype.validate=function(){return!(l.isNullOrUndefined(this.title)||!l.isString(this.title)||l.isNullOrUndefined(this.question)||!l.isString(this.question)||l.isNullOrUndefined(this.yesLabel)||!l.isString(this.yesLabel)||l.isNullOrUndefined(this.noLabel)||!l.isString(this.noLabel))},it);function it(){}n.CampaignSurveyContentPrompt=nt;var ot=(rt.deserialize=function(t){var e=new rt;return l.isNullOrUndefined(t)?null:(e.isZeroBased=t.IsZeroBased,e.question=t.Question,e.ratingValuesAscending=t.RatingValuesAscending,e.validate()?e:null)},rt.prototype.validate=function(){if(l.isNullOrUndefined(this.question)||!l.isString(this.question)||l.isNullOrUndefined(this.ratingValuesAscending)||!Array.isArray(this.ratingValuesAscending)||this.ratingValuesAscending.length<2||11<this.ratingValuesAscending.length)return!1;if(l.isNullOrUndefined(this.isZeroBased))this.isZeroBased=!1;else if(!l.isBoolean(this.isZeroBased))return!1;for(var t in this.ratingValuesAscending)if(this.ratingValuesAscending.hasOwnProperty(t)&&!l.isString(this.ratingValuesAscending[t]))return!1;return!0},rt);function rt(){}n.CampaignSurveyContentRating=ot;var at=(st.deserialize=function(t){var e=new st;return l.isNullOrUndefined(t)?null:(e.question=t.Question,e.validate()?e:null)},st.prototype.validate=function(){return!(l.isNullOrUndefined(this.question)||!l.isString(this.question))},st);function st(){}n.CampaignSurveyContentComment=at;var ut=(lt.deserialize=function(t){if(l.isNullOrUndefined(t))return null;var e=new lt;return e.contentMetadata=t.ContentMetadata,e.validate()?e:null},lt.prototype.validate=function(){return!(l.isNullOrUndefined(this.contentMetadata)||!l.isObject(this.contentMetadata))},lt);function lt(){}n.CampaignSurveyMetadata=ut;var ct=(dt.deserialize=function(t){var e;if(l.isNullOrUndefined(t))return null;switch(t.Type){case dt.Type.Nps5PointStatic:e=Tt.deserialize(t);break;case dt.Type.Nps11PointStatic:e=At.deserialize(t);break;case dt.Type.Fps:e=gt.deserialize(t);break;case dt.Type.Nlqs:e=mt.deserialize(t);break;case dt.Type.Nps:e=St.deserialize(t);break;case dt.Type.GenericMessagingSurface:e=_t.deserialize(t)}return void 0===e?null:e},dt.prototype.validate=function(){return!l.isNullOrUndefined(this.activationEvent)},dt);function dt(){}n.CampaignSurveyTemplate=ct,(t=(t=ct=n.CampaignSurveyTemplate||(n.CampaignSurveyTemplate={})).Type||(t.Type={}))[t.Nps5PointStatic=0]="Nps5PointStatic",t[t.Nps11PointStatic=1]="Nps11PointStatic",t[t.Fps=2]="Fps",t[t.Nlqs=3]="Nlqs",t[t.Nps=4]="Nps",t[t.GenericMessagingSurface=22]="GenericMessagingSurface",n.CampaignSurveyTemplate=ct;var pt,gt=(o(ft,pt=ct),ft.deserialize=function(t){var e=new ft;return l.isNullOrUndefined(t)?null:(e.activationEvent=W.deserialize(t.ActivationEvent),e.content=Z.deserialize(t.Content,!0),e.validate()?e:null)},ft.prototype.validate=function(){return!(!pt.prototype.validate.call(this)||l.isNullOrUndefined(this.content))},ft);function ft(){return pt.call(this)||this}n.CampaignSurveyTemplateFps=gt;var ht,mt=(o(vt,ht=ct),vt.deserialize=function(t){var e=new vt;return l.isNullOrUndefined(t)?null:(e.activationEvent=W.deserialize(t.ActivationEvent),e.content=Z.deserialize(t.Content),e.validate()?e:null)},vt.prototype.validate=function(){return!(!ht.prototype.validate.call(this)||l.isNullOrUndefined(this.content))},vt);function vt(){return ht.call(this)||this}n.CampaignSurveyTemplateNlqs=mt;var yt,St=(o(bt,yt=ct),bt.deserialize=function(t){var e=new bt;return l.isNullOrUndefined(t)?null:(e.activationEvent=W.deserialize(t.ActivationEvent),e.content=Z.deserialize(t.Content),e.validate()?e:null)},bt.prototype.validate=function(){return!(!yt.prototype.validate.call(this)||l.isNullOrUndefined(this.content))},bt);function bt(){return yt.call(this)||this}n.CampaignSurveyTemplateNps=St;var Ct,Tt=(o(wt,Ct=ct),wt.deserialize=function(t){var e=new wt;return l.isNullOrUndefined(t)?null:(e.activationEvent=W.deserialize(t.ActivationEvent),e.validate()?e:null)},wt.prototype.validate=function(){return!!Ct.prototype.validate.call(this)},wt);function wt(){return Ct.call(this)||this}n.CampaignSurveyTemplateNps5PointStatic=Tt;var It,At=(o(Et,It=ct),Et.deserialize=function(t){var e=new Et;return l.isNullOrUndefined(t)?null:(e.activationEvent=W.deserialize(t.ActivationEvent),e.validate()?e:null)},Et.prototype.validate=function(){return!!It.prototype.validate.call(this)},Et);function Et(){return It.call(this)||this}n.CampaignSurveyTemplateNps11PointStatic=At;var Ft,_t=(o(Ot,Ft=ct),Ot.deserialize=function(t){if(l.isNullOrUndefined(t))return null;var e=new Ot;return e.activationEvent=W.deserialize(t.ActivationEvent),e.metadata=ut.deserialize(t.Metadata),e.validate()?e:null},Ot.prototype.validate=function(){return!(!Ft.prototype.validate.call(this)||l.isNullOrUndefined(this.metadata))},Ot);function Ot(){return Ft.call(this)||this}n.CampaignSurveyTemplateGenericMessagingSurface=_t;var Nt=(Dt.deserialize=function(t){var e=new Dt;if(l.isNullOrUndefined(t))return null;e.campaignId=t.CampaignId,e.governedChannelType=t.GovernedChannelType,e.startTime=t.StartTimeUtc,e.endTime=t.EndTimeUtc,e.launcherType=t.LauncherType;var n=x.deserialize(t.AdditionalDataRequested);return e.additionalDataRequested=n?n.additionalData:[],t.SurveyTemplate&&(e.surveyTemplate=ct.deserialize(t.SurveyTemplate)),t.NominationScheme&&(e.nominationScheme=R.deserialize(t.NominationScheme)),t.Scope&&(e.scope=m.deserialize(t.Scope)),e.validate()?e:null},Dt.prototype.validate=function(){if(l.isNullOrUndefined(this.scope)&&(this.scope=new S),l.isNullOrUndefined(this.campaignId)||!l.isString(this.campaignId))return!1;if(!l.isNumber(this.governedChannelType)||!l.isEnumValue(this.governedChannelType,s.GovernedChannelType))return!1;if(l.isNullOrUndefined(this.nominationScheme))return!1;if(l.isNullOrUndefined(this.surveyTemplate))return!1;if(!l.isNullOrUndefined(this.launcherType)&&!l.isString(this.launcherType))return!1;if(l.isNullOrUndefined(this.startTime))this.startTime=l.getDistantFuture();else{if(!l.isUtcDatetimeString(this.startTime))return!1;this.startTime=l.stringToDate(this.startTime)}if(l.isNullOrUndefined(this.endTime))this.endTime=l.getDistantFuture();else{if(!l.isUtcDatetimeString(this.endTime))return!1;this.endTime=l.stringToDate(this.endTime)}return!0},Dt);function Dt(){}function xt(t){var e=[];if(l.isNullOrUndefined(t))return{result:e,error:"Empty"};if(!Array.isArray(t))return{result:e,error:"Not an array"};for(var n=[],i=0;i<t.length;i++){var o,r=t[i];r&&(o=Nt.deserialize(r))?e.push(o):n.push(i)}return{result:e,error:0<n.length?"Invalid campaign definitions at indexes: "+n.toString():void 0}}function Pt(t){if(l.isNullOrUndefined(t))throw new Error("storage must not be null");this.storage=t}n.CampaignDefinition=Nt,n.FilterValidCampaignDefinitions=xt,Pt.prototype.load=function(){var t,e=this.storage.read(r.FileType.CampaignDefinitions);if(l.isNullOrUndefined(e))return[];try{t=JSON.parse(e)}catch(t){return a.FloodgateEngine.getTelemetryLogger().log_CampaignLoad_Failed(t.toString()),[]}return xt(t).result},Pt.prototype.loadAsync=function(){var t=this.load();return new c.Promise((function(e){e(t)}))},o=Pt,n.FileSystemCampaignDefinitionProvider=o},{"../Api/IFloodgateStorageProvider":8,"../FloodgateEngine":18,"../GovernedChannel":20,"../ISurveyInfo":24,"../Utils":43,"es6-promise":44}],14:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=t("../FloodgateEngine"),o=t("../Utils"),r=t("./CampaignDefinitionProvider"),a=t("./CampaignStateProvider"),s=t("./CampaignSurveyFactory"),u=t("es6-promise");l.isStateUpForNomination=function(t,e,n,i){return!(!t||!e)&&(n=n||new Date,!!t.ForceCandidacy||!!(e=e.nominationScheme.getCampaignCooldown(t.IsCandidate&&t.DidCandidateTriggerSurvey))&&(!!l.hasBuildChangeDurationElapsed(e,t.LastNominationBuildNumber,i)||l.hasTimeIntervalDurationElapsed(e,t.getCooldownStartDate(),n)))},l.isDateInRange=function(t,e,n){return t=t||new Date,e=e||o.getDistantPast(),n=n||o.getDistantFuture(),e.getTime()<=t.getTime()&&n.getTime()>=t.getTime()},l.hasTimeIntervalDurationElapsed=function(t,e,n){return!o.isNullOrUndefined(t)&&t instanceof r.CampaignDurationTimeInterval&&(!(!e||!n)&&(t=o.addSecondsWithoutOverflow(e,t.intervalSeconds),n.getTime()>=t.getTime()))},l.hasBuildChangeDurationElapsed=function(t,e,n){return!o.isNullOrUndefined(t)&&t instanceof r.CampaignDurationSingleBuildChange&&(o.isNullOrUndefined(e)||o.isNullOrUndefined(n)?null===e!=(null===n):!(e===n))},l.isCampaignInScope=function(t,e,n){return!(!t||(e=e||new Date,!l.isDateInRangeWithDefinition(e,t)||t.scope&&!t.scope.isInScope(n)))},l.isDateInRangeWithDefinition=function(t,e){return!!e&&(t=t||new Date,l.isDateInRange(t,e.startTime||o.getDistantFuture(),e.endTime))},l.prototype.getActiveSurveys=function(){var t,e,n,i={};for(t in this.campaignStates)!this.campaignStates.hasOwnProperty(t)||(e=this.campaignStates[t]).IsCandidate&&(!(n=this.campaignDefinitions[e.CampaignId])||(n=s.CampaignSurveyFactory.makeSurvey(e,n.governedChannelType,n.surveyTemplate,this.stringProvider,n.additionalDataRequested,n.launcherType))&&(i[n.getSurveyInfo().getId()]=n));return i},l.prototype.onCampaignSurveyActivated=function(t,e){var n=this.campaignStates[t];n&&(e=e||new Date,n.markCurrentSurveyTakenOnDate(e,this.campaignDefinitions[t].nominationScheme.cooldownPeriod.asTimeIntervalSeconds()),this.saveCurrentState())},l.prototype.getCampaignStates=function(){return this.campaignStates},l.prototype.getCampaignDefinitions=function(){return this.campaignDefinitions},l.prototype.onSurveyActivated=function(t){t&&this.onCampaignSurveyActivated(t.getBackEndId(),new Date)},l.prototype.refreshSurveyDefinitions=function(t,e){this.refreshSurveyDefinitionsPrivate(t,e||new Date)},l.prototype.refreshSurveyDefinitionsAsync=function(t,e){var n=this;return new u.Promise((function(i,o){n.refreshSurveyDefinitionsPrivateAsync(t,e||new Date).then((function(){i()})).catch((function(t){o(t)}))}))},l.prototype.getAppSurveys=function(){return this.getActiveSurveys()},l.prototype.saveCurrentState=function(){var t=o.makeArrayFromObjectValuesSortedByKeyString(this.campaignStates);this.stateProvider.save(t)},l.prototype.refreshSurveyDefinitionsPrivate=function(t,e){this.campaignStates={},this.campaignDefinitions={},this.loadAndFilterCampaignData(e,t),this.evaluateCampaigns(e)},l.prototype.refreshSurveyDefinitionsPrivateAsync=function(t,e){this.campaignStates={},this.campaignDefinitions={};var n=this;return new u.Promise((function(i,o){n.loadAndFilterCampaignDataAsync(e,t).then((function(){n.evaluateCampaigns(e),i()})).catch((function(t){o(t)}))}))},l.prototype.loadAndFilterCampaignDataAsync=function(t,e){t=t||new Date;for(var n=[],r=[],a=0,s=Object.keys(this.definitionProviders);a<s.length;a++){var l=s[a];l=this.definitionProviders[l].loadAsync();o.isNullOrUndefined(l)||(l=l.catch((function(){i.FloodgateEngine.getTelemetryLogger().log_CampaignLoad_Failed("Failed to load from campaign definition provider"),u.Promise.resolve()})),r.push(l))}var c=this;return new u.Promise((function(a,s){u.Promise.all(r).then((function(i){for(var r=0,s=Object.keys(i);r<s.length;r++){var u=i[s[r]];o.isArray(u)&&(n=n.concat(u))}c.FilterCampaignData(t,e,n),a()})).catch((function(){i.FloodgateEngine.getTelemetryLogger().log_CampaignLoad_Failed("Failed to load from campaign definition provider")}))}))},l.prototype.loadAndFilterCampaignData=function(t,e){t=t||new Date;for(var n=[],r=0,a=Object.keys(this.definitionProviders);r<a.length;r++){var s=a[r];try{var u=this.definitionProviders[s].load();o.isArray(u)&&(n=n.concat(u))}catch(t){i.FloodgateEngine.getTelemetryLogger().log_CampaignLoad_Failed("Failed to load from campaign definition provider. "+t.toString())}}this.FilterCampaignData(t,e,n)},l.prototype.FilterCampaignData=function(t,e,n){var i={};for(r in n)n.hasOwnProperty(r)&&(i[(s=n[r]).campaignId]=s,e&&e.indexOf(s.governedChannelType)<0||l.isCampaignInScope(s,t,this.environmentProvider)&&(this.campaignDefinitions[s.campaignId]=s));var r,a,s,u,c=this.stateProvider.load(),d=[];for(r in c)c.hasOwnProperty(r)&&(a=c[r],this.campaignDefinitions.hasOwnProperty(a.CampaignId)||d.push(a),this.campaignStates[a.CampaignId]=a);for(r in d)d.hasOwnProperty(r)&&(a=d[r])&&(u=!1,(s=i[a.CampaignId])?l.isStateUpForNomination(a,s,t,this.currentBuildNumber)&&(u=!0):a.LastNominationTimeUtc.getTime()<=o.subtractSecondsWithoutOverflow(t,a.DeleteAfterSecondsWhenStale).getTime()&&(u=!0),u&&delete this.campaignStates[a.CampaignId])},l.prototype.evaluateCampaigns=function(t){for(var e in t=t||new Date,this.campaignDefinitions){var n,i,r,s,u,c,d;this.campaignDefinitions.hasOwnProperty(e)&&(n=this.campaignDefinitions[e],(c=this.campaignStates[n.campaignId])&&!l.isStateUpForNomination(c,n,t,this.currentBuildNumber)||(i=c?c.LastSurveyId:"",r=c?c.LastSurveyStartTimeUtc:o.getDistantPast(),s=c?c.LastSurveyExpirationTimeUtc:o.getDistantPast(),u=c?c.LastSurveyActivatedTimeUtc:o.getDistantPast(),d=c?c.LastCooldownEndTimeUtc:o.getDistantPast(),(c=c&&c.ForceCandidacy||n.nominationScheme.evaluateNominationRules())&&(i=o.guid(),r=n.nominationScheme.calculateSurveyStartTimeFromDate(t),s=n.nominationScheme.calculateSurveyExpirationTimeFromSurveyStartTime(r)),d=new a.CampaignState(n.campaignId,t,this.currentBuildNumber,n.nominationScheme.getActiveSurveyTimeIntervalSeconds(),!1,c,!1,u,i,r,s,d),this.campaignStates[d.CampaignId]=d))}},t=l;function l(t,e,n,i,r,a){if(!t)throw new Error("stateProvider must not be null");if(!o.isArray(e))throw new Error("definitionProviders is either null or not an array type");if(!n)throw new Error("stringProvider must not be null");if(o.isNullOrUndefined(r))throw new Error("currentBuildNumber must not be null");this.campaignStates={},this.campaignDefinitions={},this.stateProvider=t,this.definitionProviders=e,this.stringProvider=n,this.environmentProvider=i,this.currentBuildNumber=r,a=a||new Date}n.CampaignManager=t},{"../FloodgateEngine":18,"../Utils":43,"./CampaignDefinitionProvider":13,"./CampaignStateProvider":15,"./CampaignSurveyFactory":16,"es6-promise":44}],15:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=t("../Api/IFloodgateStorageProvider"),o=t("../Constants"),r=t("../FloodgateEngine"),a=t("../StateProviderHelpers"),s=t("../Utils"),u=i.FileType,l=a.StateListType,c=(d.deserialize=function(t){var e;if(!t)return null;try{e=new d(t.CampaignId,t.LastNominationTimeUtc,t.LastNominationBuildNumber,t.DeleteAfterSecondsWhenStale,!1,t.IsCandidate,t.DidCandidateTriggerSurvey,t.LastSurveyActivatedTimeUtc,t.LastSurveyId,t.LastSurveyStartTimeUtc,t.LastSurveyExpirationTimeUtc,t.LastCooldownEndTimeUtc)}catch(t){return r.FloodgateEngine.getTelemetryLogger().log_Event(o.TelemetryEvent.CampaignState.Deserialize.Failed,{ErrorMessage:t.toString()}),null}return e},d.prototype.validate=function(){if(!this.CampaignId||!s.isString(this.CampaignId))return!1;if(s.isNullOrUndefined(this.LastNominationBuildNumber)||!s.isString(this.LastNominationBuildNumber))return!1;if(!s.isNumber(this.DeleteAfterSecondsWhenStale)||this.DeleteAfterSecondsWhenStale<0)return!1;if(!s.isBoolean(this.IsCandidate)||!s.isBoolean(this.DidCandidateTriggerSurvey))return!1;if(this.IsCandidate){if(s.isNullOrUndefined(this.LastSurveyStartTimeUtc)||s.isNullOrUndefined(this.LastSurveyExpirationTimeUtc))return!1;if(!s.isString(this.LastSurveyId))return!1}if(this.DidCandidateTriggerSurvey&&s.isNullOrUndefined(this.LastSurveyActivatedTimeUtc))return!1;if(s.isNullOrUndefined(this.LastSurveyId))this.LastSurveyId="";else if(!s.isString(this.LastSurveyId))return!1;if(s.isUtcDatetimeString(this.LastNominationTimeUtc))this.LastNominationTimeUtc=s.stringToDate(this.LastNominationTimeUtc);else if(!s.isDate(this.LastNominationTimeUtc))return!1;if(s.isNullOrUndefined(this.LastSurveyActivatedTimeUtc))this.LastSurveyActivatedTimeUtc=s.getDistantPast();else if(s.isUtcDatetimeString(this.LastSurveyActivatedTimeUtc))this.LastSurveyActivatedTimeUtc=s.stringToDate(this.LastSurveyActivatedTimeUtc);else if(!s.isDate(this.LastSurveyActivatedTimeUtc))return!1;if(s.isNullOrUndefined(this.LastSurveyStartTimeUtc))this.LastSurveyStartTimeUtc=s.getDistantPast();else if(s.isUtcDatetimeString(this.LastSurveyStartTimeUtc))this.LastSurveyStartTimeUtc=s.stringToDate(this.LastSurveyStartTimeUtc);else if(!s.isDate(this.LastSurveyStartTimeUtc))return!1;if(s.isNullOrUndefined(this.LastSurveyExpirationTimeUtc))this.LastSurveyExpirationTimeUtc=s.getDistantPast();else if(s.isUtcDatetimeString(this.LastSurveyExpirationTimeUtc))this.LastSurveyExpirationTimeUtc=s.stringToDate(this.LastSurveyExpirationTimeUtc);else if(!s.isDate(this.LastSurveyExpirationTimeUtc))return!1;if(s.isNullOrUndefined(this.LastCooldownEndTimeUtc))this.LastCooldownEndTimeUtc=s.getDistantPast();else if(s.isUtcDatetimeString(this.LastCooldownEndTimeUtc))this.LastCooldownEndTimeUtc=s.stringToDate(this.LastCooldownEndTimeUtc);else if(!s.isDate(this.LastCooldownEndTimeUtc))return!1;return!0},d.prototype.markCurrentSurveyTakenOnDate=function(t,e){this.DidCandidateTriggerSurvey=!0,this.LastSurveyActivatedTimeUtc=null!=t?t:new Date,this.LastCooldownEndTimeUtc=s.addSecondsWithoutOverflow(this.LastSurveyActivatedTimeUtc,e)},d.prototype.getCooldownStartDate=function(){return this.IsCandidate?this.DidCandidateTriggerSurvey?this.LastSurveyActivatedTimeUtc:this.LastSurveyStartTimeUtc:this.LastNominationTimeUtc},d);function d(t,e,n,i,o,r,a,s,u,l,c,d){if(this.CampaignId=t,this.LastNominationTimeUtc=e,this.LastNominationBuildNumber=n,this.DeleteAfterSecondsWhenStale=i,this.ForceCandidacy=o,this.IsCandidate=r,this.DidCandidateTriggerSurvey=a,this.LastSurveyActivatedTimeUtc=s,this.LastSurveyId=u,this.LastSurveyStartTimeUtc=l,this.LastSurveyExpirationTimeUtc=c,this.LastCooldownEndTimeUtc=d,!this.validate())throw new Error("Constructor arguments are not valid")}function p(){}n.CampaignState=c,p.make=function(t,e){return e?new f(t,e):new m(t)},t=p,n.CampaignStateProviderFactory=t;var g=function(){},f=(h.prototype.load=function(){var t,e=this.getStatesFromHost();return this.fileBasedStateProvider&&(t=this.fileBasedStateProvider.load()),a.MergeAndUpdateCampaignStates(t,e).find(l.Merged)},h.prototype.save=function(t){var e,n=this;t&&(e=this.getStatesFromHost(),e=(t=a.MergeAndUpdateCampaignStates(t,e)).find(l.ToBeUpdated),t=t.find(l.Merged),e&&e.forEach((function(t){var e=a.makeSettingItemValue(JSON.stringify(t));n.hostBasedStorage.upsertSettingItem(u[u.CampaignStates],t.CampaignId,e)})),this.fileBasedStateProvider&&this.fileBasedStateProvider.save(t))},h.prototype.getStatesFromHost=function(){var t,e=[],n=this.hostBasedStorage.readSettingList(u[u.CampaignStates]);for(t in n)if(n.hasOwnProperty(t)){var i,s=n[t],l=a.extractSettingItemValueSubString(s);try{i=JSON.parse(l);var d=c.deserialize(i);d&&e.push(d)}catch(t){r.FloodgateEngine.getTelemetryLogger().log_Event(o.TelemetryEvent.HostBasedCampaignStateProvider.GetStatesFromHost.Failed,{ErrorMessage:"Json parsing/deserializing failed. "+t.toString()+".  Input:"+l})}}return e},h);function h(t,e){if(!e)throw new Error("host-based storage must not be null");this.hostBasedStorage=e,t&&(this.fileBasedStateProvider=new m(t))}n.HostBasedCampaignStateProvider=f;var m=(v.prototype.load=function(){var t,e=this.storage.read(i.FileType.CampaignStates);if(!e)return[];try{t=JSON.parse(e);var n=[];return t&&t.CampaignStates&&t.CampaignStates.forEach((function(t){(t=c.deserialize(t))&&n.push(t)})),n}catch(t){return r.FloodgateEngine.getTelemetryLogger().log_Event(o.TelemetryEvent.FileBasedCampaignStateProvider.Load.Failed,{ErrorMessage:"Json parsing/deserializing failed. "+t.toString()+".  Input:"+e}),[]}},v.prototype.save=function(t){var e;t&&((e=new g).CampaignStates=t,e=JSON.stringify(e),this.storage.write(i.FileType.CampaignStates,e))},v);function v(t){if(!t)throw new Error("storage must not be null");this.storage=t}n.FileBasedCampaignStateProvider=m},{"../Api/IFloodgateStorageProvider":8,"../Constants":17,"../FloodgateEngine":18,"../StateProviderHelpers":26,"../Utils":43}],16:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=t("../Api/ISurvey"),o=t("../SurveyEvents"),r=t("../SurveyMetadata"),a=t("../Surveys/FpsSurvey"),s=t("../Surveys/GenericMessagingSurfaceSurvey"),u=t("../Surveys/NlqsSurvey"),l=t("../Surveys/NpsSurvey"),c=t("../Surveys/SurveyDataSource"),d=t("../Utils"),p=t("./CampaignDefinitionProvider");g.makeSurvey=function(t,e,n,i,o,r){return t&&n&&i?n instanceof p.CampaignSurveyTemplateNps5PointStatic?l.make5Point(g.makeSurveyDataSourceData(t,e,n,o,r),i):n instanceof p.CampaignSurveyTemplateNps11PointStatic?l.make11Point(g.makeSurveyDataSourceData(t,e,n,o,r),i):n instanceof p.CampaignSurveyTemplateFps?a.makeFps(g.makeSurveyDataSourceData(t,e,n,o,r),i,n):n instanceof p.CampaignSurveyTemplateNlqs?u.makeNlqs(g.makeSurveyDataSourceData(t,e,n,o,r),i,n):n instanceof p.CampaignSurveyTemplateNps?l.makeCustom(g.makeSurveyDataSourceData(t,e,n,o,r),i,n):n instanceof p.CampaignSurveyTemplateGenericMessagingSurface?s.makeCustom(g.makeSurveyDataSourceData(t,e,n,o,r)):null:null},g.makeSurveyDataSourceData=function(t,e,n,o,r){if(!t||!n)return null;var a=new c.SurveyDataSourceData;return a.activationEvent=g.makeEvent(t,n.activationEvent),a.metadata=g.makeMetadata(n.metadata),a.id=t.LastSurveyId,a.backEndIdentifier=t.CampaignId,a.expirationTimeUtc=d.dateToShortUtcString(t.LastSurveyExpirationTimeUtc),a.governedChannelType=e,a.startTimeUtc=d.dateToShortUtcString(t.LastSurveyStartTimeUtc),a.additionalDataRequested=o||[],a.launcherType=r||i.LAUNCHER_TYPE_DEFAULT,a},g.makeCountedActivityEventData=function(t){if(!t)return null;var e=new o.CountedActivityEventData;return e.activity=t.activity,e.count=t.count,e.isAggregate=t.isAggregate,e},g.makeCountedActivityEvent=function(t,e){return t&&e&&(e=g.makeCountedActivityEventData(e))?new o.CountedActivityEvent(e):null},g.makeCountedActivitySequenceEvent=function(t,e){if(!t||!e)return null;var n=new o.CountedActivitySequenceEventData;n.sequence=[];for(var i=0,r=e.sequence;i<r.length;i++){var a=r[i];if(!(a=g.makeCountedActivityEventData(a)))return null;n.sequence.push(a)}return new o.CountedActivitySequenceEvent(n)},g.makeEvent=function(t,e){return e instanceof p.CampaignSurveyEventCountedActivity?g.makeCountedActivityEvent(t,e):e instanceof p.CampaignSurveyEventCountedActivitySequence?g.makeCountedActivitySequenceEvent(t,e):null},g.makeMetadata=function(t){if(d.isNullOrUndefined(t)||d.isNullOrUndefined(t.contentMetadata))return null;var e=new r.Metadata;return e.contentMetadata=t.contentMetadata,new r.SurveyMetadata(e)},t=g;function g(){}n.CampaignSurveyFactory=t},{"../Api/ISurvey":11,"../SurveyEvents":32,"../SurveyMetadata":33,"../Surveys/FpsSurvey":37,"../Surveys/GenericMessagingSurfaceSurvey":38,"../Surveys/NlqsSurvey":39,"../Surveys/NpsSurvey":40,"../Surveys/SurveyDataSource":42,"../Utils":43,"./CampaignDefinitionProvider":13}],17:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i,o=(r.CampaignState=((i=function(){}).Deserialize=((o=function(){}).Failed="FloodgateCore_CampaignState_Deserialize_Failed",o),i),r.FileBasedCampaignStateProvider=((o=function(){}).Load=((i=function(){}).Failed="FloodgateCore_FileBasedCampaignStateProvider_Load_Failed",i),o),r.HostBasedCampaignStateProvider=((i=function(){}).GetStatesFromHost=((o=function(){}).Failed="FloodgateCore_HostBasedCampaignStateProvider_GetStatesFromHost_Failed",o),i),r.Floodgate=((o=function(){}).Initialize=((i=function(){}).Failed="FloodgateCore_Floodgate_Initialize_Failed",i),o.Start=((i=function(){}).Failed="FloodgateCore_Floodgate_Start_Failed",i),o),r.FloodgateEngine=((i=function(){}).Make=((o=function(){}).Failed="FloodgateCore_FloodgateEngine_Make_Failed",o),i.Start=((o=function(){}).Failed="FloodgateCore_FloodgateEngine_Start_Failed",o),i.StartAsync=((o=function(){}).Failed="FloodgateCore_FloodgateEngine_StartAsync_Failed",o.Stopped="FloodgateCore_FloodgateEngine_StartAsync_Stopped",o),i.OnSurveyActivated=((o=function(){}).ActivationStatsSuppressedSurvey="FloodgateCore_FloodgateEngine_OnSurveyActivated_ActivationStatsSuppressedSurvey",o.ClosedChannelType="FloodgateCore_FloodgateEngine_OnSurveyActivated_ClosedChannelType",o),i),r.GovernedChannelState=((o=function(){}).Deserialize=((i=function(){}).Failed="FloodgateCore_GovernedChannelState_Deserialize_Failed",i),o),r.FileBasedGovernedChannelStateProvider=((i=function(){}).Load=((o=function(){}).Failed="FloodgateCore_FileBasedGovernedChannelStateProvider_Load_Failed",o),i),r.HostBasedGovernedChannelStateProvider=((o=function(){}).GetStatesFromHost=((i=function(){}).Failed="FloodgateCore_HostBasedGovernedChannelStateProvider_GetStatesFromHost_Failed",i),o),r.SurveyStatCollectionActivation=((i=function(){}).FromJson=((o=function(){}).Failed="FloodgateCore_SurveyStatCollectionActivation_FromJson_Failed",o),i.ToJson=((o=function(){}).Failed="FloodgateCore_SurveyStatCollectionActivation_ToJson_Failed",o),i),r.HostBasedSurveyActivationStatsProvider=((o=function(){}).GetSurveyStatsFromHost=((i=function(){}).Failed="FloodgateCore_HostBasedSurveyActivationStatsProvider_GetSurveyStatsFromHost_Failed",i),o),r.SurveyStatCollectionEventActivity=((i=function(){}).FromJson=((o=function(){}).Failed="FloodgateCore_SurveyStatCollectionEventActivity_FromJson_Failed",o),i.ToJson=((o=function(){}).Failed="FloodgateCore_SurveyStatCollectionEventActivity_ToJson_Failed",o),i),r.SurveyActivity=((o=function(){}).LogActivity=((i=function(){}).EventsDropped="FloodgateCore_SurveyActivity_LogActivity_EventsDropped",i),o),r);function r(){}n.TelemetryEvent=o},{}],18:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=t("./Api/IFloodgateStorageProvider"),o=t("./Campaign/CampaignDefinitionProvider"),r=t("./Campaign/CampaignManager"),a=t("./Campaign/CampaignStateProvider"),s=t("./Constants"),u=t("./FloodgateSettings"),l=t("./GovernedChannel"),c=t("./GovernedChannelStateProvider"),d=t("./Governor"),p=t("./SurveyActivityListener"),g=t("./SurveyStatCollectionActivation"),f=t("./SurveyStatCollectionEventActivity"),h=t("es6-promise");m.prototype.log_TriggerMet=function(t,e,n){},m.prototype.log_UserSelected=function(t,e,n){},m.prototype.log_CampaignLoad_Failed=function(t){},m.prototype.log_Event=function(t,e){},t=m;function m(){}var v={run:function(){},shouldAcceptActivity:function(){return!0}};y.setTelemetryLogger=function(t){if(!t)throw new Error("telemetryLogger must not be null");y.telemetryLogger=t},y.getTelemetryLogger=function(){return y.telemetryLogger},y.getTransportFactory=function(){return y.transporterFactory},y.make=function(t,e,n,i,u,l,f,h,m){try{var S=c.GovernedChannelStateProviderFactory.make(i,u),b=g.SurveyActivationStatsProviderFactory.make(i,u),C=a.CampaignStateProviderFactory.make(i,u);return m.push(new o.FileSystemCampaignDefinitionProvider(i)),new y(new r.CampaignManager(C,m,l,f,t,new Date),new p(v,this.getTelemetryLogger),e,n,i,new d.Governor(S),b,h)}catch(t){this.telemetryLogger.log_Event(s.TelemetryEvent.FloodgateEngine.Make.Failed,{ErrorMessage:t.toString()})}},y.prototype.mergeAndSave=function(){this.saveSettings(),this.saveSurveyActivationHistory(),this.saveSurveyEventActivityHistory(),this.surveyClient.saveCurrentState(),this.governor.saveChannelStates()},y.prototype.start=function(){if(2!==this.initializationStatus&&3!==this.initializationStatus)try{this.setInitializationStatus(2),this.loadSettingsAndPriorEventCounts();var t=this.getAvailableChannelTypes();this.surveyClient.refreshSurveyDefinitions(t),this.setPendingSurveysAndStartFloodgate(),this.setInitializationStatus(3)}catch(t){this.setInitializationStatus(1),y.getTelemetryLogger().log_Event(s.TelemetryEvent.FloodgateEngine.Start.Failed,{ErrorMessage:t&&t.toString()})}},y.prototype.startAsync=function(){if(2===this.initializationStatus||3===this.initializationStatus)return h.Promise.resolve();try{this.setInitializationStatus(2),this.loadSettingsAndPriorEventCounts();var t=this.getAvailableChannelTypes(),e=this;return new h.Promise((function(n,i){e.surveyClient.refreshSurveyDefinitionsAsync(t).then((function(){4===e.initializationStatus?(e.setInitializationStatus(3),e.stop(),y.getTelemetryLogger().log_Event(s.TelemetryEvent.FloodgateEngine.StartAsync.Stopped,{ErrorMessage:"Stopped because of a pending stop() call"})):e.setPendingSurveysAndStartFloodgate(),n()})).catch((function(t){e.setInitializationStatus(1),y.getTelemetryLogger().log_Event(s.TelemetryEvent.FloodgateEngine.StartAsync.Failed,{ErrorMessage:t&&t.message}),i(t)}))}))}catch(t){return this.setInitializationStatus(1),y.getTelemetryLogger().log_Event(s.TelemetryEvent.FloodgateEngine.StartAsync.Failed,{ErrorMessage:t&&t.toString()}),h.Promise.resolve()}},y.prototype.stop=function(){3===this.initializationStatus&&(this.mergeAndSave(),this.setPendingSurveys(null),this.updateActivityListenerWithCurrentSurveyDefinitions()),this.setInitializationStatus(4)},y.prototype.getActivityListener=function(){return this.activityListener},y.prototype.setInitializationStatus=function(t){this.initializationStatus=t},y.prototype.saveSettings=function(){this.storage.fileLock(i.FileType.FloodgateSettings);try{this.writeString(i.FileType.FloodgateSettings,u.FloodgateSettings.toJson(this.floodgateSettings))}finally{this.storage.fileUnlock(i.FileType.FloodgateSettings)}},y.prototype.loadSettingsAndPriorEventCounts=function(){this.floodgateSettings=u.FloodgateSettings.fromJson(this.readString(i.FileType.FloodgateSettings)),this.previousSurveyActivationStats=this.surveyActivationStatsProvider.load(),this.previousSurveyEventActivityStats=f.SurveyStatCollectionEventActivity.fromJson(this.readString(i.FileType.SurveyEventActivityStats))},y.prototype.getAvailableChannelTypes=function(){var t=this.governor.getAvailableChannelData(),e=[];return t.forEach((function(t){t&&e.push(t.getType())})),e},y.prototype.setPendingSurveysAndStartFloodgate=function(){this.setPendingSurveys(this.surveyClient.getAppSurveys()),this.updateActivityListenerWithCurrentSurveyDefinitions(),this.setInitializationStatus(3),this.loggedFirstStart||(this.loggedFirstStart=!0,this.getActivityListener().logActivity(p.FloodgateStartActivityName))},y.prototype.saveSurveyActivationHistory=function(){this.storage.fileLock(i.FileType.SurveyActivationStats);try{var t,e,n,o=this.surveyActivationStatsProvider.load(),r=new g.SurveyStatCollectionActivation;for(t in this.launchedSurveys)this.launchedSurveys.hasOwnProperty(t)&&(e=new g.SurveyActivationStats,n=this.launchedSurveys[t],e.Type=n.getType(),e.ExpirationTimeUtc=n.getSurveyInfo().getExpirationTimeUtc(),e.ActivationTimeUtc=new Date,r.addStats(n.getSurveyInfo().getId(),e));o.accumulate(r),this.surveyActivationStatsProvider.save(o),this.previousSurveyActivationStats=o}finally{this.storage.fileUnlock(i.FileType.SurveyActivationStats)}},y.prototype.saveSurveyEventActivityHistory=function(){this.storage.fileLock(i.FileType.SurveyEventActivityStats);try{var t,e=f.SurveyStatCollectionEventActivity.fromJson(this.readString(i.FileType.SurveyEventActivityStats)),n=new Date,o=new f.SurveyStatCollectionEventActivity,r=this;for(t in this.candidateSurveys)!function(t){if(r.candidateSurveys.hasOwnProperty(t)){var e=new f.SurveyEventActivityStats,i=r.candidateSurveys[t];if(!i.getSurveyInfo().isActiveForDate(n))return;e.ExpirationTimeUtc=i.getSurveyInfo().getExpirationTimeUtc();t=i.getSurveyInfo().getActivationEvent().getTrackingSet();var a=[];if(t.getList().forEach((function(t){t&&t.getIsAggregate()&&a.push(t.getActivity())})),0===a.length)return;e.Counts=new Array(a.length);for(var s=0;s<a.length;s++)e.Counts[s]=r.activityListener.moveSessionCountIntoBaseCount(a[s]);o.addStats(i.getSurveyInfo().getId(),e)}}(t);e.accumulate(o),this.writeString(i.FileType.SurveyEventActivityStats,f.SurveyStatCollectionEventActivity.toJson(e)),this.previousSurveyEventActivityStats=e}finally{this.storage.fileUnlock(i.FileType.SurveyEventActivityStats)}},y.prototype.setPendingSurveys=function(t){if(this.candidateSurveys={},t)for(var e in t){var n;t.hasOwnProperty(e)&&(n=t[e],this.launcherFactory.AcceptsSurvey(n)&&(this.candidateSurveys[e]=n))}},y.prototype.updateActivityListenerWithCurrentSurveyDefinitions=function(){var t,e,n=new Array;for(t in this.candidateSurveys)this.candidateSurveys.hasOwnProperty(t)&&(e=this.candidateSurveys[t],this.previousSurveyActivationStats.getBySurveyId(e.getSurveyInfo().getId())||e.getSurveyInfo().isActiveForDate(new Date)&&(y.telemetryLogger.log_UserSelected(e.getSurveyInfo().getBackEndId(),e.getSurveyInfo().getId(),e.getType()),n.push(e)));this.activityListener.setSurveys(n,this.previousSurveyEventActivityStats)},y.prototype.shouldAcceptActivity=function(t){return 3===this.initializationStatus||t===p.FloodgateStartActivityName},y.prototype.onSurveyActivated=function(t){y.telemetryLogger.log_TriggerMet(t.getSurveyInfo().getBackEndId(),t.getSurveyInfo().getId(),t.getType());var e=!1,n=t.getSurveyInfo().getGovernedChannelType();this.candidateSurveys[t.getSurveyInfo().getId()]&&t.getSurveyInfo().isActiveForDate(new Date)&&(this.governor.refreshChannelData(),this.governor.isChannelOpen(n)?this.surveyActivationStatsProvider.load().getBySurveyId(t.getSurveyInfo().getId())?y.getTelemetryLogger().log_Event(s.TelemetryEvent.FloodgateEngine.OnSurveyActivated.ActivationStatsSuppressedSurvey,{CampaignId:t.getSurveyInfo().getBackEndId(),SurveyId:t.getSurveyInfo().getId()}):0===Object.keys(this.launchedSurveys).length&&(this.launchedSurveys[t.getSurveyInfo().getId()]=t,e=!0):y.getTelemetryLogger().log_Event(s.TelemetryEvent.FloodgateEngine.OnSurveyActivated.ClosedChannelType,{ClosedChannelType:l.GovernedChannelType[n]})),this.mergeAndSave(),this.activityListener.clearSurveys(),e&&(this.governor.startChannelCooldown(n),this.surveyClient.onSurveyActivated(t.getSurveyInfo()),this.launchLauncher(t))},y.prototype.readString=function(t){return this.storage.read(t)},y.prototype.writeString=function(t,e){this.storage.write(t,e)},y.prototype.launchLauncher=function(t){var e=this.launcherFactory.makeSurveyLauncher(t);e&&(this.launchedLaunchers.push(e),this.onSurveyActivatedCallback.onSurveyActivated(e,t))},y.telemetryLogger=new t,t=y;function y(t,e,n,i,o,r,a,s){if(this.initializationStatus=0,this.candidateSurveys={},this.launchedSurveys={},this.launchedLaunchers=[],!t)throw new Error("surveyClient must not be null");if(!e)throw new Error("activityListener must not be null");if(!n)throw new Error("launcherFactory must not be null");if(!i)throw new Error("onSurveyActivatedCallback must not be null");if(!o)throw new Error("storage must not be null");if(!r)throw new Error("governor must not be null");if(!s)throw new Error("transporterFactory must not be null");this.surveyClient=t,this.activityListener=e,this.launcherFactory=n,this.onSurveyActivatedCallback=i,this.storage=o,this.governor=r,this.surveyActivationStatsProvider=a,y.transporterFactory=s,this.loggedFirstStart=!1,this.setPendingSurveys(null),this.activityListener.clearSurveys();var u=this;this.activityListener.setCallback({run:function(t){u.onSurveyActivated(t)},shouldAcceptActivity:function(t){return u.shouldAcceptActivity(t)}})}n.FloodgateEngine=t},{"./Api/IFloodgateStorageProvider":8,"./Campaign/CampaignDefinitionProvider":13,"./Campaign/CampaignManager":14,"./Campaign/CampaignStateProvider":15,"./Constants":17,"./FloodgateSettings":19,"./GovernedChannel":20,"./GovernedChannelStateProvider":21,"./Governor":22,"./SurveyActivityListener":27,"./SurveyStatCollectionActivation":35,"./SurveyStatCollectionEventActivity":36,"es6-promise":44}],19:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=(o.toJson=function(t){return JSON.stringify(t)},o.fromJson=function(t){return JSON.parse(t)},o);function o(){}n.FloodgateSettings=i},{}],20:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i,o,r=t("./Utils");function a(t,e,n,o){if(!r.isEnumValue(t,i))throw new Error("type is not a valid GovernedChannelType");if(!e)throw new Error("name must not be null or empty");if(n<0)throw new Error("cooldownSeconds must not be negative");this.type=t,this.name=e,this.cooldownSeconds=n,this.setCooldownStartTime(o)}(t=n.GovernedChannelType||(n.GovernedChannelType={}))[t.Standard=0]="Standard",t[t.Urgent=1]="Urgent",t[t.Banner=2]="Banner",t[t.TeachingMessage=3]="TeachingMessage",(o=i=n.GovernedChannelType||(n.GovernedChannelType={})).getDefault=function(){return o.Standard},a.prototype.setCooldownStartTime=function(t){this.cooldownStartTime=t,r.isNullOrUndefined(this.cooldownStartTime)?this.cooldownEndTime=r.getDistantPast():this.cooldownEndTime=r.addSecondsWithoutOverflow(this.cooldownStartTime,this.cooldownSeconds)},a.prototype.isOpen=function(){return this.isOpenAtDate(new Date)},a.prototype.isOpenAtDate=function(t){return!!t&&t>this.cooldownEndTime},a.prototype.getType=function(){return this.type},a.prototype.getName=function(){return this.name},a.prototype.getCooldownSeconds=function(){return this.cooldownSeconds},a.prototype.getCooldownStartTime=function(){return this.cooldownStartTime},a.prototype.getCooldownEndTime=function(){return this.cooldownEndTime},t=a,n.GovernedChannel=t},{"./Utils":43}],21:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=t("./Api/IFloodgateStorageProvider"),o=t("./Constants"),r=t("./FloodgateEngine"),a=t("./GovernedChannel"),s=t("./StateProviderHelpers"),u=t("./Utils"),l=i.FileType,c=s.StateListType,d=(p.deserialize=function(t){var e;if(!t)return null;try{e=new p(t.ChannelType,t.CooldownStartTimeUtc)}catch(t){return r.FloodgateEngine.getTelemetryLogger().log_Event(o.TelemetryEvent.GovernedChannelState.Deserialize.Failed,{ErrorMessage:t.toString()}),null}return e},p.prototype.validate=function(){return!!u.isEnumValue(this.ChannelType,a.GovernedChannelType)&&(u.isUtcDatetimeString(this.CooldownStartTimeUtc)?this.CooldownStartTimeUtc=u.stringToDate(this.CooldownStartTimeUtc):!u.isNullOrUndefined(this.CooldownStartTimeUtc)&&u.isDate(this.CooldownStartTimeUtc)||(this.CooldownStartTimeUtc=u.getDistantPast()),!0)},p.prototype.getType=function(){return this.ChannelType},p.prototype.getCooldownStartTime=function(){return this.CooldownStartTimeUtc},p);function p(t,e){if(this.ChannelType=t,this.CooldownStartTimeUtc=e,!this.validate())throw new Error("Constructor arguments are not valid")}function g(){}n.GovernedChannelState=d,g.make=function(t,e){return e?new h(t,e):new v(t)},i=g,n.GovernedChannelStateProviderFactory=i;var f=function(){},h=(m.prototype.load=function(){var t,e=this.getStatesFromHost();return this.fileBasedStateProvider&&(t=this.fileBasedStateProvider.load()),s.MergeAndUpdateGovernedChannelStates(t,e).find(c.Merged)},m.prototype.save=function(t){var e,n=this;t&&(e=this.getStatesFromHost(),e=(t=s.MergeAndUpdateGovernedChannelStates(t,e)).find(c.ToBeUpdated),t=t.find(c.Merged),e&&e.forEach((function(t){var e=s.makeSettingItemValue(JSON.stringify(t));n.hostBasedStorage.upsertSettingItem(l[l.GovernedChannelStates],String(t.getType()),e)})),this.fileBasedStateProvider&&this.fileBasedStateProvider.save(t))},m.prototype.getStatesFromHost=function(){var t,e=[],n=this.hostBasedStorage.readSettingList(l[l.GovernedChannelStates]);for(t in n)if(n.hasOwnProperty(t)){var i,a=n[t],u=s.extractSettingItemValueSubString(a);try{i=JSON.parse(u);var c=d.deserialize(i);c&&e.push(c)}catch(t){r.FloodgateEngine.getTelemetryLogger().log_Event(o.TelemetryEvent.HostBasedGovernedChannelStateProvider.GetStatesFromHost.Failed,{ErrorMessage:"Json parsing/deserializing failed. "+t.toString()+".  Input:"+u})}}return e},m);function m(t,e){if(!e)throw new Error("host-based storage must not be null");this.hostBasedStorage=e,t&&(this.fileBasedStateProvider=new v(t))}n.HostBasedGovernedChannelStateProvider=h;var v=(y.prototype.load=function(){var t,e=this.storage.read(l.GovernedChannelStates);if(!e)return[];try{t=JSON.parse(e);var n=[];return t&&t.ChannelStates&&t.ChannelStates.forEach((function(t){(t=d.deserialize(t))&&n.push(t)})),n}catch(t){return r.FloodgateEngine.getTelemetryLogger().log_Event(o.TelemetryEvent.FileBasedGovernedChannelStateProvider.Load.Failed,{ErrorMessage:"Json parsing/deserializing failed. "+t.toString()+".  Input:"+e}),[]}},y.prototype.save=function(t){var e;t&&((e=new f).ChannelStates=t,e=JSON.stringify(e),this.storage.write(l.GovernedChannelStates,e))},y);function y(t){if(!t)throw new Error("storage must not be null");this.storage=t}n.FileBasedGovernedChannelStateProvider=v},{"./Api/IFloodgateStorageProvider":8,"./Constants":17,"./FloodgateEngine":18,"./GovernedChannel":20,"./StateProviderHelpers":26,"./Utils":43}],22:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=t("./GovernedChannel"),o=t("./GovernedChannelStateProvider"),r=t("./Utils");t=function(t,e){this.name=t,this.cooldownSeconds=e},a.prototype.refreshChannelData=function(){this.loadChannels()},a.prototype.getAvailableChannelData=function(){var t,e,n=[];for(t in this.channels)!this.channels.hasOwnProperty(t)||(e=this.channels[t]).isOpen()&&n.push(e);return n},a.prototype.isChannelOpen=function(t){if(r.isNullOrUndefined(t))throw new Error("type must not be null");return this.channels[t].isOpen()},a.prototype.startChannelCooldown=function(t,e){if(r.isNullOrUndefined(t))throw new Error("type must not be null");e=e||new Date,this.channels[t].setCooldownStartTime(e),this.saveChannelStates()},a.prototype.saveChannelStates=function(){var t,e,n=[];for(t in this.channels)this.channels.hasOwnProperty(t)&&(e=this.channels[t],e=new o.GovernedChannelState(e.getType(),e.getCooldownStartTime()),n.push(e));this.channelStateProvider.save(n)},a.prototype.loadChannels=function(){for(var t in this.loadChannelStatesFromProvider(),i.GovernedChannelType){var e,n;i.GovernedChannelType.hasOwnProperty(t)&&(e=Number(t),isNaN(e)||this.channels[e]||(n=a.defaultChannelData[e],n=new i.GovernedChannel(e,n.name,n.cooldownSeconds,null),this.channels[e]=n))}},a.prototype.loadChannelStatesFromProvider=function(){this.channels=[];var t,e,n,o,r=this.channelStateProvider.load();for(t in r)r.hasOwnProperty(t)&&(e=(o=r[t]).getType(),n=a.defaultChannelData[e],o=new i.GovernedChannel(e,n.name,n.cooldownSeconds,o.getCooldownStartTime()),this.channels[o.getType()]=o)},a.day=24*(a.hour=60*(a.minute=60)),a.defaultChannelData=[new t(i.GovernedChannelType[i.GovernedChannelType.Standard],14*a.day),new t(i.GovernedChannelType[i.GovernedChannelType.Urgent],0),new t(i.GovernedChannelType[i.GovernedChannelType.Banner],15*a.day),new t(i.GovernedChannelType[i.GovernedChannelType.TeachingMessage],15*a.day)],t=a;function a(t){if(!t)throw new Error("channelStateProvider must not be null");this.channelStateProvider=t,this.loadChannels()}n.Governor=t},{"./GovernedChannel":20,"./GovernedChannelStateProvider":21,"./Utils":43}],23:[function(t,e,n){"use strict";var i,o;(o=(o=i=i||{}).Type||(o.Type={}))[o.CountedActivity="CountedActivity"]="CountedActivity",o[o.CountedActivitySequence="CountedActivitySequence"]="CountedActivitySequence",e.exports=i},{}],24:[function(t,e,n){"use strict";var i,o,r;(r=(o=i=i||{}).LaunchType||(o.LaunchType={}))[r.Default="Default"]="Default",r[r.Notification="Notification"]="Notification",r[r.Modal="Modal"]="Modal",(r=o.AdditionalDataType||(o.AdditionalDataType={}))[r.EmailAddress=0]="EmailAddress",o.DOM_TYPE_TAGNAME="Type",o.DOM_TYPE_VALUE="Survey",o.DOM_ID_TAGNAME="SurveyID",o.JSON_SURVEY_KEYNAME="survey",o.JSON_ID_KEYNAME="surveyId",e.exports=i},{}],25:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.IndexedTracker=function(){}},{}],26:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i,o=t("../src/SurveyStatCollectionActivation");(t=i=n.StateListType||(n.StateListType={}))[t.Merged=0]="Merged",t[t.ToBeUpdated=1]="ToBeUpdated";var r=(a.prototype.add=function(t,e){this.items[t]||this.itemCount++,this.items[t]=e},a.prototype.find=function(t){return this.items[t]},a.prototype.remove=function(t){var e=this.items[t];return e&&(delete this.items[t],this.itemCount--),e},a.prototype.count=function(){return this.itemCount},a);function a(){this.items={},this.itemCount=0}n.ItemCollection=r,n.extractSettingItemValueSubString=function(t){if(!t)return t;var e=t.indexOf(s)+s.length,n=t.indexOf(u);return e<0||n<0?t:t.substring(e,n)},n.makeSettingItemValue=function(t){return t?s+t+u:s+u},n.MergeAndUpdateGovernedChannelStates=function(t,e){var n=new r;if(!t&&!e)return n;if(!t)return n.add(i.Merged,e),n;if(!e)return n.add(i.Merged,t),n.add(i.ToBeUpdated,t),n;var o=[],a=[];return t&&t.forEach((function(t){for(var n,i=-1,r=0;r<e.length;r++)if((n=e[r]).getType()===t.getType()){i=r;break}if(-1===i)return o.push(t),void a.push(t);t.getCooldownStartTime()>n.getCooldownStartTime()?(o.push(t),a.push(t)):o.push(n),e.splice(i,1)})),e&&e.forEach((function(t){o.push(t)})),n.add(i.Merged,o),0<a.length&&n.add(i.ToBeUpdated,a),n},n.MergeAndUpdateCampaignStates=function(t,e){var n=new r;if(!t&&!e)return n;if(!t)return n.add(i.Merged,e),n;if(!e)return n.add(i.Merged,t),n.add(i.ToBeUpdated,t),n;var o=[],a=[];return t&&t.forEach((function(t){for(var n,i=new Date,r=-1,s=0;s<e.length;s++)if((n=e[s]).CampaignId===t.CampaignId){r=s;break}return-1===r?(o.push(t),void a.push(t)):(n.LastCooldownEndTimeUtc>i||!(t.LastCooldownEndTimeUtc>i||t.getCooldownStartDate()>n.getCooldownStartDate()||t.getCooldownStartDate()===n.getCooldownStartDate()&&t.LastNominationTimeUtc>n.LastNominationTimeUtc)?o.push(n):(o.push(t),a.push(t)),void e.splice(r,1))})),e&&e.forEach((function(t){o.push(t)})),n.add(i.Merged,o),0<a.length&&n.add(i.ToBeUpdated,a),n},n.MergeAndUpdateSurveyActivationStats=function(t,e){var n=new r;if(!t&&!e)return n;if(!t)return n.add(i.Merged,e),n;if(!e)return n.add(i.Merged,t),n.add(i.ToBeUpdated,t),n;var a,s,u=new o.SurveyStatCollectionActivation,l=new o.SurveyStatCollectionActivation,c=t.getStats(),d=e.getStats();for(s in c)c.hasOwnProperty(s)&&((a=d[s])?(c[s].ActivationTimeUtc>a.ActivationTimeUtc?(u.addStats(s,c[s]),l.addStats(s,c[s])):u.addStats(s,d[s]),delete d[s]):(u.addStats(s,c[s]),l.addStats(s,c[s])));for(s in d)d.hasOwnProperty(s)&&u.addStats(s,d[s]);n.add(i.Merged,u);var p,g=l.getStats();for(p in g)if(g.hasOwnProperty(p)){n.add(i.ToBeUpdated,l);break}return n};var s="<data>",u="</data>"},{"../src/SurveyStatCollectionActivation":35}],27:[function(t,e,n){"use strict";var i=t("./ActivityTracker"),o=t("./Constants"),r=t("./IndexedTracker"),a=t("./SurveyStatCollectionEventActivity"),s=0,u=(l.prototype.logActivity=function(t,e){void 0===e&&(e=1),this.logActivity_private(t,l.LogActionType.Increment,e,null)},l.prototype.logActivityStartTime=function(t,e){this.logActivity_private(t,l.LogActionType.StartTime,0,e)},l.prototype.logActivityStopTime=function(t,e){this.logActivity_private(t,l.LogActionType.StopTime,0,e)},l.prototype.setSurveys=function(t,e){if(void 0===e&&(e=new a.SurveyStatCollectionEventActivity),t&&0!==t.length&&e){for(var n=new Object,o=0,s=t;o<s.length;o++){for(var u=s[o],l=u.getSurveyInfo().getActivationEvent().getTrackingSet(),c=!1,d=0,p=l.getList();d<p.length;d++){var g=p[d];if(n.hasOwnProperty(g.getActivity())){c=!0;break}}if(!c){for(var f=e.getBySurveyId(u.getSurveyInfo().getId()),h=[l.getList().length],m=new Array(l.getList().length),v=0,y=0,S=0,b=l.getList();S<b.length;S++)g=b[S],h[y]=0,g.getIsAggregate()&&f&&v<f.Counts.length&&(h[y]=f.Counts[v++]),m[y]=this.trackedActivityMap[g.getActivity()],y++;var C=new i(l);C.initCounts(h,m,!1);for(var T=0,w=C.generateActivityIndexList();T<w.length;T++){var I=w[T],A=new r.IndexedTracker;A.index=I.index,A.survey=u,A.tracker=C,n[I.activity]=A}}}this.copyObject(this.trackedActivityMap,n)}},l.prototype.clearSurveys=function(){var t=this;Object.getOwnPropertyNames(this.trackedActivityMap).forEach((function(e){delete t.trackedActivityMap[e]}))},l.prototype.getCount=function(t){return(t=this.trackedActivityMap[t])?t.tracker.getCount(t.index):0},l.prototype.getSessionCount=function(t){return(t=this.trackedActivityMap[t])?t.tracker.getSessionCount(t.index):0},l.prototype.moveSessionCountIntoBaseCount=function(t){return(t=this.trackedActivityMap[t])?t.tracker.moveSessionCountIntoBaseCount(t.index):0},l.prototype.getSurvey=function(t){return(t=this.trackedActivityMap[t])?t.survey:null},l.prototype.setCallback=function(t){this.callback=t},l.prototype.logActivity_private=function(t,e,n,r){var a;this.callback&&!this.callback.shouldAcceptActivity(t)&&s++,t===l.FloodgateStartActivityName&&(0<s&&(a=this.loggerCallback&&this.loggerCallback())&&a.log_Event(o.TelemetryEvent.SurveyActivity.LogActivity.EventsDropped,{Count:s}),s=0);var u=this.trackedActivityMap[t];if(u){switch(e){case l.LogActionType.StartTime:return void u.tracker.startTime(u.index,r);case l.LogActionType.StopTime:n=u.tracker.stopTime(u.index,r);case l.LogActionType.Increment:break;default:return}u.tracker.incrementActivity(u.index,n)===i.IncrementResult.AllActivitiesActivated&&this.executeCallback(u.survey)}},l.prototype.executeCallback=function(t){this.callback.run(t)},l.prototype.copyObject=function(t,e){Object.keys(e).forEach((function(n){t[n]=e[n]}))},l.FloodgateStartActivityName="FloodgateFirstStart",l);function l(t,e){if(!t)throw new Error("callback must not be null");this.trackedActivityMap={},this.callback=t,this.loggerCallback=e}(t=(t=u=u||{}).LogActionType||(t.LogActionType={}))[t.Increment=0]="Increment",t[t.StartTime=1]="StartTime",t[t.StopTime=2]="StopTime",e.exports=u},{"./ActivityTracker":2,"./Constants":17,"./IndexedTracker":25,"./SurveyStatCollectionEventActivity":36}],28:[function(t,e,n){"use strict";var i=t("./../Api/ISurveyComponent");function o(t){if(!t)throw new Error("data must not be null");if(!t.question)throw new Error("data.question must not be null or empty");this.data=t,this.userComment=""}((t=(o.make=function(t){try{return new o(t)}catch(t){return null}},o.prototype.getType=function(){return i.Type.Comment},o.prototype.getQuestion=function(){return this.data.question},o.prototype.setSubmittedText=function(t){this.userComment=t},o.prototype.getSubmittedText=function(){return this.userComment},o.prototype.getDomElements=function(t){if(!t)throw new Error("Document must not be null");var e=t.createElement(i.DOM_COMMENT_TAGNAME);return e.appendChild(t.createTextNode(this.getSubmittedText())),[e]},o.prototype.getJsonElements=function(){var t={};return t[i.JSON_COMMENT_KEYNAME]=this.getSubmittedText(),t},o.prototype.getComponentJson=function(){var t={};return t[i.JSON_QUESTION_KEYNAME]=this.getQuestion(),t},o))||(t={})).CommentComponentData=function(){},e.exports=t},{"./../Api/ISurveyComponent":12}],29:[function(t,e,n){"use strict";var i=t("./../Api/ISurveyComponent");function o(t){if(!t)throw new Error("data must not be null");if(!t.question)throw new Error("data.question must not be null or empty");if(!t.availableOptions||t.availableOptions.length<2)throw new Error("data.availableOptions must not be null or have less than two choices");t.availableOptions.forEach((function(t){if(!t)throw new Error("Option values must not contain null or empty")})),this.data=t,this.optionStates=new Array(t.availableOptions.length);for(var e=0;e<this.optionStates.length;e++)this.optionStates[e]=!1}((t=(o.make=function(t){try{return new o(t)}catch(t){return null}},o.prototype.getType=function(){return i.Type.MultipleChoice},o.prototype.getQuestion=function(){return this.data.question},o.prototype.getAvailableOptions=function(){return this.data.availableOptions},o.prototype.getOptionSelectedStates=function(){return this.optionStates},o.prototype.getMinNumberofSelectedOptions=function(){return this.data.minNumberOfSelectedOptions},o.prototype.getMaxNumberofSelectedOptions=function(){return this.data.maxNumberOfSelectedOptions},o.prototype.setOptionSelectedStates=function(t){for(var e=0;e<t.length;e++)this.optionStates[e]=t[e]},o.prototype.ValidateMinNumberofSelectedOptions=function(){var t=0;return this.optionStates.forEach((function(e){e&&t++})),t>=this.getMinNumberofSelectedOptions()},o.prototype.ValidateMaxNumberofSelectedOptions=function(){var t=0;return this.optionStates.forEach((function(e){e&&t++})),t<=this.getMaxNumberofSelectedOptions()},o.prototype.getDomElements=function(t){if(!t)throw new Error("Document must not be null");var e=t.createElement(i.DOM_MULTIPLECHOICE_TAGNAME);return e.appendChild(t.createTextNode(this.getOptionSelectedStates().toString())),[e]},o.prototype.getJsonElements=function(){var t={};return t[i.JSON_MULTIPLECHOICE_KEYNAME]=this.getOptionSelectedStates().toString(),t},o.prototype.getComponentJson=function(){var t={};return t[i.JSON_QUESTION_KEYNAME]=this.getQuestion(),t[i.JSON_RATINGOPTIONS_KEYNAME]=this.getAvailableOptions(),t},o))||(t={})).MultipleChoiceComponentData=function(){},e.exports=t},{"./../Api/ISurveyComponent":12}],30:[function(t,e,n){"use strict";var i=t("./../Api/IPrompt"),o=t("./../Api/ISurveyComponent");function r(t){if(!t)throw new Error("data must not be null");if(!t.question)throw new Error("data.question must not be null or empty");if(!t.title)throw new Error("data.title must not be null or empty");if(!t.yesButtonLabel)throw new Error("data.yesButtonLabel must not be null or empty");if(!t.noButtonLabel)throw new Error("data.noButtonLabel must not be null or empty");this.data=t,this.selectedButton=i.PromptButton.Unselected}((t=(r.make=function(t){try{return new r(t)}catch(t){return null}},r.prototype.getType=function(){return o.Type.Prompt},r.prototype.getTitle=function(){return this.data.title},r.prototype.getQuestion=function(){return this.data.question},r.prototype.getYesButtonText=function(){return this.data.yesButtonLabel},r.prototype.getNoButtonText=function(){return this.data.noButtonLabel},r.prototype.setButtonSelected=function(t){t&&(this.selectedButton=t)},r.prototype.getButtonSelected=function(){return this.selectedButton},r.prototype.getDomElements=function(t){if(!t)throw new Error("Document must not be null");var e=t.createElement(o.DOM_PROMPT_TAGNAME);return e.appendChild(t.createTextNode(this.promptButtonToString(this.getButtonSelected()))),[e]},r.prototype.getJsonElements=function(){var t={};return t[o.JSON_PROMPT_KEYNAME]=this.promptButtonToString(this.getButtonSelected()),t},r.prototype.getComponentJson=function(){var t={};return t[o.JSON_PROMPTTITLE_KEYNAME]=this.getTitle(),t[o.JSON_QUESTION_KEYNAME]=this.getQuestion(),t[o.JSON_PROMPTYESTEXT_KEYNAME]=this.getYesButtonText(),t[o.JSON_PROMPTNOTEXT_KEYNAME]=this.getNoButtonText(),t},r.prototype.promptButtonToString=function(t){switch(t){case i.PromptButton.Unselected:return"Unselected";case i.PromptButton.Yes:return"Yes";case i.PromptButton.No:return"No";default:return"Unknown"}},r))||(t={})).PromptComponentData=function(){},e.exports=t},{"./../Api/IPrompt":10,"./../Api/ISurveyComponent":12}],31:[function(t,e,n){"use strict";var i=t("./../Api/ISurveyComponent");function o(t){if(!t)throw new Error("data must not be null");if(!t.question)throw new Error("data.question must not be null or empty");if(!t.ratingValuesAscending||t.ratingValuesAscending.length<2)throw new Error("data.ratingValuesAscending must not be null or have less than two choices");t.ratingValuesAscending.forEach((function(t){if(!t)throw new Error("rating values must not contain null or empty")})),this.data=t,this.selectedIndex=-1}((t=(o.make=function(t){try{return new o(t)}catch(t){return null}},o.prototype.getType=function(){return i.Type.Rating},o.prototype.getQuestion=function(){return this.data.question},o.prototype.getRatingValuesAscending=function(){return this.data.ratingValuesAscending},o.prototype.getSelectedRating=function(){return this.isRatingIndexValid(this.selectedIndex)?this.data.ratingValuesAscending[this.selectedIndex]:""},o.prototype.setSelectedRatingIndex=function(t){this.isRatingIndexValid(t)?this.selectedIndex=t:this.selectedIndex=-1},o.prototype.getSelectedRatingIndex=function(){return this.selectedIndex},o.prototype.getDomElements=function(t){if(!t)throw new Error("Document must not be null");var e=t.createElement(i.DOM_RATING_TAGNAME);return this.isRatingIndexValid(this.getSelectedRatingIndex())?e.appendChild(t.createTextNode(this.getNormalizedRatingScore().toFixed(6))):e.appendChild(t.createTextNode("Not rated")),[e]},o.prototype.getJsonElements=function(){var t={};return this.isRatingIndexValid(this.getSelectedRatingIndex())?t[i.JSON_RATING_KEYNAME]=this.getNormalizedRatingScore():t[i.JSON_RATING_KEYNAME]="Not rated",t},o.prototype.getComponentJson=function(){var t={};return t[i.JSON_QUESTION_KEYNAME]=this.getQuestion(),t[i.JSON_RATINGOPTIONS_KEYNAME]=this.getRatingValuesAscending(),t},o.prototype.getNormalizedRatingScore=function(){return this.isRatingIndexValid(this.getSelectedRatingIndex())?this.data.isZeroBased?this.selectedIndex/(this.data.ratingValuesAscending.length-1):(this.selectedIndex+1)/this.data.ratingValuesAscending.length:-1},o.prototype.isRatingIndexValid=function(t){return 0<=t&&t<this.data.ratingValuesAscending.length},o))||(t={})).RatingComponentData=function(){},e.exports=t},{"./../Api/ISurveyComponent":12}],32:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=t("./ActivityTrackingData"),o=t("./ActivityTrackingSet"),r=t("./ISurveyEvent"),a=(s.make=function(t){try{return new s(t)}catch(t){return null}},s.prototype.getActivity=function(){return this.data.activity},s.prototype.getCount=function(){return this.data.count},s.prototype.isAggregate=function(){return this.data.isAggregate},s.prototype.getType=function(){return r.Type.CountedActivity},s.prototype.getTrackingSet=function(){var t=new Array;return t.push(new i.ActivityTrackingData(this.data.activity,this.data.count,this.data.isAggregate)),new o.ActivityTrackingSet(!1,t)},s);function s(t){if(!t)throw new Error("data must not be null");if(t.count<=0)throw new Error("count must be greater than 0");if(!t.activity||0===t.activity.length)throw new Error("activity must not be null or an empty string");this.data=t}function u(t){if(!t)throw new Error("data must not be null");if(!t.sequence)throw new Error("data.sequence must not be null");if(0===t.sequence.length)throw new Error("data.sequence size must be greater than 0");this.data=[];for(var e=0,n=t.sequence;e<n.length;e++){var i=n[e];this.data.push(new a(i))}}function l(){}n.CountedActivityEvent=a,t=function(){},n.CountedActivityEventData=t,u.make=function(t){try{return new u(t)}catch(t){return null}},u.prototype.getSequence=function(){return this.data},u.prototype.getType=function(){return r.Type.CountedActivitySequence},u.prototype.getTrackingSet=function(){for(var t=new Array,e=0,n=this.data;e<n.length;e++){var r=n[e];t.push(new i.ActivityTrackingData(r.getActivity(),r.getCount(),r.isAggregate()))}return new o.ActivityTrackingSet(!0,t)},t=u,n.CountedActivitySequenceEvent=t,l.prototype.CountedActivitySequenceEventData=function(){},t=l,n.CountedActivitySequenceEventData=t},{"./ActivityTrackingData":3,"./ActivityTrackingSet":4,"./ISurveyEvent":23}],33:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=t("./Utils");o.make=function(t){try{return new o(t)}catch(t){return null}},o.prototype.getContentMetadata=function(){return this.data.contentMetadata},t=o;function o(t){if(!t)throw new Error("data must not be null");if(!t.contentMetadata)throw new Error("content metadata must not be null");if(!i.isObject(t.contentMetadata))throw new Error("content metadata must be of object type");this.data=t}n.SurveyMetadata=t,t=function(){},n.Metadata=t},{"./Utils":43}],34:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=(o.prototype.addStats=function(t,e){this.Surveys[t]=e},o.prototype.getBySurveyId=function(t){return this.Surveys[t]},o.prototype.getStats=function(){return this.Surveys},o);function o(){this.Surveys={},this.Surveys={}}n.SurveyStatCollection=i},{}],35:[function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var r,a=t("./Api/IFloodgateStorageProvider"),s=a.FileType,u=t("./Api/ISurvey"),l=t("./Constants"),c=t("./FloodgateEngine"),d=t("./StateProviderHelpers"),p=t("./SurveyStatCollection"),g=t("./Utils"),f=(o(h,r=p.SurveyStatCollection),h.fromJson=function(t){var e,n=new h;if(!t)return c.FloodgateEngine.getTelemetryLogger().log_Event(l.TelemetryEvent.SurveyStatCollectionActivation.FromJson.Failed,{ErrorMessage:"Input json is null or empty."}),n;try{e=JSON.parse(t)}catch(t){return c.FloodgateEngine.getTelemetryLogger().log_Event(l.TelemetryEvent.SurveyStatCollectionActivation.FromJson.Failed,{ErrorMessage:"Json parsing failed. "+t.toString()}),n}return n.deserialize(e)?n:new h},h.toJson=function(t){return t||(c.FloodgateEngine.getTelemetryLogger().log_Event(l.TelemetryEvent.SurveyStatCollectionActivation.ToJson.Failed,{ErrorMessage:"Input json is null or empty."}),t=new h),JSON.stringify(t)},h.prototype.accumulate=function(t){if(t){var e,n=t.getStats();for(e in n)n.hasOwnProperty(e)&&this.addStats(e,n[e])}},h.prototype.deserialize=function(t){var e,n,i=t.Surveys,o=new Date;for(e in i)!i.hasOwnProperty(e)||(n=new C).deserialize(i[e])&&n.ExpirationTimeUtc>o&&this.addStats(e,n);return this.validate()},h.prototype.validate=function(){return g.isObject(this.getStats())},h);function h(){return null!==r&&r.apply(this,arguments)||this}function m(){}n.SurveyStatCollectionActivation=f,m.make=function(t,e){return e?new v(t,e):new S(t)},o=m,n.SurveyActivationStatsProviderFactory=o;var v=(y.prototype.load=function(){var t=this.getSurveyStatsFromHost(),e=new f;return this.fileBasedStorageProvider&&(e=this.fileBasedStorageProvider.load()),d.MergeAndUpdateSurveyActivationStats(e,t).find(d.StateListType.Merged)},y.prototype.save=function(t){if(t){var e=this.getSurveyStatsFromHost();e=(t=d.MergeAndUpdateSurveyActivationStats(t,e)).find(d.StateListType.ToBeUpdated),t=t.find(d.StateListType.Merged);if(e){var n,i,o=e.getStats();for(n in o)o.hasOwnProperty(n)&&(i=d.makeSettingItemValue(JSON.stringify(o[n])),this.hostBasedStorage.upsertSettingItem(s[s.SurveyActivationStats],n,i))}this.fileBasedStorageProvider&&this.fileBasedStorageProvider.save(t)}},y.prototype.getSurveyStatsFromHost=function(){var t,e=new f,n=this.hostBasedStorage.readSettingList(s[s.SurveyActivationStats]);for(t in n)if(n.hasOwnProperty(t)){var i,o=d.extractSettingItemValueSubString(n[t]),r=new C;try{i=JSON.parse(o),r.deserialize(i)}catch(t){c.FloodgateEngine.getTelemetryLogger().log_Event(l.TelemetryEvent.HostBasedSurveyActivationStatsProvider.GetSurveyStatsFromHost.Failed,{ErrorMessage:"Json parsing/deserializing failed. "+t.toString()+".  Input:"+o})}var a=new Date;r.ExpirationTimeUtc<=a?this.hostBasedStorage.deleteSettingItem(s[s.SurveyActivationStats],t):e.addStats(t,r)}return e},y);function y(t,e){if(!e)throw new Error("host-based storage must not be null");this.hostBasedStorage=e,t&&(this.fileBasedStorageProvider=new S(t))}n.HostBasedSurveyActivationStatsProvider=v;var S=(b.prototype.load=function(){var t=this.storage.read(a.FileType.SurveyActivationStats);return t?f.fromJson(t):new f},b.prototype.save=function(t){t&&(t=f.toJson(t),this.storage.write(a.FileType.SurveyActivationStats,t))},b);function b(t){if(!t)throw new Error("storage must not be null");this.storage=t}n.FileBasedSurveyActivationStatsProvider=S;var C=(T.prototype.deserialize=function(t){return this.ActivationTimeUtc=t.ActivationTimeUtc,this.ExpirationTimeUtc=t.ExpirationTimeUtc,this.Type=t.Type,this.validate()},T.prototype.validate=function(){return!!g.isUtcDatetimeString(this.ActivationTimeUtc)&&(this.ActivationTimeUtc=g.stringToDate(this.ActivationTimeUtc),!!g.isUtcDatetimeString(this.ExpirationTimeUtc)&&(this.ExpirationTimeUtc=g.stringToDate(this.ExpirationTimeUtc),g.isEnumValue(this.Type,u.Type)))},T);function T(){}n.SurveyActivationStats=C},{"./Api/IFloodgateStorageProvider":8,"./Api/ISurvey":11,"./Constants":17,"./FloodgateEngine":18,"./StateProviderHelpers":26,"./SurveyStatCollection":34,"./Utils":43}],36:[function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var r,a=t("./Constants"),s=t("./FloodgateEngine"),u=t("./SurveyStatCollection"),l=t("./Utils");o(c,r=u.SurveyStatCollection),c.fromJson=function(t){var e,n=new c;if(!t)return s.FloodgateEngine.getTelemetryLogger().log_Event(a.TelemetryEvent.SurveyStatCollectionEventActivity.FromJson.Failed,{ErrorMessage:"Input json is null or empty."}),n;try{e=JSON.parse(t)}catch(t){return s.FloodgateEngine.getTelemetryLogger().log_Event(a.TelemetryEvent.SurveyStatCollectionEventActivity.FromJson.Failed,{ErrorMessage:"Json parsing failed. "+t.toString()}),n}return n.deserialize(e)?n:new c},c.toJson=function(t){return t||(s.FloodgateEngine.getTelemetryLogger().log_Event(a.TelemetryEvent.SurveyStatCollectionEventActivity.ToJson.Failed,{ErrorMessage:"Input json is null or empty."}),t=new c),JSON.stringify(t)},c.prototype.accumulate=function(t){if(t){var e,n=t.getStats();for(e in n)if(n.hasOwnProperty(e)){var i,o=this.getBySurveyId(e);o||((o=new d).Counts=[],this.addStats(e,o)),o.ExpirationTimeUtc=n[e].ExpirationTimeUtc,o.Counts.length<n[e].Counts.length&&(i=o.Counts.slice(),o.Counts=i);for(var r=0;r<n[e].Counts.length;r++)o.Counts[r]||(o.Counts[r]=0),o.Counts[r]+=n[e].Counts[r]}}},c.prototype.deserialize=function(t){var e,n,i=t.Surveys,o=new Date;for(e in i)!i.hasOwnProperty(e)||(n=new d).deserialize(i[e])&&n.ExpirationTimeUtc>o&&this.addStats(e,n);return this.validate()},c.prototype.validate=function(){return l.isObject(this.getStats())},o=c;function c(){return null!==r&&r.apply(this,arguments)||this}n.SurveyStatCollectionEventActivity=o;var d=(p.prototype.deserialize=function(t){return this.ExpirationTimeUtc=t.ExpirationTimeUtc,this.Counts=t.Counts,this.validate()},p.prototype.validate=function(){if(!this.Counts)return!1;for(var t=0;t<this.Counts.length;t++){var e=this.Counts[t];if(!l.isNumber(e))return!1;e<0&&(this.Counts[t]=0)}return!!l.isUtcDatetimeString(this.ExpirationTimeUtc)&&(this.ExpirationTimeUtc=l.stringToDate(this.ExpirationTimeUtc),!0)},p);function p(){}n.SurveyEventActivityStats=d},{"./Constants":17,"./FloodgateEngine":18,"./SurveyStatCollection":34,"./Utils":43}],37:[function(t,e,n){"use strict";var i,o,r=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=t("../Api/ISurvey"),s=t("../Api/ISurveyComponent"),u=t("../SurveyComponents/CommentComponent"),l=t("../SurveyComponents/MultipleChoiceComponent"),c=t("../SurveyComponents/PromptComponent"),d=t("../SurveyComponents/RatingComponent"),p=t("../Utils"),g=t("./Survey"),f=t("./SurveyDataSource");function h(t){var e=o.call(this)||this;if(p.isNullOrUndefined(t))throw new Error("data must not be null");return e.surveyInfo=new f(t.baseData),e.prompt=new c(t.promptData),e.question=t.commentData?new u(t.commentData):null,e.rating=t.ratingData?new d(t.ratingData):null,e.multipleChoice=t.multipleChoiceData?new l(t.multipleChoiceData):null,e}((r=(r(h,o=g.Survey),h.make=function(t){try{return new h(t)}catch(t){return null}},h.makeFps=function(t,e,n){if(p.isNullOrUndefined(t)||p.isNullOrUndefined(e)||p.isNullOrUndefined(n))return null;var i=[],o=[],r=n.content;if(p.isNullOrUndefined(r)||p.isNullOrUndefined(r.prompt)||p.isNullOrUndefined(r.rating)&&p.isNullOrUndefined(r.multipleChoice)&&p.isNullOrUndefined(r.comment))return null;if((n=new h.FpsSurveyData).baseData=t,n.promptData=new c.PromptComponentData,n.promptData.title=e.getCustomString(r.prompt.title),n.promptData.question=e.getCustomString(r.prompt.question),n.promptData.yesButtonLabel=e.getCustomString(r.prompt.yesLabel),n.promptData.noButtonLabel=e.getCustomString(r.prompt.noLabel),p.isNullOrUndefined(n.promptData.title)||p.isNullOrUndefined(n.promptData.question)||p.isNullOrUndefined(n.promptData.yesButtonLabel)||p.isNullOrUndefined(n.promptData.noButtonLabel))return null;if(r.rating){n.ratingData=new d.RatingComponentData,n.ratingData.question=e.getCustomString(r.rating.question),n.ratingData.isZeroBased=r.rating.isZeroBased;for(var a=0,s=r.rating.ratingValuesAscending;a<s.length;a++){var g=s[a],f=e.getCustomString(g);if(p.isNullOrUndefined(f))return null;i.push(f)}if(n.ratingData.ratingValuesAscending=i,p.isNullOrUndefined(n.ratingData.question)||p.isNullOrUndefined(n.ratingData.ratingValuesAscending))return null}if(r.multipleChoice){n.multipleChoiceData=new l.MultipleChoiceComponentData,n.multipleChoiceData.question=e.getCustomString(r.multipleChoice.question),n.multipleChoiceData.minNumberOfSelectedOptions=r.multipleChoice.minNumberOfSelectedOptions,n.multipleChoiceData.maxNumberOfSelectedOptions=r.multipleChoice.maxNumberOfSelectedOptions;for(var m=0,v=r.multipleChoice.availableOptions;m<v.length;m++){if(g=v[m],f=e.getCustomString(g),p.isNullOrUndefined(f))return null;o.push(f)}if(n.multipleChoiceData.availableOptions=o,p.isNullOrUndefined(n.multipleChoiceData.question)||p.isNullOrUndefined(n.multipleChoiceData.availableOptions))return null}return r.comment&&(n.commentData=new u.CommentComponentData,n.commentData.question=e.getCustomString(r.comment.question),p.isNullOrUndefined(n.commentData.question))?null:this.make(n)},h.prototype.getType=function(){return a.Type.Fps},h.prototype.getSurveyInfo=function(){return this.surveyInfo},h.prototype.getCommentComponent=function(){return this.question},h.prototype.getPromptComponent=function(){return this.prompt},h.prototype.getRatingComponent=function(){return this.rating},h.prototype.getMultipleChoiceComponent=function(){return this.multipleChoice},h.prototype.getComponent=function(t){switch(t){case s.Type.Comment:return this.getCommentComponent();case s.Type.Prompt:return this.getPromptComponent();case s.Type.Rating:return this.getRatingComponent();case s.Type.MultipleChoice:return this.getMultipleChoiceComponent();default:return null}},h.prototype.getDomElements=function(t){if(p.isNullOrUndefined(t))throw new Error("Document must not be null");var e=t.createElement(a.DOM_FPS_TAGNAME);return this.getSurveyInfo().getDomElements(t).forEach((function(t){p.isNullOrUndefined(t)||e.appendChild(t)})),this.getCommentComponent().getDomElements(t).forEach((function(t){p.isNullOrUndefined(t)||e.appendChild(t)})),this.getRatingComponent()&&this.getRatingComponent().getDomElements(t).forEach((function(t){p.isNullOrUndefined(t)||e.appendChild(t)})),this.getMultipleChoiceComponent()&&this.getMultipleChoiceComponent().getDomElements(t).forEach((function(t){p.isNullOrUndefined(t)||e.appendChild(t)})),[e]},h.prototype.getJsonElements=function(){var t,e={};return(e=p.overrideValues(this.getSurveyInfo().getJsonElements(),e))[s.JSON_APPLICATION_KEYNAME]={},e[s.JSON_APPLICATION_KEYNAME][s.JSON_EXTENDEDMANIFESTDATA_KEYNAME]=JSON.stringify(((t={})[s.JSON_SURVEYSTRINGS_KEYNAME]=this.makeSurveyStrings(),t[s.JSON_SURVEYSPECIFICDATA_KEYNAME]=this.makeResponseString(),t)),e},h.prototype.makeResponseString=function(){var t={};return this.question&&(t[s.JSON_COMMENT_KEYNAME]=[this.getCommentComponent().getSubmittedText()]),this.multipleChoice&&(t[s.JSON_MULTIPLECHOICE_KEYNAME]=[this.getMultipleChoiceComponent().getOptionSelectedStates()]),this.rating&&(t[s.JSON_RATING_KEYNAME]=[{numberOfOptions:this.getRatingComponent().getRatingValuesAscending().length,selectedRating:this.getRatingComponent().getSelectedRatingIndex()}]),JSON.stringify(t)},h.prototype.makeSurveyStrings=function(){var t={};return this.prompt&&(t[s.JSON_PROMPT_KEYNAME]=this.prompt.getComponentJson()),this.rating&&(t[s.JSON_RATING_KEYNAME]=[this.rating.getComponentJson()]),this.question&&(t[s.JSON_COMMENT_KEYNAME]=[this.question.getComponentJson()]),this.multipleChoice&&(t[s.JSON_MULTIPLECHOICE_KEYNAME]=[this.multipleChoice.getComponentJson()]),JSON.stringify(t)},h))||(r={})).FpsSurveyData=function(){},e.exports=r},{"../Api/ISurvey":11,"../Api/ISurveyComponent":12,"../SurveyComponents/CommentComponent":28,"../SurveyComponents/MultipleChoiceComponent":29,"../SurveyComponents/PromptComponent":30,"../SurveyComponents/RatingComponent":31,"../Utils":43,"./Survey":41,"./SurveyDataSource":42}],38:[function(t,e,n){"use strict";var i,o,r=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=t("../Api/ISurvey"),s=t("../Utils"),u=t("./Survey"),l=t("./SurveyDataSource");function c(t){var e=o.call(this)||this;if(!t)throw new Error("data must not be null");if(e.surveyInfo=new l(t.baseData),s.isNullOrUndefined(e.surveyInfo.getMetadata()))throw new Error("metadata must not be null");return e}((r=(r(c,o=u.Survey),c.make=function(t){try{return new c(t)}catch(t){return null}},c.makeCustom=function(t){if(s.isNullOrUndefined(t))return null;var e=new c.GenericMessagingSurfaceSurveyData;return e.baseData=t,this.make(e)},c.prototype.getType=function(){return a.Type.GenericMessagingSurface},c.prototype.getSurveyInfo=function(){return this.surveyInfo},c.prototype.getComponent=function(t){return null},c.prototype.getDomElements=function(t){return[]},c.prototype.getJsonElements=function(){return{}},c))||(r={})).GenericMessagingSurfaceSurveyData=function(){},e.exports=r},{"../Api/ISurvey":11,"../Utils":43,"./Survey":41,"./SurveyDataSource":42}],39:[function(t,e,n){"use strict";var i,o,r=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=t("../Api/ISurvey"),s=t("../Api/ISurveyComponent"),u=t("../SurveyComponents/CommentComponent"),l=t("../SurveyComponents/PromptComponent"),c=t("../SurveyComponents/RatingComponent"),d=t("../Utils"),p=t("./Survey"),g=t("./SurveyDataSource");function f(t){var e=o.call(this)||this;if(d.isNullOrUndefined(t))throw new Error("data must not be null");return e.surveyInfo=new g(t.baseData),e.prompt=new l(t.promptData),e.question=new u(t.commentData),e.rating=new c(t.ratingData),e}((r=(r(f,o=p.Survey),f.make=function(t){try{return new f(t)}catch(t){return null}},f.makeNlqs=function(t,e,n){if(d.isNullOrUndefined(t)||d.isNullOrUndefined(e)||d.isNullOrUndefined(n))return null;var i=[],o=n.content;if(d.isNullOrUndefined(o)||d.isNullOrUndefined(o.comment)||d.isNullOrUndefined(o.prompt)||d.isNullOrUndefined(o.rating))return null;(n=new f.NlqsSurveyData).baseData=t,n.promptData=new l.PromptComponentData,n.ratingData=new c.RatingComponentData,n.commentData=new u.CommentComponentData,n.promptData.title=e.getCustomString(o.prompt.title),n.promptData.question=e.getCustomString(o.prompt.question),n.promptData.yesButtonLabel=e.getCustomString(o.prompt.yesLabel),n.promptData.noButtonLabel=e.getCustomString(o.prompt.noLabel),n.ratingData.question=e.getCustomString(o.rating.question),n.ratingData.isZeroBased=o.rating.isZeroBased,n.commentData.question=e.getCustomString(o.comment.question);for(var r=0,a=o.rating.ratingValuesAscending;r<a.length;r++){var s=a[r];s=e.getCustomString(s);if(d.isNullOrUndefined(s))return null;i.push(s)}return n.ratingData.ratingValuesAscending=i,d.isNullOrUndefined(n.ratingData.question)||d.isNullOrUndefined(n.commentData.question)||d.isNullOrUndefined(n.promptData.title)||d.isNullOrUndefined(n.promptData.question)||d.isNullOrUndefined(n.promptData.yesButtonLabel)||d.isNullOrUndefined(n.promptData.noButtonLabel)||d.isNullOrUndefined(n.ratingData.ratingValuesAscending)?null:this.make(n)},f.prototype.getType=function(){return a.Type.Nlqs},f.prototype.getSurveyInfo=function(){return this.surveyInfo},f.prototype.getCommentComponent=function(){return this.question},f.prototype.getPromptComponent=function(){return this.prompt},f.prototype.getRatingComponent=function(){return this.rating},f.prototype.getComponent=function(t){switch(t){case s.Type.Comment:return this.getCommentComponent();case s.Type.Prompt:return this.getPromptComponent();case s.Type.Rating:return this.getRatingComponent();default:return null}},f.prototype.getDomElements=function(t){if(d.isNullOrUndefined(t))throw new Error("Document must not be null");var e=t.createElement(a.DOM_NLQS_TAGNAME);return this.getSurveyInfo().getDomElements(t).forEach((function(t){d.isNullOrUndefined(t)||e.appendChild(t)})),this.getCommentComponent().getDomElements(t).forEach((function(t){d.isNullOrUndefined(t)||e.appendChild(t)})),this.getRatingComponent().getDomElements(t).forEach((function(t){d.isNullOrUndefined(t)||e.appendChild(t)})),[e]},f.prototype.getJsonElements=function(){var t={};t=d.overrideValues(this.getSurveyInfo().getJsonElements(),t);return t=d.overrideValues(this.getCommentComponent().getJsonElements(),t),d.overrideValues(this.getRatingComponent().getJsonElements(),t)},f))||(r={})).NlqsSurveyData=function(){},e.exports=r},{"../Api/ISurvey":11,"../Api/ISurveyComponent":12,"../SurveyComponents/CommentComponent":28,"../SurveyComponents/PromptComponent":30,"../SurveyComponents/RatingComponent":31,"../Utils":43,"./Survey":41,"./SurveyDataSource":42}],40:[function(t,e,n){"use strict";var i,o,r=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=t("../Api/IFloodgateStringProvider"),s=t("../Api/ISurvey"),u=t("../Api/ISurveyComponent"),l=t("../SurveyComponents/CommentComponent"),c=t("../SurveyComponents/PromptComponent"),d=t("../SurveyComponents/RatingComponent"),p=t("../Utils"),g=t("./Survey"),f=t("./SurveyDataSource");function h(t){var e=o.call(this)||this;if(!t)throw new Error("data must not be null");return e.surveyInfo=new f(t.baseData),e.prompt=new c(t.promptData),e.question=new l(t.commentData),e.rating=new d(t.ratingData),e}((r=(r(h,o=g.Survey),h.make=function(t){try{return new h(t)}catch(t){return null}},h.makeCustom=function(t,e,n){if(p.isNullOrUndefined(t)||p.isNullOrUndefined(e)||p.isNullOrUndefined(n))return null;var i=[],o=n.content;if(p.isNullOrUndefined(o)||p.isNullOrUndefined(o.comment)||p.isNullOrUndefined(o.prompt)||p.isNullOrUndefined(o.rating))return null;(n=new h.NpsSurveyData).baseData=t,n.promptData=new c.PromptComponentData,n.ratingData=new d.RatingComponentData,n.commentData=new l.CommentComponentData,n.promptData.title=e.getCustomString(o.prompt.title),n.promptData.question=e.getCustomString(o.prompt.question),n.promptData.yesButtonLabel=e.getCustomString(o.prompt.yesLabel),n.promptData.noButtonLabel=e.getCustomString(o.prompt.noLabel),n.ratingData.question=e.getCustomString(o.rating.question),n.ratingData.isZeroBased=o.rating.isZeroBased,n.commentData.question=e.getCustomString(o.comment.question);for(var r=0,a=o.rating.ratingValuesAscending;r<a.length;r++){var s=a[r];s=e.getCustomString(s);if(p.isNullOrUndefined(s))return null;i.push(s)}return n.ratingData.ratingValuesAscending=i,p.isNullOrUndefined(n.ratingData.question)||p.isNullOrUndefined(n.commentData.question)||p.isNullOrUndefined(n.promptData.title)||p.isNullOrUndefined(n.promptData.question)||p.isNullOrUndefined(n.promptData.yesButtonLabel)||p.isNullOrUndefined(n.promptData.noButtonLabel)||p.isNullOrUndefined(n.ratingData.ratingValuesAscending)?null:this.make(n)},h.make5Point=function(t,e){if(!t||!e)return null;var n=new h.NpsSurveyData;return n.baseData=t,n.ratingData=new d.RatingComponentData,n.ratingData.isZeroBased=!1,n.commentData=new l.CommentComponentData,n.promptData=new c.PromptComponentData,n.ratingData.question=e.loadStringResource(a.StringType.NpsRatingQuestion),n.commentData.question=e.loadStringResource(a.StringType.NpsCommentQuestion),n.promptData.title=e.loadStringResource(a.StringType.NpsPromptTitle),n.promptData.question=e.loadStringResource(a.StringType.NpsPromptQuestion),n.promptData.yesButtonLabel=e.loadStringResource(a.StringType.NpsPromptYesLabel),n.promptData.noButtonLabel=e.loadStringResource(a.StringType.NpsPromptNotNowLabel),(t=new Array(5))[0]=e.loadStringResource(a.StringType.Nps5RatingValue1),t[1]=e.loadStringResource(a.StringType.Nps5RatingValue2),t[2]=e.loadStringResource(a.StringType.Nps5RatingValue3),t[3]=e.loadStringResource(a.StringType.Nps5RatingValue4),t[4]=e.loadStringResource(a.StringType.Nps5RatingValue5),n.ratingData.question&&n.commentData.question&&n.promptData.title&&n.promptData.question&&n.promptData.yesButtonLabel&&n.promptData.noButtonLabel&&t[0]&&t[1]&&t[2]&&t[3]&&t[4]?(n.ratingData.ratingValuesAscending=t,this.make(n)):null},h.make11Point=function(t,e){if(!t||!e)return null;var n=new h.NpsSurveyData;return n.baseData=t,n.ratingData=new d.RatingComponentData,n.ratingData.isZeroBased=!0,n.commentData=new l.CommentComponentData,n.promptData=new c.PromptComponentData,n.ratingData.question=e.loadStringResource(a.StringType.NpsRatingQuestion),n.commentData.question=e.loadStringResource(a.StringType.NpsCommentQuestion),n.promptData.title=e.loadStringResource(a.StringType.NpsPromptTitle),n.promptData.question=e.loadStringResource(a.StringType.NpsPromptQuestion),n.promptData.yesButtonLabel=e.loadStringResource(a.StringType.NpsPromptYesLabel),n.promptData.noButtonLabel=e.loadStringResource(a.StringType.NpsPromptNotNowLabel),(t=new Array(11))[0]=e.loadStringResource(a.StringType.Nps11RatingValue0),t[1]=e.loadStringResource(a.StringType.Nps11RatingValue1),t[2]=e.loadStringResource(a.StringType.Nps11RatingValue2),t[3]=e.loadStringResource(a.StringType.Nps11RatingValue3),t[4]=e.loadStringResource(a.StringType.Nps11RatingValue4),t[5]=e.loadStringResource(a.StringType.Nps11RatingValue5),t[6]=e.loadStringResource(a.StringType.Nps11RatingValue6),t[7]=e.loadStringResource(a.StringType.Nps11RatingValue7),t[8]=e.loadStringResource(a.StringType.Nps11RatingValue8),t[9]=e.loadStringResource(a.StringType.Nps11RatingValue9),t[10]=e.loadStringResource(a.StringType.Nps11RatingValue10),n.ratingData.question&&n.commentData.question&&n.promptData.title&&n.promptData.question&&n.promptData.yesButtonLabel&&n.promptData.noButtonLabel&&t[0]&&t[1]&&t[2]&&t[3]&&t[4]&&t[5]&&t[6]&&t[7]&&t[8]&&t[9]&&t[10]?(n.ratingData.ratingValuesAscending=t,this.make(n)):null},h.prototype.getType=function(){return s.Type.Nps},h.prototype.getSurveyInfo=function(){return this.surveyInfo},h.prototype.getCommentComponent=function(){return this.question},h.prototype.getPromptComponent=function(){return this.prompt},h.prototype.getRatingComponent=function(){return this.rating},h.prototype.getComponent=function(t){switch(t){case u.Type.Comment:return this.getCommentComponent();case u.Type.Prompt:return this.getPromptComponent();case u.Type.Rating:return this.getRatingComponent();default:return null}},h.prototype.getDomElements=function(t){if(!t)throw new Error("Document must not be null");var e=t.createElement(s.DOM_NPS_TAGNAME);return this.getSurveyInfo().getDomElements(t).forEach((function(t){t&&e.appendChild(t)})),this.getCommentComponent().getDomElements(t).forEach((function(t){t&&e.appendChild(t)})),this.getRatingComponent().getDomElements(t).forEach((function(t){t&&e.appendChild(t)})),[e]},h.prototype.getJsonElements=function(){var t,e={};e=p.overrideValues(this.getSurveyInfo().getJsonElements(),e);return e=p.overrideValues(this.getCommentComponent().getJsonElements(),e),(e=p.overrideValues(this.getRatingComponent().getJsonElements(),e))[u.JSON_APPLICATION_KEYNAME]={},e[u.JSON_APPLICATION_KEYNAME][u.JSON_EXTENDEDMANIFESTDATA_KEYNAME]=JSON.stringify(((t={})[u.JSON_SURVEYSTRINGS_KEYNAME]=this.makeSurveyStrings(),t)),e},h.prototype.makeSurveyStrings=function(){var t={};return this.prompt&&(t[u.JSON_PROMPT_KEYNAME]=this.prompt.getComponentJson()),this.rating&&(t[u.JSON_RATING_KEYNAME]=[this.rating.getComponentJson()]),this.question&&(t[u.JSON_COMMENT_KEYNAME]=[this.question.getComponentJson()]),JSON.stringify(t)},h))||(r={})).NpsSurveyData=function(){},e.exports=r},{"../Api/IFloodgateStringProvider":9,"../Api/ISurvey":11,"../Api/ISurveyComponent":12,"../SurveyComponents/CommentComponent":28,"../SurveyComponents/PromptComponent":30,"../SurveyComponents/RatingComponent":31,"../Utils":43,"./Survey":41,"./SurveyDataSource":42}],41:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=t("../Api/ISurvey"),o=t("../FloodgateEngine");r.prototype.getCampaignId=function(){return this.getSurveyInfo().getBackEndId()},r.prototype.getLauncherType=function(){return this.getSurveyInfo().getLauncherType()},r.prototype.submit=function(){var t=i.Type[this.getType()];(t=o.FloodgateEngine.getTransportFactory().makeTransporter(t)).setManifestValues(this.getJsonElements()),t.submit()},t=r;function r(){}n.Survey=t},{"../Api/ISurvey":11,"../FloodgateEngine":18}],42:[function(t,e,n){"use strict";var i=t("../../src/Api/ISurvey"),o=t("../GovernedChannel"),r=t("../ISurveyInfo"),a=t("../Utils");function s(t){if(a.isNullOrUndefined(t))throw new Error("data must not be null");if(a.isNullOrUndefined(t.id)||""===t.id)throw new Error("data.id must not be null or empty");if(a.isNullOrUndefined(t.governedChannelType)&&(t.governedChannelType=o.GovernedChannelType.getDefault()),a.isNullOrUndefined(t.expirationTimeUtc)||""===t.expirationTimeUtc)throw new Error("data.expirationTimeUtc must not be null or empty");if(a.isNullOrUndefined(t.activationEvent))throw new Error("data.activationEvent must not be null");!a.isNullOrUndefined(t.backEndIdentifier)&&""!==t.backEndIdentifier||(t.backEndIdentifier=t.id),a.isNullOrUndefined(t.launcherType)&&(t.launcherType=i.LAUNCHER_TYPE_DEFAULT),this.data=t}((t=(s.prototype.getId=function(){return this.data.id},s.prototype.getBackEndId=function(){return this.data.backEndIdentifier},s.prototype.getGovernedChannelType=function(){return this.data.governedChannelType},s.prototype.getRawStartTimeUtc=function(){return this.data.startTimeUtc},s.prototype.getStartTimeUtc=function(){if(a.isNullOrUndefined(this.data.startTimeUtc))return a.getDistantPast();var t=new Date(this.data.startTimeUtc);return a.isDate(t)?t:a.getDistantFuture()},s.prototype.getExpirationTimeUtc=function(){if(a.isNullOrUndefined(this.data.expirationTimeUtc))return a.getDistantPast();var t=new Date(this.data.expirationTimeUtc);return a.isDate(t)?t:a.getDistantPast()},s.prototype.getRawExpirationTimeUtc=function(){return this.data.expirationTimeUtc},s.prototype.isActiveForDate=function(t){return!a.isNullOrUndefined(t)&&t>=this.getStartTimeUtc()&&t<=this.getExpirationTimeUtc()},s.prototype.getActivationEvent=function(){return this.data.activationEvent},s.prototype.getPreferredLaunchType=function(){return this.data.preferredLaunchType},s.prototype.isAdditionalDataRequested=function(t){if(a.isNullOrUndefined(this.data.additionalDataRequested))return!1;for(var e=0,n=this.data.additionalDataRequested;e<n.length;e++)if(n[e]===t)return!0;return!1},s.prototype.getLauncherType=function(){return this.data.launcherType},s.prototype.getMetadata=function(){return this.data.metadata},s.prototype.getDomElements=function(t){if(!t)throw new Error("Document must not be null");var e=t.createElement(r.DOM_TYPE_TAGNAME);e.appendChild(t.createTextNode(r.DOM_TYPE_VALUE));var n=t.createElement(r.DOM_ID_TAGNAME);return n.appendChild(t.createTextNode(this.getBackEndId())),[e,n]},s.prototype.getJsonElements=function(){var t={};t[r.JSON_ID_KEYNAME]=this.getBackEndId();var e={};return e[r.JSON_SURVEY_KEYNAME]=t,e},s))||(t={})).SurveyDataSourceData=function(){this.preferredLaunchType=r.LaunchType.Default},e.exports=t},{"../../src/Api/ISurvey":11,"../GovernedChannel":20,"../ISurveyInfo":24,"../Utils":43}],43:[function(t,e,n){"use strict";function i(t){return"[object Date]"===Object.prototype.toString.call(t)&&!isNaN(t.getTime())}function o(t){return null==t}function a(t){return"string"==typeof t}function s(t,e){return t?e<0?(e=-e,this.addSecondsWithoutOverflow(t,e)):(e=t.getTime()-1e3*e)>n.MIN_DATE_MILLISECONDS?new Date(e):new Date(n.MIN_DATE_MILLISECONDS):null}Object.defineProperty(n,"__esModule",{value:!0}),n.timeAdd=function(t,e,n){switch(e.toLowerCase()){case"h":case"hour":return new Date(t.getTime()+36e5*n);case"m":case"minute":return new Date(t.getTime()+6e4*n);case"s":case"second":return new Date(t.getTime()+1e3*n);default:throw new Error("Invalid interval value of "+e)}},n.isDate=i,n.isEnumValue=function(t,e){return t in e},n.isNumber=function(t){return null!==t&&!isNaN(t)&&isFinite(t)},n.isNullOrUndefined=o,n.isObject=function(t){return null!=t&&"object"===r(t)},n.isArray=function(t){return null!=t&&Array.isArray(t)},n.isString=a,n.isBoolean=function(t){return"boolean"==typeof t},n.getDistantPast=function(){return new Date(-116444736e5)},n.getDistantFuture=function(){return new Date(640922112e5)},n.MAX_DATE_MILLISECONDS=864e13,n.MIN_DATE_MILLISECONDS=-864e13,n.addSecondsWithoutOverflow=function(t,e){return t?e<0?s(t,-1*e):(e=t.getTime()+1e3*e)<n.MAX_DATE_MILLISECONDS?new Date(e):new Date(n.MAX_DATE_MILLISECONDS):null},n.subtractSecondsWithoutOverflow=s;function u(t){return t?!(t=t.match("^((?:[a-zA-Z]{2,3}(?:-[a-zA-Z]{3}){0,3})|(?:[a-zA-Z]{4,8}))(?:-([a-zA-Z]{4}))?(?:-([a-zA-Z]{2}|[0-9]{3}))?(-.*)?$"))||t.length<1||!o(t[4])?null:t[0]:null}function l(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}n.isValidLanguageSubTag=function(t){if(!t)return!1;var e=u(t);return!!e&&e===t},n.extractLanguageSubtag=u,n.guid=function(){return(l()+l()+"-"+l()+"-4"+l().substr(0,3)+"-"+l()+"-"+l()+l()+l()).toLowerCase()},n.makeArrayFromObjectValuesSortedByKeyString=function(t){var e=Object.keys(t);e.sort();var n,i,o=[];for(n in e)e.hasOwnProperty(n)&&(i=e[n],o.push(t[i]));return o},n.stringToDate=function(t){return a(t)&&i(t=t?new Date(t):null)?t:null},n.overrideValues=function(t,e){if(!e)return e;var n=e;if(t)for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);return n},n.isUtcDatetimeString=function(t){return!!a(t)&&/^(\d{4}\-\d\d\-\d\dT\d\d:\d\d:\d\d(\.\d\d\d)?Z)$/.test(t)},n.dateToShortUtcString=function(t){return i(t)?t.getUTCFullYear()+"-"+e(t.getUTCMonth()+1)+"-"+e(t.getUTCDate())+"T"+e(t.getUTCHours())+":"+e(t.getUTCMinutes())+":"+e(t.getUTCSeconds())+"Z":null;function e(t){return t<10?"0"+t:t.toString()}}},{}],44:[function(i,a,s){(function(t,u){var l;l=function(){"use strict";function e(t){return"function"==typeof t}var n=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},o=0,a=void 0,s=void 0,l=function(t,e){h[o]=t,h[o+1]=e,2===(o+=2)&&(s?s(m):C())},c="undefined"!=typeof window?window:void 0,d=(g=c||{}).MutationObserver||g.WebKitMutationObserver,p="undefined"==typeof self&&void 0!==t&&"[object process]"==={}.toString.call(t),g="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function f(){var t=setTimeout;return function(){return t(m,1)}}var h=new Array(1e3);function m(){for(var t=0;t<o;t+=2)(0,h[t])(h[t+1]),h[t]=void 0,h[t+1]=void 0;o=0}var v,y,S,b,C=void 0;function T(t,e){var n=this,i=new this.constructor(A);void 0===i[I]&&k(i);var o,r=n._state;return r?(o=arguments[r-1],l((function(){return L(r,i,o,n._result)}))):x(n,i,t,e),i}function w(t){if(t&&"object"===r(t)&&t.constructor===this)return t;var e=new this(A);return _(e,t),e}C=p?function(){return t.nextTick(m)}:d?(y=0,S=new d(m),b=document.createTextNode(""),S.observe(b,{characterData:!0}),function(){b.data=y=++y%2}):g?((v=new MessageChannel).port1.onmessage=m,function(){return v.port2.postMessage(0)}):(void 0===c&&"function"==typeof i?function(){try{var t=Function("return this")().require("vertx");return void 0!==(a=t.runOnLoop||t.runOnContext)?function(){a(m)}:f()}catch(t){return f()}}:f)();var I=Math.random().toString(36).substring(2);function A(){}var E=void 0;function F(t,n,i){var o,r;n.constructor===t.constructor&&i===T&&n.constructor.resolve===w?(o=t,1===(r=n)._state?N(o,r._result):2===r._state?D(o,r._result):x(r,void 0,(function(t){return _(o,t)}),(function(t){return D(o,t)}))):void 0!==i&&e(i)?function(t,e,n){l((function(t){var i=!1,o=function(t,e,n,i){try{t.call(e,n,i)}catch(t){return t}}(n,e,(function(n){i||(i=!0,(e!==n?_:N)(t,n))}),(function(e){i||(i=!0,D(t,e))}),t._label);!i&&o&&(i=!0,D(t,o))}),t)}(t,n,i):N(t,n)}function _(t,e){if(t===e)D(t,new TypeError("You cannot resolve a promise with itself"));else if(o=r(i=e),null===i||"object"!==o&&"function"!==o)N(t,e);else{var n=void 0;try{n=e.then}catch(e){return void D(t,e)}F(t,e,n)}var i,o}function O(t){t._onerror&&t._onerror(t._result),P(t)}function N(t,e){t._state===E&&(t._result=e,t._state=1,0!==t._subscribers.length&&l(P,t))}function D(t,e){t._state===E&&(t._state=2,t._result=e,l(O,t))}function x(t,e,n,i){var o=t._subscribers,r=o.length;t._onerror=null,o[r]=e,o[r+1]=n,o[r+2]=i,0===r&&t._state&&l(P,t)}function P(t){var e=t._subscribers,n=t._state;if(0!==e.length){for(var i,o=void 0,r=t._result,a=0;a<e.length;a+=3)i=e[a],o=e[a+n],i?L(n,i,o,r):o(r);t._subscribers.length=0}}function L(t,n,i,o){var r=e(i),a=void 0,s=void 0,u=!0;if(r){try{a=i(o)}catch(t){u=!1,s=t}if(n===a)return void D(n,new TypeError("A promises callback cannot return that same promise."))}else a=o;n._state!==E||(r&&u?_(n,a):!1===u?D(n,s):1===t?N(n,a):2===t&&D(n,a))}var U=0;function k(t){t[I]=U++,t._state=void 0,t._result=void 0,t._subscribers=[]}var B=(M.prototype._enumerate=function(t){for(var e=0;this._state===E&&e<t.length;e++)this._eachEntry(t[e],e)},M.prototype._eachEntry=function(t,e){var n=this._instanceConstructor,i=n.resolve;if(i===w){var o,r=void 0,a=void 0,s=!1;try{r=t.then}catch(e){s=!0,a=e}r===T&&t._state!==E?this._settledAt(t._state,e,t._result):"function"!=typeof r?(this._remaining--,this._result[e]=t):n===R?(o=new n(A),s?D(o,a):F(o,t,r),this._willSettleAt(o,e)):this._willSettleAt(new n((function(e){return e(t)})),e)}else this._willSettleAt(i(t),e)},M.prototype._settledAt=function(t,e,n){var i=this.promise;i._state===E&&(this._remaining--,2===t?D(i,n):this._result[e]=n),0===this._remaining&&N(i,this._result)},M.prototype._willSettleAt=function(t,e){var n=this;x(t,void 0,(function(t){return n._settledAt(1,e,t)}),(function(t){return n._settledAt(2,e,t)}))},M);function M(t,e){this._instanceConstructor=t,this.promise=new t(A),this.promise[I]||k(this.promise),n(e)?(this.length=e.length,this._remaining=e.length,this._result=new Array(this.length),0===this.length?N(this.promise,this._result):(this.length=this.length||0,this._enumerate(e),0===this._remaining&&N(this.promise,this._result))):D(this.promise,new Error("Array Methods must be provided an Array"))}var R=(V.prototype.catch=function(t){return this.then(null,t)},V.prototype.finally=function(t){var n=this.constructor;return e(t)?this.then((function(e){return n.resolve(t()).then((function(){return e}))}),(function(e){return n.resolve(t()).then((function(){throw e}))})):this.then(t,t)},V);function V(t){this[I]=U++,this._result=this._state=void 0,this._subscribers=[],A!==t&&("function"!=typeof t&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof V?function(t,e){try{e((function(e){_(t,e)}),(function(e){D(t,e)}))}catch(e){D(t,e)}}(this,t):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return R.prototype.then=T,R.all=function(t){return new B(this,t).promise},R.race=function(t){var e=this;return n(t)?new e((function(n,i){for(var o=t.length,r=0;r<o;r++)e.resolve(t[r]).then(n,i)})):new e((function(t,e){return e(new TypeError("You must pass an array to race."))}))},R.resolve=w,R.reject=function(t){var e=new this(A);return D(e,t),e},R._setScheduler=function(t){s=t},R._setAsap=function(t){l=t},R._asap=l,R.polyfill=function(){var t=void 0;if(void 0!==u)t=u;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(t){throw new Error("polyfill failed because global object is unavailable in this environment")}var e=t.Promise;if(e){var n=null;try{n=Object.prototype.toString.call(e.resolve())}catch(t){}if("[object Promise]"===n&&!e.cast)return}t.Promise=R},R.Promise=R},"object"===r(s)&&void 0!==a?a.exports=l():void 0===(o="function"==typeof(e=l)?e.call(s,n,s,a):e)||(a.exports=o)}).call(this,i("_process"),void 0!==t?t:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:46}],45:[function(i,a,s){(function(t,u){var l;l=function(){"use strict";function e(t){return"function"==typeof t}var n=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},o=0,a=void 0,s=void 0,l=function(t,e){h[o]=t,h[o+1]=e,2===(o+=2)&&(s?s(m):C())},c="undefined"!=typeof window?window:void 0,d=(g=c||{}).MutationObserver||g.WebKitMutationObserver,p="undefined"==typeof self&&void 0!==t&&"[object process]"==={}.toString.call(t),g="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function f(){var t=setTimeout;return function(){return t(m,1)}}var h=new Array(1e3);function m(){for(var t=0;t<o;t+=2)(0,h[t])(h[t+1]),h[t]=void 0,h[t+1]=void 0;o=0}var v,y,S,b,C=void 0;function T(t,e){var n=this,i=new this.constructor(A);void 0===i[I]&&k(i);var o,r=n._state;return r?(o=arguments[r-1],l((function(){return L(r,i,o,n._result)}))):x(n,i,t,e),i}function w(t){if(t&&"object"===r(t)&&t.constructor===this)return t;var e=new this(A);return _(e,t),e}C=p?function(){return t.nextTick(m)}:d?(y=0,S=new d(m),b=document.createTextNode(""),S.observe(b,{characterData:!0}),function(){b.data=y=++y%2}):g?((v=new MessageChannel).port1.onmessage=m,function(){return v.port2.postMessage(0)}):(void 0===c&&"function"==typeof i?function(){try{var t=Function("return this")().require("vertx");return void 0!==(a=t.runOnLoop||t.runOnContext)?function(){a(m)}:f()}catch(t){return f()}}:f)();var I=Math.random().toString(36).substring(2);function A(){}var E=void 0;function F(t,n,i){var o,r;n.constructor===t.constructor&&i===T&&n.constructor.resolve===w?(o=t,1===(r=n)._state?N(o,r._result):2===r._state?D(o,r._result):x(r,void 0,(function(t){return _(o,t)}),(function(t){return D(o,t)}))):void 0!==i&&e(i)?function(t,e,n){l((function(t){var i=!1,o=function(t,e,n,i){try{t.call(e,n,i)}catch(t){return t}}(n,e,(function(n){i||(i=!0,(e!==n?_:N)(t,n))}),(function(e){i||(i=!0,D(t,e))}),t._label);!i&&o&&(i=!0,D(t,o))}),t)}(t,n,i):N(t,n)}function _(t,e){if(t===e)D(t,new TypeError("You cannot resolve a promise with itself"));else if(o=r(i=e),null===i||"object"!==o&&"function"!==o)N(t,e);else{var n=void 0;try{n=e.then}catch(e){return void D(t,e)}F(t,e,n)}var i,o}function O(t){t._onerror&&t._onerror(t._result),P(t)}function N(t,e){t._state===E&&(t._result=e,t._state=1,0!==t._subscribers.length&&l(P,t))}function D(t,e){t._state===E&&(t._state=2,t._result=e,l(O,t))}function x(t,e,n,i){var o=t._subscribers,r=o.length;t._onerror=null,o[r]=e,o[r+1]=n,o[r+2]=i,0===r&&t._state&&l(P,t)}function P(t){var e=t._subscribers,n=t._state;if(0!==e.length){for(var i,o=void 0,r=t._result,a=0;a<e.length;a+=3)i=e[a],o=e[a+n],i?L(n,i,o,r):o(r);t._subscribers.length=0}}function L(t,n,i,o){var r=e(i),a=void 0,s=void 0,u=!0;if(r){try{a=i(o)}catch(t){u=!1,s=t}if(n===a)return void D(n,new TypeError("A promises callback cannot return that same promise."))}else a=o;n._state!==E||(r&&u?_(n,a):!1===u?D(n,s):1===t?N(n,a):2===t&&D(n,a))}var U=0;function k(t){t[I]=U++,t._state=void 0,t._result=void 0,t._subscribers=[]}var B=(M.prototype._enumerate=function(t){for(var e=0;this._state===E&&e<t.length;e++)this._eachEntry(t[e],e)},M.prototype._eachEntry=function(t,e){var n=this._instanceConstructor,i=n.resolve;if(i===w){var o,r=void 0,a=void 0,s=!1;try{r=t.then}catch(e){s=!0,a=e}r===T&&t._state!==E?this._settledAt(t._state,e,t._result):"function"!=typeof r?(this._remaining--,this._result[e]=t):n===R?(o=new n(A),s?D(o,a):F(o,t,r),this._willSettleAt(o,e)):this._willSettleAt(new n((function(e){return e(t)})),e)}else this._willSettleAt(i(t),e)},M.prototype._settledAt=function(t,e,n){var i=this.promise;i._state===E&&(this._remaining--,2===t?D(i,n):this._result[e]=n),0===this._remaining&&N(i,this._result)},M.prototype._willSettleAt=function(t,e){var n=this;x(t,void 0,(function(t){return n._settledAt(1,e,t)}),(function(t){return n._settledAt(2,e,t)}))},M);function M(t,e){this._instanceConstructor=t,this.promise=new t(A),this.promise[I]||k(this.promise),n(e)?(this.length=e.length,this._remaining=e.length,this._result=new Array(this.length),0===this.length?N(this.promise,this._result):(this.length=this.length||0,this._enumerate(e),0===this._remaining&&N(this.promise,this._result))):D(this.promise,new Error("Array Methods must be provided an Array"))}var R=(V.prototype.catch=function(t){return this.then(null,t)},V.prototype.finally=function(t){var n=this.constructor;return e(t)?this.then((function(e){return n.resolve(t()).then((function(){return e}))}),(function(e){return n.resolve(t()).then((function(){throw e}))})):this.then(t,t)},V);function V(t){this[I]=U++,this._result=this._state=void 0,this._subscribers=[],A!==t&&("function"!=typeof t&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof V?function(t,e){try{e((function(e){_(t,e)}),(function(e){D(t,e)}))}catch(e){D(t,e)}}(this,t):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return R.prototype.then=T,R.all=function(t){return new B(this,t).promise},R.race=function(t){var e=this;return n(t)?new e((function(n,i){for(var o=t.length,r=0;r<o;r++)e.resolve(t[r]).then(n,i)})):new e((function(t,e){return e(new TypeError("You must pass an array to race."))}))},R.resolve=w,R.reject=function(t){var e=new this(A);return D(e,t),e},R._setScheduler=function(t){s=t},R._setAsap=function(t){l=t},R._asap=l,R.polyfill=function(){var t=void 0;if(void 0!==u)t=u;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(t){throw new Error("polyfill failed because global object is unavailable in this environment")}var e=t.Promise;if(e){var n=null;try{n=Object.prototype.toString.call(e.resolve())}catch(t){}if("[object Promise]"===n&&!e.cast)return}t.Promise=R},R.Promise=R},"object"===r(s)&&void 0!==a?a.exports=l():void 0===(o="function"==typeof(e=l)?e.call(s,n,s,a):e)||(a.exports=o)}).call(this,i("_process"),void 0!==t?t:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:46}],46:[function(t,e,n){var i,o;e=e.exports={};function r(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(t){if(i===setTimeout)return setTimeout(t,0);if((i===r||!i)&&setTimeout)return i=setTimeout,setTimeout(t,0);try{return i(t,0)}catch(e){try{return i.call(null,t,0)}catch(e){return i.call(this,t,0)}}}!function(){try{i="function"==typeof setTimeout?setTimeout:r}catch(t){i=r}try{o="function"==typeof clearTimeout?clearTimeout:a}catch(t){o=a}}();var u,l=[],c=!1,d=-1;function p(){c&&u&&(c=!1,u.length?l=u.concat(l):d=-1,l.length&&g())}function g(){if(!c){var t=s(p);c=!0;for(var e=l.length;e;){for(u=l,l=[];++d<e;)u&&u[d].run();d=-1,e=l.length}u=null,c=!1,function(t){if(o===clearTimeout)return clearTimeout(t);if((o===a||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(t);try{o(t)}catch(e){try{return o.call(null,t)}catch(e){return o.call(this,t)}}}(t)}}function f(t,e){this.fun=t,this.array=e}function h(){}e.nextTick=function(t){var e=new Array(arguments.length-1);if(1<arguments.length)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];l.push(new f(t,e)),1!==l.length||c||s(g)},f.prototype.run=function(){this.fun.apply(null,this.array)},e.title="browser",e.browser=!0,e.env={},e.argv=[],e.version="",e.versions={},e.on=h,e.addListener=h,e.once=h,e.off=h,e.removeListener=h,e.removeAllListeners=h,e.emit=h,e.prependListener=h,e.prependOnceListener=h,e.listeners=function(t){return[]},e.binding=function(t){throw new Error("process.binding is not supported")},e.cwd=function(){return"/"},e.chdir=function(t){throw new Error("process.chdir is not supported")},e.umask=function(){return 0}},{}],47:[function(t,e,n){"function"==typeof Object.create?e.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(t,e){function n(){}t.super_=e,n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}},{}],48:[function(t,e,n){e.exports=function(t){return t&&"object"===r(t)&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},{}],49:[function(e,n,i){(function(t,n){var o=/%[sdj%]/g;i.format=function(t){if(!y(t)){for(var e=[],n=0;n<arguments.length;n++)e.push(u(arguments[n]));return e.join(" ")}n=1;for(var i=arguments,r=i.length,a=String(t).replace(o,(function(t){if("%%"===t)return"%";if(r<=n)return t;switch(t){case"%s":return String(i[n++]);case"%d":return Number(i[n++]);case"%j":try{return JSON.stringify(i[n++])}catch(t){return"[Circular]"}default:return t}})),s=i[n];n<r;s=i[++n])m(s)||!C(s)?a+=" "+s:a+=" "+u(s);return a},i.deprecate=function(e,o){if(S(n.process))return function(){return i.deprecate(e,o).apply(this,arguments)};if(!0===t.noDeprecation)return e;var r=!1;return function(){if(!r){if(t.throwDeprecation)throw new Error(o);t.traceDeprecation?console.trace(o):console.error(o),r=!0}return e.apply(this,arguments)}};var a,s={};function u(t,e){var n={seen:[],stylize:c};return 3<=arguments.length&&(n.depth=arguments[2]),4<=arguments.length&&(n.colors=arguments[3]),h(e)?n.showHidden=e:e&&i._extend(n,e),S(n.showHidden)&&(n.showHidden=!1),S(n.depth)&&(n.depth=2),S(n.colors)&&(n.colors=!1),S(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=l),d(n,t,n.depth)}function l(t,e){return(e=u.styles[e])?"["+u.colors[e][0]+"m"+t+"["+u.colors[e][1]+"m":t}function c(t,e){return t}function d(t,e,n){if(t.customInspect&&e&&I(e.inspect)&&e.inspect!==i.inspect&&(!e.constructor||e.constructor.prototype!==e))return y(r=e.inspect(n,t))||(r=d(t,r,n)),r;if(u=function(t,e){if(S(e))return t.stylize("undefined","undefined");if(y(e)){var n="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(n,"string")}return v(e)?t.stylize(""+e,"number"):h(e)?t.stylize(""+e,"boolean"):m(e)?t.stylize("null","null"):void 0}(t,e))return u;var o,r=Object.keys(e),a=(o={},r.forEach((function(t,e){o[t]=!0})),o);if(t.showHidden&&(r=Object.getOwnPropertyNames(e)),w(e)&&(0<=r.indexOf("message")||0<=r.indexOf("description")))return p(e);if(0===r.length){if(I(e)){var s=e.name?": "+e.name:"";return t.stylize("[Function"+s+"]","special")}if(b(e))return t.stylize(RegExp.prototype.toString.call(e),"regexp");if(T(e))return t.stylize(Date.prototype.toString.call(e),"date");if(w(e))return p(e)}var u="",l=!1;s=["{","}"];return f(e)&&(l=!0,s=["[","]"]),I(e)&&(u=" [Function"+(e.name?": "+e.name:"")+"]"),b(e)&&(u=" "+RegExp.prototype.toString.call(e)),T(e)&&(u=" "+Date.prototype.toUTCString.call(e)),w(e)&&(u=" "+p(e)),0!==r.length||l&&0!=e.length?n<0?b(e)?t.stylize(RegExp.prototype.toString.call(e),"regexp"):t.stylize("[Object]","special"):(t.seen.push(e),r=l?function(t,e,n,i,o){for(var r=[],a=0,s=e.length;a<s;++a)_(e,String(a))?r.push(g(t,e,n,i,String(a),!0)):r.push("");return o.forEach((function(o){o.match(/^\d+$/)||r.push(g(t,e,n,i,o,!0))})),r}(t,e,n,a,r):r.map((function(i){return g(t,e,n,a,i,l)})),t.seen.pop(),function(t,e,n){return 60<t.reduce((function(t,e){return e.indexOf("\n"),t+e.replace(/\u001b\[\d\d?m/g,"").length+1}),0)?n[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+n[1]:n[0]+e+" "+t.join(", ")+" "+n[1]}(r,u,s)):s[0]+u+s[1]}function p(t){return"["+Error.prototype.toString.call(t)+"]"}function g(t,e,n,i,o,r){var a,s;if((e=Object.getOwnPropertyDescriptor(e,o)||{value:e[o]}).get?s=e.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):e.set&&(s=t.stylize("[Setter]","special")),_(i,o)||(a="["+o+"]"),s||(t.seen.indexOf(e.value)<0?-1<(s=m(n)?d(t,e.value,null):d(t,e.value,n-1)).indexOf("\n")&&(s=r?s.split("\n").map((function(t){return"  "+t})).join("\n").substr(2):"\n"+s.split("\n").map((function(t){return"   "+t})).join("\n")):s=t.stylize("[Circular]","special")),S(a)){if(r&&o.match(/^\d+$/))return s;a=(a=JSON.stringify(""+o)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),t.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),t.stylize(a,"string"))}return a+": "+s}function f(t){return Array.isArray(t)}function h(t){return"boolean"==typeof t}function m(t){return null===t}function v(t){return"number"==typeof t}function y(t){return"string"==typeof t}function S(t){return void 0===t}function b(t){return C(t)&&"[object RegExp]"===A(t)}function C(t){return"object"===r(t)&&null!==t}function T(t){return C(t)&&"[object Date]"===A(t)}function w(t){return C(t)&&("[object Error]"===A(t)||t instanceof Error)}function I(t){return"function"==typeof t}function A(t){return Object.prototype.toString.call(t)}function E(t){return t<10?"0"+t.toString(10):t.toString(10)}i.debuglog=function(e){var n;return S(a)&&(a=t.env.NODE_DEBUG||""),e=e.toUpperCase(),s[e]||(new RegExp("\\b"+e+"\\b","i").test(a)?(n=t.pid,s[e]=function(){var t=i.format.apply(i,arguments);console.error("%s %d: %s",e,n,t)}):s[e]=function(){}),s[e]},(i.inspect=u).colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},u.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},i.isArray=f,i.isBoolean=h,i.isNull=m,i.isNullOrUndefined=function(t){return null==t},i.isNumber=v,i.isString=y,i.isSymbol=function(t){return"symbol"===r(t)},i.isUndefined=S,i.isRegExp=b,i.isObject=C,i.isDate=T,i.isError=w,i.isFunction=I,i.isPrimitive=function(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"===r(t)||void 0===t},i.isBuffer=e("./support/isBuffer");var F=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function _(t,e){return Object.prototype.hasOwnProperty.call(t,e)}i.log=function(){var t,e;console.log("%s - %s",(e=[E((t=new Date).getHours()),E(t.getMinutes()),E(t.getSeconds())].join(":"),[t.getDate(),F[t.getMonth()],e].join(" ")),i.format.apply(i,arguments))},i.inherits=e("inherits"),i._extend=function(t,e){if(!e||!C(e))return t;for(var n=Object.keys(e),i=n.length;i--;)t[n[i]]=e[n[i]];return t}}).call(this,e("_process"),void 0!==t?t:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./support/isBuffer":48,_process:46,inherits:47}],50:[function(t,n,a){var s;s=function(t){"use strict";var e,n,i="URLSearchParams"in self,o="Symbol"in self&&"iterator"in Symbol,r="FileReader"in self&&"Blob"in self&&function(){try{return new Blob,!0}catch(t){return!1}}(),a="FormData"in self,s="ArrayBuffer"in self;function u(t){if("string"!=typeof t&&(t=String(t)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(t))throw new TypeError("Invalid character in header field name");return t.toLowerCase()}function l(t){return"string"!=typeof t&&(t=String(t)),t}function c(t){var e={next:function(){var e=t.shift();return{done:void 0===e,value:e}}};return o&&(e[Symbol.iterator]=function(){return e}),e}function d(t){this.map={},t instanceof d?t.forEach((function(t,e){this.append(e,t)}),this):Array.isArray(t)?t.forEach((function(t){this.append(t[0],t[1])}),this):t&&Object.getOwnPropertyNames(t).forEach((function(e){this.append(e,t[e])}),this)}function p(t){if(t.bodyUsed)return Promise.reject(new TypeError("Already read"));t.bodyUsed=!0}function g(t){return new Promise((function(e,n){t.onload=function(){e(t.result)},t.onerror=function(){n(t.error)}}))}function f(t){var e=new FileReader,n=g(e);return e.readAsArrayBuffer(t),n}function h(t){if(t.slice)return t.slice(0);var e=new Uint8Array(t.byteLength);return e.set(new Uint8Array(t)),e.buffer}function m(){return this.bodyUsed=!1,this._initBody=function(t){var e;(this._bodyInit=t)?"string"==typeof t?this._bodyText=t:r&&Blob.prototype.isPrototypeOf(t)?this._bodyBlob=t:a&&FormData.prototype.isPrototypeOf(t)?this._bodyFormData=t:i&&URLSearchParams.prototype.isPrototypeOf(t)?this._bodyText=t.toString():s&&r&&(e=t)&&DataView.prototype.isPrototypeOf(e)?(this._bodyArrayBuffer=h(t.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):s&&(ArrayBuffer.prototype.isPrototypeOf(t)||n(t))?this._bodyArrayBuffer=h(t):this._bodyText=t=Object.prototype.toString.call(t):this._bodyText="",this.headers.get("content-type")||("string"==typeof t?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):i&&URLSearchParams.prototype.isPrototypeOf(t)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},r&&(this.blob=function(){var t=p(this);if(t)return t;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?p(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(f)}),this.text=function(){var t,e,n=p(this);if(n)return n;if(this._bodyBlob)return t=this._bodyBlob,n=g(e=new FileReader),e.readAsText(t),n;if(this._bodyArrayBuffer)return Promise.resolve(function(t){for(var e=new Uint8Array(t),n=new Array(e.length),i=0;i<e.length;i++)n[i]=String.fromCharCode(e[i]);return n.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},a&&(this.formData=function(){return this.text().then(S)}),this.json=function(){return this.text().then(JSON.parse)},this}s&&(e=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],n=ArrayBuffer.isView||function(t){return t&&-1<e.indexOf(Object.prototype.toString.call(t))}),d.prototype.append=function(t,e){t=u(t),e=l(e);var n=this.map[t];this.map[t]=n?n+", "+e:e},d.prototype.delete=function(t){delete this.map[u(t)]},d.prototype.get=function(t){return t=u(t),this.has(t)?this.map[t]:null},d.prototype.has=function(t){return this.map.hasOwnProperty(u(t))},d.prototype.set=function(t,e){this.map[u(t)]=l(e)},d.prototype.forEach=function(t,e){for(var n in this.map)this.map.hasOwnProperty(n)&&t.call(e,this.map[n],n,this)},d.prototype.keys=function(){var t=[];return this.forEach((function(e,n){t.push(n)})),c(t)},d.prototype.values=function(){var t=[];return this.forEach((function(e){t.push(e)})),c(t)},d.prototype.entries=function(){var t=[];return this.forEach((function(e,n){t.push([n,e])})),c(t)},o&&(d.prototype[Symbol.iterator]=d.prototype.entries);var v=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function y(t,e){var n,i=(e=e||{}).body;if(t instanceof y){if(t.bodyUsed)throw new TypeError("Already read");this.url=t.url,this.credentials=t.credentials,e.headers||(this.headers=new d(t.headers)),this.method=t.method,this.mode=t.mode,this.signal=t.signal,i||null==t._bodyInit||(i=t._bodyInit,t.bodyUsed=!0)}else this.url=String(t);if(this.credentials=e.credentials||this.credentials||"same-origin",!e.headers&&this.headers||(this.headers=new d(e.headers)),this.method=(t=(n=e.method||this.method||"GET").toUpperCase(),-1<v.indexOf(t)?t:n),this.mode=e.mode||this.mode||null,this.signal=e.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&i)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(i)}function S(t){var e=new FormData;return t.trim().split("&").forEach((function(t){var n;t&&(t=(n=t.split("=")).shift().replace(/\+/g," "),n=n.join("=").replace(/\+/g," "),e.append(decodeURIComponent(t),decodeURIComponent(n)))})),e}function b(t,e){e=e||{},this.type="default",this.status=void 0===e.status?200:e.status,this.ok=200<=this.status&&this.status<300,this.statusText="statusText"in e?e.statusText:"OK",this.headers=new d(e.headers),this.url=e.url||"",this._initBody(t)}y.prototype.clone=function(){return new y(this,{body:this._bodyInit})},m.call(y.prototype),m.call(b.prototype),b.prototype.clone=function(){return new b(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new d(this.headers),url:this.url})},b.error=function(){var t=new b(null,{status:0,statusText:""});return t.type="error",t};var C=[301,302,303,307,308];b.redirect=function(t,e){if(-1===C.indexOf(e))throw new RangeError("Invalid status code");return new b(null,{status:e,headers:{location:t}})},t.DOMException=self.DOMException;try{new t.DOMException}catch(c){t.DOMException=function(t,e){this.message=t,this.name=e,t=Error(t),this.stack=t.stack},t.DOMException.prototype=Object.create(Error.prototype),t.DOMException.prototype.constructor=t.DOMException}function T(e,n){return new Promise((function(i,o){var a=new y(e,n);if(a.signal&&a.signal.aborted)return o(new t.DOMException("Aborted","AbortError"));var s=new XMLHttpRequest;function u(){s.abort()}s.onload=function(){var t,e={status:s.status,statusText:s.statusText,headers:(n=s.getAllResponseHeaders()||"",t=new d,n.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach((function(e){var n=e.split(":");(e=n.shift().trim())&&(n=n.join(":").trim(),t.append(e,n))})),t)};e.url="responseURL"in s?s.responseURL:e.headers.get("X-Request-URL");var n="response"in s?s.response:s.responseText;i(new b(n,e))},s.onerror=function(){o(new TypeError("Network request failed"))},s.ontimeout=function(){o(new TypeError("Network request failed"))},s.onabort=function(){o(new t.DOMException("Aborted","AbortError"))},s.open(a.method,a.url,!0),"include"===a.credentials?s.withCredentials=!0:"omit"===a.credentials&&(s.withCredentials=!1),"responseType"in s&&r&&(s.responseType="blob"),a.headers.forEach((function(t,e){s.setRequestHeader(e,t)})),a.signal&&(a.signal.addEventListener("abort",u),s.onreadystatechange=function(){4===s.readyState&&a.signal.removeEventListener("abort",u)}),s.send(void 0===a._bodyInit?null:a._bodyInit)}))}T.polyfill=!0,self.fetch||(self.fetch=T,self.Headers=d,self.Request=y,self.Response=b),t.Headers=d,t.Request=y,t.Response=b,t.fetch=T,Object.defineProperty(t,"__esModule",{value:!0})},"object"===r(a)&&void 0!==n?s(a):(i=[a],void 0===(o="function"==typeof(e=s)?e.apply(a,i):e)||(n.exports=o))},{}],51:[function(t,e,n){"use strict";n.__esModule=!0;var i=t("./UIStrings/UIStrings"),o=t("./Version"),r=t("./Configuration/Configuration"),a=t("./Window/Window"),s=t("./Logging/Logging"),u=t("./Theme"),l=t("es6-promise"),c=t("./Window/DomUtils"),d=!1;n.initialize=function(){return new l.Promise((function(t,e){var n,l;d?t():a.get().OfficeBrowserFeedback.initOptions?(a.get().OfficeBrowserFeedback.sdkVersion=o.default,r.get().setCommonInitOptions(a.get().OfficeBrowserFeedback.initOptions),n=r.get().getCommonInitOptions(),c.loadStylesheet(n.stylesUrl),l=n.intlUrl+n.locale.toLowerCase()+"/"+n.intlFilename,c.loadScript(l).then((function(){var a;i.getUIStrings()?(a=n,s.initialize(a.environment,"OfficeFeedbackSDK",o.default,a.telemetryGroup?a.telemetryGroup.audienceGroup:void 0,a.appId.toString(),a.sessionId,a.build,r.get().getSdkSessionId()),u.initialize(a.primaryColour,a.secondaryColour),d=!0,t()):e("UiStrings were not loaded from "+l)})).catch((function(){e("Script load failed for "+l)}))):e("Window.OfficeBrowserFeedback.initOptions not set")}))},n.reset=function(){d=!1},a.setSetUiStrings((function(t){i.setUIStrings(t)}))},{"./Configuration/Configuration":55,"./Logging/Logging":71,"./Theme":83,"./UIStrings/UIStrings":88,"./Version":108,"./Window/DomUtils":110,"./Window/Window":111,"es6-promise":45}],52:[function(t,e,n){"use strict";n.__esModule=!0;var i,o=t("./App_Common"),r=t("./UI/UI"),a=t("./Configuration/Configuration"),s=t("./Window/Window"),u=t("./FloodgateCore/AdaptiveSurveyLauncherFactory"),l=t("./FloodgateCore/TransporterFactory"),c=t("./FloodgateCore/UISurvey/CustomUISurvey"),d=t("./FloodgateCore/UISurvey/DummyUISurvey"),p=t("./FloodgateCore/FloodgateEnvironmentProvider"),g=t("./FloodgateCore/FloodgateStorageProvider"),f=t("./FloodgateCore/FloodgateStringProvider"),h=t("./FloodgateCore/FloodgateTelemetryLogger"),m=t("./TargetedMessaging/TargetedMessagingCampaignDefinitionProvider"),v=t("@ms-ofb/officefloodgatecore"),y=t("@ms-ofb/officefloodgatecore/dist/src/Campaign/CampaignDefinitionProvider"),S=t("@ms-ofb/officefloodgatecore/dist/src/Api/Api"),b=t("@ms-ofb/officefloodgatecore/dist/src/Constants"),C=t("es6-promise"),T=!1,w=!1,I=0,A=null,E=null;function F(t){A=t}function _(){return new C.Promise((function(t,e){function n(t){var n=v.FloodgateEngine.getTelemetryLogger();n&&n.log_Event(b.TelemetryEvent.Floodgate.Initialize.Failed,{ErrorMessage:t}),e(t)}g.default.isStorageAvailable()?T?t():o.initialize().then((function(){s.get().OfficeBrowserFeedback.floodgate=s.get().OfficeBrowserFeedback.floodgate||{};var e=s.get().OfficeBrowserFeedback.floodgate.initOptions;if(void 0!==(e=e||{}).campaignDefinitions){var i=y.FilterValidCampaignDefinitions(e.campaignDefinitions);if(i.error)return void n("floodgate.initOptions.campaignDefinitions error: "+i.error);(new g.default).write(S.IFloodgateStorageProvider.FileType.CampaignDefinitions,JSON.stringify(e.campaignDefinitions))}a.get().setFloodgateInitOptions(s.get().OfficeBrowserFeedback.floodgate.initOptions),v.FloodgateEngine.setTelemetryLogger(new h.default),T=!0,t()})).catch((function(t){n("Initialization failed: {"+t+"}")})):n("window.localStorage is not available.")}))}function O(t,e){if(void 0===e&&(e=null),A)return A;I++;var n=new C.Promise((function(n,o){function r(t){var e=v.FloodgateEngine.getTelemetryLogger();e&&e.log_Event(b.TelemetryEvent.Floodgate.Start.Failed,{Count:I,ErrorMessage:t}),o(t)}try{if(e||E||(E=new m.TargetedMessagingCampaignDefinitionProvider),!(i=e||v.FloodgateEngine.make(a.get().getCommonInitOptions().build||"",u.default.make(),a.get().getFloodgateInitOptions().onSurveyActivatedCallback,new g.default,a.get().getFloodgateInitOptions().settingStorageCallback,new f.default,new p.default,new l.default,[E])))return F(null),void r("Failed to create floodgate engine");if(t||1<I)i.start(),n();else{var s=i.startAsync();if(!s)return F(null),void r("Failed to get floodgate engine");s.then((function(){n()})).catch((function(t){F(null),r("Failed to start floodgate engine: "+(t&&t.message))}))}}catch(n){F(null),r("Failed to start floodgate engine: "+(n&&n.toString()))}}));return F(n),n.catch((function(t){F(null)})),n}function N(t){return void 0===t&&(t=!1),O(t)}function D(){i&&i.stop(),F(null)}function x(){return i}function P(t){return new C.Promise((function(e,n){w?n("Control already open"):(a.get().setFloodgateSurvey(t||new d.default),r.createSurvey((function(){w=!1})),w=!0,e())}))}function L(t){return P(new c.default(t))}function U(){I=0,E=i=A=null}function k(){return S.IFloodgateSettingIdMap.RoamingSettingIdMap}n.setEngineStartPromise=F,n.getEngineStartPromise=function(){return A},n.initialize=_,n.startInternal=O,n.start=N,n.stop=D,n.getEngine=x,n.showSurvey=P,n.showCustomSurvey=L,n.resetEngine=U,n.reset=function(){o.reset(),w=T=!1,U()},n.getSettingIdMap=k,s.setFloodgateShowCustomSurvey(L),s.setFloodgateShowSurvey(P),s.setFloodgateGetEngine(x),s.setFloodgateInitialize(_),s.setFloodgateStart(N),s.setFloodgateStop(D),s.getSettingIdMap(k)},{"./App_Common":51,"./Configuration/Configuration":55,"./FloodgateCore/AdaptiveSurveyLauncherFactory":58,"./FloodgateCore/FloodgateEnvironmentProvider":60,"./FloodgateCore/FloodgateStorageProvider":61,"./FloodgateCore/FloodgateStringProvider":62,"./FloodgateCore/FloodgateTelemetryLogger":63,"./FloodgateCore/TransporterFactory":65,"./FloodgateCore/UISurvey/CustomUISurvey":66,"./FloodgateCore/UISurvey/DummyUISurvey":67,"./TargetedMessaging/TargetedMessagingCampaignDefinitionProvider":79,"./UI/UI":105,"./Window/Window":111,"@ms-ofb/officefloodgatecore":1,"@ms-ofb/officefloodgatecore/dist/src/Api/Api":5,"@ms-ofb/officefloodgatecore/dist/src/Campaign/CampaignDefinitionProvider":13,"@ms-ofb/officefloodgatecore/dist/src/Constants":17,"es6-promise":45}],53:[function(t,e,n){"use strict";n.__esModule=!0;var i=t("./App_Common"),o=t("./Configuration/Configuration"),r=t("./Logging/Logging"),a=t("./UI/UI"),s=t("./Window/Window"),u=t("es6-promise"),l=!1;function c(){return new u.Promise((function(t,e){l?t():i.initialize().then((function(){s.get().OfficeBrowserFeedback.initOptions?(o.get().setInAppFeedbackInitOptions(s.get().OfficeBrowserFeedback.initOptions),l=!0,t()):e("Window.OfficeBrowserFeedback.initOptions not set")})).catch((function(t){e("Initialization failed: {"+t+"}")}))}))}n.initialize=c;var d=!1;function p(t){return new u.Promise((function(e,n){d?n("Control already open"):c().then((function(){o.get().setInAppFeedbackLaunchOptions(t),a.createBellyBandMulti((function(){d=!1})),r.getLogger().logEvent(r.EventIds.InApp.UI.Picker.Shown.VALUE,1,{IsBugEnabled:o.get().getInAppFeedbackInitOptions().bugForm,IsIdeaEnabled:void 0!==o.get().getInAppFeedbackInitOptions().userVoice}),d=!0,e()})).catch((function(t){n("Initialization failed: {"+t+"}")}))}))}function g(t,e){return new u.Promise((function(n,i){var s;d?i("Control already open"):(s=o.validateFeedbackType(t),c().then((function(){o.get().setInAppFeedbackLaunchOptions(e),a.createBellyBandSingle((function(){d=!1}),s),r.getLogger().logEvent(r.EventIds.InApp.UI.Form.Shown.VALUE,1,{FeedbackType:s}),d=!0,n()})).catch((function(t){i("Initialization failed: {"+t+"}")})))}))}n.multiFeedback=p,n.singleFeedback=g,n.reset=function(){i.reset(),d=l=!1},s.setMultiFeedback(p),s.setSingleFeedback(g)},{"./App_Common":51,"./Configuration/Configuration":55,"./Logging/Logging":71,"./UI/UI":105,"./Window/Window":111,"es6-promise":45}],54:[function(t,e,n){"use strict";n.__esModule=!0,n.buildQueryParameters=function(t,e){void 0===e&&(e=!0);var n,i,o="";for(n in t||[])!t.hasOwnProperty(n)||null!=(i=t[n])&&"object"!==r(i)&&(o+=(o?"&":"")+n+"="+(e?encodeURIComponent(i):i));return o}},{}],55:[function(t,e,n){"use strict";n.__esModule=!0;var i=t("./../Utils"),o=t("./../Constants"),r=t("./../Localization");a.validateCategoryOptions=function(t){if(!t)return{show:!1};if(i.expectBoolean(t.show,"categories.show"),t.customCategories){i.expectArray(t.customCategories,"categories.customCategories");for(var e=0,n=t.customCategories;e<n.length;e++){var o=n[e];if(i.expectString(o,"custom category '"+o+"'"),20<o.length)throw"custom category '"+o+"' too long, max 20 characters."}}return t},a.prototype.getCommonInitOptions=function(){return this.commonInitOptions},a.prototype.getInAppFeedbackInitOptions=function(){return this.inAppFeedbackInitOptions},a.prototype.getInAppFeedbackLaunchOptions=function(){return this.inAppFeedbackLaunchOptions},a.prototype.getFloodgateInitOptions=function(){return this.floodgateInitOptions},a.prototype.getFloodgateSurvey=function(){return this.floodgateSurvey},a.prototype.getSdkSessionId=function(){return this.sdkSessionId||(this.sdkSessionId=i.guid()),this.sdkSessionId},a.prototype.setCommonInitOptions=function(t){i.expectObject(t,"passedInitOptions");var e={appId:t.appId,applicationGroup:t.applicationGroup||{},build:t.build,cid:t.cid,environment:t.environment,intlFilename:t.intlFilename,intlUrl:t.intlUrl,webSurfacesResourceBaseUrl:t.webSurfacesResourceBaseUrl,locale:t.locale,onError:t.onError,originalLocale:t.locale,primaryColour:t.primaryColour,secondaryColour:t.secondaryColour,sessionId:t.sessionId,stylesUrl:t.stylesUrl,telemetryGroup:t.telemetryGroup||{},userEmail:t.userEmail,userEmailConsentDefault:t.userEmailConsentDefault,webGroup:t.webGroup||{}};if(i.expectNumber(e.appId,"initOptions.appId"),!(e.appId%1==0&&0<e.appId))throw"initOptions.appId is not a positive integer: "+e.appId;if(i.expectString(e.stylesUrl,"initOptions.stylesUrl"),i.expectString(e.intlUrl,"initOptions.intlUrl"),void 0!==e.intlFilename?i.expectString(e.intlFilename,"initOptions.intlFilename"):e.intlFilename="officebrowserfeedbackstrings.js",i.expectNumber(e.environment,"initOptions.environment"),1!==e.environment&&0!==e.environment)throw"initOptions.environment has a bad value: "+e.environment;void 0!==e.userEmail&&i.expectString(e.userEmail,"initOptions.userEmail"),void 0!==e.userEmailConsentDefault&&i.expectBoolean(e.userEmailConsentDefault,"initOptions.userEmailConsentDefault"),void 0!==e.sessionId?i.expectString(e.sessionId,"initOptions.sessionId"):e.sessionId="00000000-0000-0000-0000-000000000000",e.telemetryGroup.processSessionId=e.sessionId,void 0!==e.cid&&(i.expectString(e.cid,"initOptions.cid"),e.applicationGroup.extendedManifestData=JSON.stringify({cid:e.cid})),void 0!==e.build?(i.expectString(e.build,"initOptions.build"),new RegExp("^[0-9]{1,9}(\\.[0-9]{1,9})?(\\.[0-9]{1,9})?(\\.[0-9]{1,9})?$").test(e.build)||(e.build="0.0.0.0")):e.build="0.0.0.0",e.telemetryGroup.officeBuild=e.build,t=new RegExp("^#[0-9a-f]{3}([0-9a-f]{3})?$","i"),void 0!==e.primaryColour&&(t.test(e.primaryColour)||(e.primaryColour=void 0)),void 0!==e.secondaryColour&&(t.test(e.secondaryColour)||(e.secondaryColour=void 0)),void 0!==e.locale?(i.expectString(e.locale,"initOptions.locale"),e.locale=r.validate(e.locale)):e.locale="en",void 0===e.onError&&(e.onError=function(t){}),this.commonInitOptions=e},a.prototype.setInAppFeedbackInitOptions=function(t){i.expectObject(t,"passedInitOptions"),void 0===(t={bugForm:t.bugForm,onDismiss:t.onDismiss,screenshot:t.screenshot,userEmail:t.userEmail,userVoice:void 0!==t.userVoice?{url:t.userVoice.url}:void 0}).onDismiss&&(t.onDismiss=function(t){}),void 0!==t.bugForm?i.expectBoolean(t.bugForm,"initOptions.bugForm"):t.bugForm=!1,void 0!==t.userEmail&&i.expectString(t.userEmail,"initOptions.userEmail"),void 0!==t.screenshot?i.expectBoolean(t.screenshot,"initOptions.screenshot"):t.screenshot=!0,void 0!==t.userVoice&&(i.expectObject(t.userVoice,"initOptions.userVoice"),i.expectString(t.userVoice.url,"initOptions.userVoice.url")),this.inAppFeedbackInitOptions=t},a.prototype.setInAppFeedbackLaunchOptions=function(t){if(!this.commonInitOptions)throw"commonInitOptions not set";t=t||{},this.commonInitOptions.applicationGroup=i.overrideValues(t.applicationGroup,this.commonInitOptions.applicationGroup),this.commonInitOptions.telemetryGroup=i.overrideValues(t.telemetryGroup,this.commonInitOptions.telemetryGroup),this.commonInitOptions.webGroup=i.overrideValues(t.webGroup,this.commonInitOptions.webGroup),t.categories=a.validateCategoryOptions(t.categories),this.inAppFeedbackLaunchOptions=t},a.prototype.setFloodgateInitOptions=function(t){i.expectObject(t,"passedInitOptions"),void 0===(t={autoDismiss:t.autoDismiss,campaignDefinitions:t.campaignDefinitions,campaignFlights:t.campaignFlights,campaignQueryParameters:t.campaignQueryParameters,onDismiss:t.onDismiss,onSurveyActivatedCallback:t.onSurveyActivatedCallback,settingStorageCallback:t.settingStorageCallback,uIStringGetter:t.uIStringGetter,authTokenCallback:t.authTokenCallback}).autoDismiss&&(t.autoDismiss=o.AutoDismissValues.NoAutoDismiss),void 0===t.onDismiss&&(t.onDismiss=function(t,e){}),void 0===t.onSurveyActivatedCallback&&(t.onSurveyActivatedCallback={onSurveyActivated:function(t){t.launch()}}),void 0===t.uIStringGetter&&(t.uIStringGetter=function(t){return t}),this.floodgateInitOptions=t},a.prototype.setFloodgateSurvey=function(t){this.floodgateSurvey=t},t=a;function a(){}var s=new(n.Configuration=t);n.get=function(){return s},n.validateFeedbackType=function(t){if(i.expectString(t,"feedbackType"),t===o.FeedbackType[o.FeedbackType.Smile])return o.FeedbackType.Smile;if(t===o.FeedbackType[o.FeedbackType.Frown])return o.FeedbackType.Frown;if(t===o.FeedbackType[o.FeedbackType.Bug])return o.FeedbackType.Bug;throw"feedbackType should be one of Smile, Frown or Bug"}},{"./../Constants":57,"./../Localization":69,"./../Utils":107}],56:[function(t,e,n){"use strict";n.__esModule=!0;var i=t("../Utils"),o=t("../FloodgateCore/FloodgateStorageProvider"),r=t("../TargetedMessaging/TargetedMessagingCache"),a=null;n.getDynamicSetting=function(t,e){if(!a&&o.default.isStorageAvailable()&&(a=new r.TargetedMessagingCache(["DynamicSettings"])),!a)return e;var n=(n=a.getItem("DynamicSettings"))&&n.content;return i.isNullorUndefined(n)||!n.hasOwnProperty(t)||i.isNullorUndefined(n[t])?e:n[t]},n.resetDynamicSettingsTmsgCache=function(){a=null}},{"../FloodgateCore/FloodgateStorageProvider":61,"../TargetedMessaging/TargetedMessagingCache":78,"../Utils":107}],57:[function(t,e,n){"use strict";n.__esModule=!0;var i=(o.AriaLabel="aria-label",o.AriaSelected="aria-selected",o.AriaOrientation="aria-orientation",o.AriaExpanded="aria-expanded",o.AriaControls="aria-controls",o.AriaHasPopups="aria-haspopup",o.AriaModal="aria-modal",o.AriaLabelledBy="aria-labelledby",o.AriaDescribedBy="aria-describedby",o.Class="class",o.DataHtml2CanvasIgnore="data-html2canvas-ignore",o.Disabled="disabled",o.Fill="fill",o.For="for",o.Form="form",o.Height="height",o.HRef="href",o.Id="id",o.MaxLength="maxlength",o.Name="name",o.Placeholder="placeholder",o.Points="points",o.Rel="rel",o.Role="role",o.Source="src",o.Stroke="stroke",o.TabIndex="tabindex",o.Target="target",o.Transform="transform",o.Type="type",o.Value="value",o.ViewBox="viewBox",o.Width="width",o.xlinkHref="xlink:href",o.X="x",o.Y="y",o);function o(){}function r(){}function a(){}function s(){}function u(){}function l(){}function c(){}function d(){}function p(){}function g(){}n.AttributeName=i,r.BlankWindow="_blank",r.Button="button",r.Dialog="dialog",r.Tab="tab",r.TabList="tablist",r.TabPanel="tabpanel",r.Checkbox="checkbox",r.Checked="checked",r.False="false",r.Zero="0",r.Polite="polite",r.Radio="radio",r.Submit="submit",r.Text="text",r.TextAreaMaxLength="1000",r.True="true",r.Unchecked="unchecked",r.NoReferrer="noreferrer",r.AriaOrientationValueVertical="vertical",i=r,n.AttributeValue=i,a.CLCID="CLCID",i=a,n.UrlParameters=i,s.CheckBox="obf-CheckBox",s.FontSubtitle="obf-FontSubtitle",s.FontText="obf-FontText",s.FontSubText="obf-FontSubText",s.FontSubSubText="obf-FontSubSubText",s.Hidden="obf-Hidden",s.Link="obf-Link",s.MarginLeft60px="obf-MarginLeft60px",s.NarrowLayout="obf-NarrowLayout",s.PrivacyStatementLinkDiv="obf-PrivacyStatementLinkDiv",s.Rtl="obf-Rtl",s.Spinner="obf-Spinner",s.SpinnerCircle="obf-SpinnerCircle",s.SubmitButton="obf-SubmitButton",s.TextInput="obf-TextInput",s.Visible="obf-Visible",s.Rating="obf-Rating",s.RatingGraphic="obf-RatingGraphic",s.RatingGraphicFilled="obf-RatingGraphic-Filled",s.ChoiceGroup="obf-ChoiceGroup",s.ChoiceGroupIcon="obf-ChoiceGroupIcon",s.OverallAnchor="obf-OverallAnchor",s.OverallAnchorActive="obf-OverallAnchorActive",s.OverallImage="obf-OverallImage",s.OverallText="obf-OverallText",s.SingleLayout="obf-SingleLayout",s.ShowRightBorder="obf-ShowRightBorder",s.SlideLeft="obf-slideLeft",s.TextAlignLeft="obf-TextAlignLeft",s.FormContainer="obf-FormContainer",s.FormQuestionMiddleText="obf-FormQuestionMiddleText",s.FormMiddleText="obf-FormMiddleText",s.FormCategoriesDropdown="obf-FormCategoriesDropdown",s.FormComment="obf-FormComment",s.FormRatingContainer="obf-FormRatingContainer",s.FormRatingLabel="obf-FormRatingLabel",s.FormRating="obf-FormRating",s.FormEmailInput="obf-FormEmailInput",s.FormBottomContainer="obf-FormBottomContainer",s.FormSubmitButtonContainer="obf-FormSubmitButtonContainer",s.FormScreenshotContainer="obf-FormScreenshotContainer",s.FormScreenshotLabel="obf-FormScreenshotLabel",s.FormScreenshotCheckbox="obf-FormScreenshotCheckbox",s.TFormEmailCheckbox="obf-TFormEmailCheckbox",s.TFormEmailLabel="obf-TFormEmailLabel ",s.EmailCheckBoxLabel="obf-EmailCheckBoxLabel",s.Toast="obf-Toast",i=s,n.Classes=i,u.ColumnSeparatorDiv="obf-ColumnSeparatorDiv",u.OverallAnchorsContainer="obf-OverallAnchorsContainer",u.OverallFrownAnchor="obf-OverallFrownAnchor",u.OverallFrownDiv="obf-OverallFrownDiv",u.OverallFrownImage="obf-OverallFrownImage",u.OverallFrownText="obf-OverallFrownText",u.OverallSmileAnchor="obf-OverallSmileAnchor",u.OverallSmileDiv="obf-OverallSmileDiv",u.OverallSmileImage="obf-OverallSmileImage",u.OverallSmileText="obf-OverallSmileText",u.OverallIdeaAnchor="obf-OverallIdeaAnchor",u.OverallIdeaDiv="obf-OverallIdeaDiv",u.OverallIdeaImage="obf-OverallIdeaImage",u.OverallIdeaText="obf-OverallIdeaText",u.OverallBugAnchor="obf-OverallBugAnchor",u.OverallBugDiv="obf-OverallBugDiv",u.OverallBugImage="obf-OverallBugImage",u.OverallBugText="obf-OverallBugText",u.QuestionLeftText="obf-QuestionLeftText",u.LeftFormContainer="obf-LeftFormContainer",u.MainContainer="obf-MainContainer",u.MainContentHolder="obf-MainContentHolder",u.MiddleFormContainer="obf-MiddleFormContainer",u.OverlayBackground="obf-OverlayBackground",u.PrivacyStatementLink="obf-PrivacyStatementLink",u.FirstTabbable="obf-FirstTabbable",u.LastTabbable="obf-LastTabbable",u.SingleFormContainer="obf-SingleFormContainer",u.SingleFormQuestionMiddleText="obf-SingleFormQuestionMiddleText",u.SingleFormCategoriesDropdown="obf-SingleFormCategoriesDropdown",u.SingleFormComment="obf-SingleFormComment",u.SingleFormEmailInput="obf-SingleFormEmailInput",u.SingleFormRating="obf-SingleFormRating",u.SingleFormScreenshotCheckbox="obf-SingleFormScreenshotCheckbox",u.SingleFormSubmitButton="obf-SingleFormSubmitButton",u.SingleFormSubmitButtonSpinner="obf-SingleFormSubmitButtonSpinner",u.BasicFormContainer="obf-BasicFormContainer",u.BasicFormQuestionMiddleText="obf-BasicFormQuestionMiddleText",u.BasicFormCategoriesDropdown="obf-BasicFormCategoriesDropdown",u.BasicFormComment="obf-BasicFormComment",u.BasicFormEmailInput="obf-BasicFormEmailInput",u.BasicFormRating="obf-BasicFormRating",u.BasicFormScreenshotCheckbox="obf-BasicFormScreenshotCheckbox",u.BasicFormSubmitButton="obf-BasicFormSubmitButton",u.BasicFormSubmitButtonSpinner="obf-BasicFormSubmitButtonSpinner",u.UserVoiceFormContainer="obf-UserVoiceFormContainer",u.UserVoiceFormGoButton="obf-UserVoiceFormGoButton",u.ToastContainer="obf-ToastContainer",u.ToastCancel="obf-ToastCancel",u.TPromptContainer="obf-TPromptContainer",u.TPromptTitle="obf-TPromptTitle",u.TPromptText="obf-TPromptText",u.TFormContainer="obf-TFormContainer",u.TFormTitle="obf-TFormTitle",u.TFormRating="obf-TFormRating",u.TFormRatingQuestion="obf-TFormRatingQuestion",u.TFormComment="obf-TFormComment",u.TFormEmailTextBox="obf-TFormEmailTextBox",u.TFormEmailCheckBox="obf-TFormEmailCheckBox",u.TFormEmailLabel="obf-TFormEmailLabel",u.TFormSubmitButton="obf-TFormSubmitButton",u.TFormSubmitButtonSpinner="obf-TFormSubmitButtonSpinner",u.TFormSubmitButtonContainer="obf-TFormSubmitButtonContainer",i=u,n.IDs=i,l.Esc=27,l.Tab=9,i=l,n.Keys=i,(i=n.FeedbackType||(n.FeedbackType={}))[i.Smile=0]="Smile",i[i.Frown=1]="Frown",i[i.Idea=2]="Idea",i[i.Bug=3]="Bug",(i=n.Environment||(n.Environment={}))[i.Production=0]="Production",i[i.Int=1]="Int",(i=n.AutoDismissValues||(n.AutoDismissValues={}))[i.NoAutoDismiss=0]="NoAutoDismiss",i[i.SevenSeconds=1]="SevenSeconds",i[i.FourteenSeconds=2]="FourteenSeconds",i[i.TwentyOneSeconds=3]="TwentyOneSeconds",i[i.TwentyEightSeconds=4]="TwentyEightSeconds",c.Anchor="A",c.Button="button",c.Defs="defs",c.Div="div",c.FieldSet="fieldset",c.Form="form",c.Img="img",c.Input="input",c.Label="label",c.Legend="legend",c.Option="option",c.Polygon="polygon",c.Select="select",c.Span="span",c.Svg="svg",c.TextArea="textarea",c.Use="use",i=c,n.Tags=i,d.PrivacyStatementLink="http://go.microsoft.com/fwlink/?LinkID=390004",i=d,n.Urls=i,p.WebSurfacesLink="https://contentstorage.osi.office.net/dynamiccanvas/programmablesurfaces/prod/officewebsurfaces.core.min.js",i=p,n.DynamicScriptUrls=i,g.TMSAppID="4c4f550b-42b2-4a16-93f9-fdb9e01bb6ed",i=g,n.GUIDs=i},{}],58:[function(t,e,n){"use strict";n.__esModule=!0;var i=t("./CoachingUXLauncherFactory"),o=t("./RudeSurveyLauncherFactory"),r=t("util");a.make=function(){return new a(new o.default,new i.default)},a.prototype.makeSurveyLauncher=function(t){if(r.isNullOrUndefined(t))return null;switch(t.getLauncherType().toLocaleLowerCase()){case i.default.LAUNCHER_TYPE:return this.makeGenericMessagingSurfaceLauncher(t);case o.default.LAUNCHER_TYPE:default:return this.makeRudeSurveyLauncher(t)}},a.prototype.AcceptsSurvey=function(t){if(r.isNullOrUndefined(t))return!1;switch(t.getLauncherType().toLocaleLowerCase()){case i.default.LAUNCHER_TYPE:return!r.isNullOrUndefined(this.coachingUXLauncherFactory)&&this.coachingUXLauncherFactory.AcceptsSurvey(t);case o.default.LAUNCHER_TYPE:default:return!r.isNullOrUndefined(this.rudeSurveyLauncherFactory)&&this.rudeSurveyLauncherFactory.AcceptsSurvey(t)}},a.prototype.makeGenericMessagingSurfaceLauncher=function(t){return r.isNullOrUndefined(this.coachingUXLauncherFactory)?null:this.coachingUXLauncherFactory.makeSurveyLauncher(t)},a.prototype.makeRudeSurveyLauncher=function(t){return r.isNullOrUndefined(this.rudeSurveyLauncherFactory)?null:this.rudeSurveyLauncherFactory.makeSurveyLauncher(t)},t=a;function a(t,e){this.rudeSurveyLauncherFactory=t,this.coachingUXLauncherFactory=e}n.default=t},{"./CoachingUXLauncherFactory":59,"./RudeSurveyLauncherFactory":64,util:49}],59:[function(t,e,n){"use strict";var i=this&&this.__assign||Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t};n.__esModule=!0;var o=t("@ms-ofb/officefloodgatecore"),r=t("util"),a=t("./../Configuration/Configuration"),s=t("../Configuration/DynamicConfiguration"),u=t("../Constants"),l=t("../Window/DomUtils"),c=t("../Window/Window"),d=t("../Logging/Logging"),p=t("../TargetedMessaging/AssetsProvider");g.prototype.makeSurveyLauncher=function(t){return this.AcceptsSurvey(t)?new f(t):null},g.prototype.AcceptsSurvey=function(t){return!r.isNullOrUndefined(t)&&t.getType()===o.Api.ISurvey.Type.GenericMessagingSurface&&t.getLauncherType().toLocaleLowerCase()===g.LAUNCHER_TYPE},g.LAUNCHER_TYPE="coachingux",t=g;function g(){}n.default=t;var f=(h.prototype.launch=function(){var t=this.survey&&this.survey.getSurveyInfo(),e=t&&t.getMetadata(),n=e&&e.getContentMetadata();if(n){var o=new Date,r=function(){var t=c.get();return t&&t.OfficeWebSurfaces},g=function(e){var i=r();e&&i.Initialize(e),i.RemoveSurface(),i.RenderSurface(n,null,t.getBackEndId())},f=function(t){d.getLogger().logEvent(d.EventIds.WebSurfaces.Common.Error.VALUE,1,{ErrorMessage:"Error loading websurfaces"+(t&&t.message?": "+t.message:""),TimeMilliseconds:Date.now()-+o})};try{if(r())return void g();l.loadScript(s.getDynamicSetting("WebSurfacesLink",u.DynamicScriptUrls.WebSurfacesLink),null).then((function(){var e=a.get().getCommonInitOptions();e=i({},e,{beaconCallback:function(t){t&&p.get().setCampaignAction(t)},surfaceInitTime:o,surfaceId:t.getBackEndId(),logSessionId:a.get().getSdkSessionId(),logSettings:s.getDynamicSetting("LogLevelSettings",void 0)});g(e)})).catch((function(t){f(t)}))}catch(e){f(e)}}},h);function h(t){this.survey=t}n.CoachingUXLauncher=f},{"../Configuration/DynamicConfiguration":56,"../Constants":57,"../Logging/Logging":71,"../TargetedMessaging/AssetsProvider":77,"../Window/DomUtils":110,"../Window/Window":111,"./../Configuration/Configuration":55,"@ms-ofb/officefloodgatecore":1,util:49}],60:[function(t,e,n){"use strict";n.__esModule=!0;var i=t("./../Configuration/Configuration");o.prototype.getLanguage=function(){return i.get().getCommonInitOptions().originalLocale},t=o;function o(){}n.default=t},{"./../Configuration/Configuration":55}],61:[function(t,e,n){"use strict";n.__esModule=!0;var i=t("@ms-ofb/officefloodgatecore/dist/src/Api/Api"),o=t("./../Window/Window"),r=t("./../Logging/Logging"),a=i.IFloodgateStorageProvider.FileType,s=((i={})[a.CampaignDefinitions]="obf-CampaignDefinitions",i[a.CampaignStates]="obf-CampaignStates",i[a.FloodgateSettings]="obf-FloodgateSettings",i[a.GovernedChannelStates]="obf-GovernedChannelStates",i[a.SurveyActivationStats]="obf-SurveyActivationStats",i[a.SurveyEventActivityStats]="obf-SurveyEventActivityStats",i[a.TmsCache_CampaignContent]="obf-TmsCampaignContent",i[a.TmsCache_MessageMetadata]="obf-TmsMessageMetadata",i[a.TmsCache_UserGovernance]="obf-TmsUserGovernance",i[a.Tms_DynamicSettings]="obf-TmsDynamicSettings",i[a.LogLevelSettings]="obf-LogLevelSettings",i);u.isStorageAvailable=function(){try{var t="__storage_test__";return o.get().localStorage.setItem(t,t),o.get().localStorage.removeItem(t),!0}catch(t){return t instanceof DOMException&&(22===t.code||1014===t.code||"QuotaExceededError"===t.name||"NS_ERROR_DOM_QUOTA_REACHED"===t.name)&&0!==o.get().localStorage.length}},u.prototype.fileLock=function(t){},u.prototype.fileUnlock=function(t){},u.prototype.read=function(t){if(!(t in a))return"";var e,n=s[t];try{e=o.get().localStorage.getItem(n)}catch(t){return r.getLogger().logEvent(r.EventIds.Survey.Floodgate.FileRead.Failed.VALUE,2,{ErrorMessage:t.toString(),FileName:n}),""}return e},u.prototype.write=function(t,e){if(t in a){var n=s[t];try{o.get().localStorage.setItem(n,e)}catch(t){return void r.getLogger().logEvent(r.EventIds.Survey.Floodgate.FileWrite.Failed.VALUE,2,{ErrorMessage:t.toString(),FileName:n})}}},i=u;function u(){}n.default=i},{"./../Logging/Logging":71,"./../Window/Window":111,"@ms-ofb/officefloodgatecore/dist/src/Api/Api":5}],62:[function(t,e,n){"use strict";n.__esModule=!0;var i=t("@ms-ofb/officefloodgatecore/dist/src/Api/Api"),o=t("./../UIStrings/UIStrings"),r=t("./../Configuration/Configuration");a.prototype.loadStringResource=function(t){var e=o.getUIStrings();switch(t){case i.IFloodgateStringProvider.StringType.Nps11RatingValue0:return e.Floodgate.Nps.Rating.Points11Value0;case i.IFloodgateStringProvider.StringType.Nps11RatingValue1:return e.Floodgate.Nps.Rating.Points11Value1;case i.IFloodgateStringProvider.StringType.Nps11RatingValue2:return e.Floodgate.Nps.Rating.Points11Value2;case i.IFloodgateStringProvider.StringType.Nps11RatingValue3:return e.Floodgate.Nps.Rating.Points11Value3;case i.IFloodgateStringProvider.StringType.Nps11RatingValue4:return e.Floodgate.Nps.Rating.Points11Value4;case i.IFloodgateStringProvider.StringType.Nps11RatingValue5:return e.Floodgate.Nps.Rating.Points11Value5;case i.IFloodgateStringProvider.StringType.Nps11RatingValue6:return e.Floodgate.Nps.Rating.Points11Value6;case i.IFloodgateStringProvider.StringType.Nps11RatingValue7:return e.Floodgate.Nps.Rating.Points11Value7;case i.IFloodgateStringProvider.StringType.Nps11RatingValue8:return e.Floodgate.Nps.Rating.Points11Value8;case i.IFloodgateStringProvider.StringType.Nps11RatingValue9:return e.Floodgate.Nps.Rating.Points11Value9;case i.IFloodgateStringProvider.StringType.Nps11RatingValue10:return e.Floodgate.Nps.Rating.Points11Value10;case i.IFloodgateStringProvider.StringType.Nps5RatingValue1:return e.Floodgate.Nps.Rating.Points5Value1;case i.IFloodgateStringProvider.StringType.Nps5RatingValue2:return e.Floodgate.Nps.Rating.Points5Value2;case i.IFloodgateStringProvider.StringType.Nps5RatingValue3:return e.Floodgate.Nps.Rating.Points5Value3;case i.IFloodgateStringProvider.StringType.Nps5RatingValue4:return e.Floodgate.Nps.Rating.Points5Value4;case i.IFloodgateStringProvider.StringType.Nps5RatingValue5:return e.Floodgate.Nps.Rating.Points5Value5;case i.IFloodgateStringProvider.StringType.NpsRatingQuestion:return e.Floodgate.Nps.Rating.Question;case i.IFloodgateStringProvider.StringType.NpsCommentQuestion:return e.Floodgate.Nps.Comment.Question;case i.IFloodgateStringProvider.StringType.NpsPromptNotNowLabel:return e.Floodgate.Nps.Prompt.No;case i.IFloodgateStringProvider.StringType.NpsPromptQuestion:return e.Floodgate.Nps.Prompt.Question;case i.IFloodgateStringProvider.StringType.NpsPromptTitle:return e.Floodgate.Nps.Prompt.Title;case i.IFloodgateStringProvider.StringType.NpsPromptYesLabel:return e.Floodgate.Nps.Prompt.Yes;default:return""}},a.prototype.getCustomString=function(t){return r.get().getFloodgateInitOptions().uIStringGetter(t)},t=a;function a(){}n.default=t},{"./../Configuration/Configuration":55,"./../UIStrings/UIStrings":88,"@ms-ofb/officefloodgatecore/dist/src/Api/Api":5}],63:[function(t,e,n){"use strict";n.__esModule=!0;var i=t("../Logging/Logging");o.prototype.log_TriggerMet=function(t,e,n){i.getLogger().logEvent(i.EventIds.Survey.Floodgate.TriggerMet.VALUE,1,{CampaignId:t,SurveyId:e,SurveyType:n})},o.prototype.log_UserSelected=function(t,e,n){this.isLoggingSignalUnsampled()&&i.getLogger().logEvent(i.EventIds.Survey.Floodgate.UserSelected.VALUE,1,{CampaignId:t,SurveyId:e,SurveyType:n})},o.prototype.log_CampaignLoad_Failed=function(t){i.getLogger().logEvent(i.EventIds.Survey.Floodgate.CampaignLoad.Failed.VALUE,2,{ErrorMessage:t})},o.prototype.log_Event=function(t,e){t={name:t},i.getLogger().logEvent(t,1,e)},o.prototype.isLoggingSignalUnsampled=function(){return this.SAMPLING_RESULT<this.SAMPLING_PERCENTAGE},t=o;function o(){this.SAMPLING_PERCENTAGE=1,this.SAMPLING_RANGE=100,this.SAMPLING_RESULT=Math.floor(Math.random()*this.SAMPLING_RANGE)}n.default=t},{"../Logging/Logging":71}],64:[function(t,e,n){"use strict";n.__esModule=!0;var i=t("./../FloodgateCore/UISurvey/UISurvey"),o=t("./../Window/Window"),r=t("@ms-ofb/officefloodgatecore"),a=t("util");s.prototype.makeSurveyLauncher=function(t){return this.AcceptsSurvey(t)?new u(t):null},s.prototype.AcceptsSurvey=function(t){return!a.isNullOrUndefined(t)&&t.getType()!==r.Api.ISurvey.Type.GenericMessagingSurface},s.LAUNCHER_TYPE=r.Api.ISurvey.LAUNCHER_TYPE_DEFAULT,t=s;function s(){}n.default=t;var u=(l.prototype.launch=function(){o.get().OfficeBrowserFeedback.floodgate.showSurvey(new i.default(this.survey))},l);function l(t){this.survey=t}n.RudeSurveyLauncher=u},{"./../FloodgateCore/UISurvey/UISurvey":68,"./../Window/Window":111,"@ms-ofb/officefloodgatecore":1,util:49}],65:[function(t,e,n){"use strict";n.__esModule=!0;var i=t("./../Transport/Transport"),o=t("./../Configuration/Configuration");r.prototype.makeTransporter=function(t){return new i.Transporter(o.get().getCommonInitOptions().environment,t,o.get().getCommonInitOptions().appId,"Survey",o.get().getCommonInitOptions().applicationGroup,o.get().getCommonInitOptions().telemetryGroup,o.get().getCommonInitOptions().webGroup)},t=r;function r(){}n.default=t},{"./../Configuration/Configuration":55,"./../Transport/Transport":87}],66:[function(t,e,n){"use strict";n.__esModule=!0;var i=t("../../Utils");o.prototype.getPromptQuestion=function(){return this.survey.promptQuestion},o.prototype.getTitle=function(){return this.survey.title},o.prototype.getPromptYesButtonText=function(){return this.survey.promptYesButtonText},o.prototype.getPromptNoButtonText=function(){return this.survey.promptNoButtonText},o.prototype.getRatingValuesAscending=function(){return this.survey.ratingValuesAscending},o.prototype.getRatingQuestion=function(){return this.survey.ratingQuestion},o.prototype.getCommentQuestion=function(){return this.survey.commentQuestion},o.prototype.setValues=function(t,e){this.comment=e,this.isRatingIndexValid(t)?this.ratingIndex=t:this.ratingIndex=-1},o.prototype.getJsonElements=function(){var t={};return t.comment=this.comment,t.rating=this.getNormalizedRatingScore(),t.survey={surveyId:this.getCampaignId()},t},o.prototype.getSurveyType=function(){return this.survey.surveyType},o.prototype.getCampaignId=function(){return this.survey.campaignId},o.prototype.getId=function(){return this.getCampaignId()},o.prototype.isRatingIndexValid=function(t){return 0<=t&&t<this.survey.ratingValuesAscending.length},o.prototype.getNormalizedRatingScore=function(){return this.isRatingIndexValid(this.ratingIndex)?this.survey.isZeroBased?this.ratingIndex/(this.survey.ratingValuesAscending.length-1):(this.ratingIndex+1)/this.survey.ratingValuesAscending.length:-1},t=o;function o(t){this.comment="",this.ratingIndex=-1,this.showPrompt=t.showPrompt,this.showEmailRequest=!!i.isBoolean(t.showEmailRequest)&&t.showEmailRequest,this.survey=t}n.default=t},{"../../Utils":107}],67:[function(t,e,n){"use strict";n.__esModule=!0;var i=t("../../Utils"),o=t("@ms-ofb/officefloodgatecore/dist/src/Api/Api");r.prototype.getPromptQuestion=function(){return"Prompt question?"},r.prototype.getTitle=function(){return"Title"},r.prototype.getPromptYesButtonText=function(){return"Yes"},r.prototype.getPromptNoButtonText=function(){return"No"},r.prototype.getRatingValuesAscending=function(){return["worst","worse","ok","better","best"]},r.prototype.getRatingQuestion=function(){return"Rating question?"},r.prototype.getCommentQuestion=function(){return"Comment question?"},r.prototype.setValues=function(t,e){e&&(this.comment=e),i.isInteger(t)&&0<=t&&t<=4&&(this.rating=t/4)},r.prototype.getJsonElements=function(){var t={};return this.comment&&(t.comment=this.comment),this.rating&&(t.rating=this.rating),t},r.prototype.getSurveyType=function(){return o.ISurvey.Type.Nps},r.prototype.getCampaignId=function(){return"10000000-0000-0000-0000-000000000000"},r.prototype.getId=function(){return"00000000-0000-0000-0000-000000000000"},t=r;function r(){this.showPrompt=!0,this.showEmailRequest=!0,this.comment=""}n.default=t},{"../../Utils":107,"@ms-ofb/officefloodgatecore/dist/src/Api/Api":5}],68:[function(t,e,n){"use strict";n.__esModule=!0;var i=t("@ms-ofb/officefloodgatecore/dist/src/Api/Api");o.prototype.getPromptQuestion=function(){return this.prompt.getQuestion()},o.prototype.getTitle=function(){return this.prompt.getTitle()},o.prototype.getPromptYesButtonText=function(){return this.prompt.getYesButtonText()},o.prototype.getPromptNoButtonText=function(){return this.prompt.getNoButtonText()},o.prototype.getRatingValuesAscending=function(){return this.rating.getRatingValuesAscending()},o.prototype.getRatingQuestion=function(){return this.rating.getQuestion()},o.prototype.getCommentQuestion=function(){return this.comment.getQuestion()},o.prototype.setValues=function(t,e){this.rating.setSelectedRatingIndex(t),this.comment.setSubmittedText(e)},o.prototype.getJsonElements=function(){return this.survey.getJsonElements()},o.prototype.getSurveyType=function(){return this.survey.getType()},o.prototype.getCampaignId=function(){return this.survey.getSurveyInfo().getBackEndId()},o.prototype.getId=function(){return this.survey.getSurveyInfo().getId()},t=o;function o(t){if(this.showPrompt=!0,this.showEmailRequest=!1,!t)throw Error("survey must not be null");var e=(this.survey=t).getComponent(i.ISurveyComponent.Type.Prompt),n=t.getComponent(i.ISurveyComponent.Type.Comment),o=t.getComponent(i.ISurveyComponent.Type.Rating);if(!e)throw Error("prompt component must not be null");if(this.prompt=e,this.showEmailRequest=t.getSurveyInfo().isAdditionalDataRequested(i.ISurveyInfo.AdditionalDataType.EmailAddress),!n)throw Error("comment component must not be null");if(this.comment=n,!o)throw Error("rating component must not be null");this.rating=o}n.default=t},{"@ms-ofb/officefloodgatecore/dist/src/Api/Api":5}],69:[function(t,e,n){"use strict";n.__esModule=!0;var i=["af","am","ar","as","az","be","bg","bn-BD","bn-IN","bs","ca","ca-Es-VALENCIA","chr-Cher","cs","cy","da","de","el","en-GB","es","es-MX","et","eu","fa","fi","fil","fr","fr-CA","ga","gd","gl","gu","ha-Latn-NG","he","hi","hr","hu","hy","id","is","it","ja","ka","kk","km-KH","kn","ko","kok","ky","lb","lo","lt","lv","mi","mk","ml","mn","mr","ms","mt","nb-NO","ne","nl","nn-NO","or","pa","pl","prs","pt-BR","pt-PT","quz","ro","ru","sd","si","sk","sl","sq","sr-Cyrl-BA","sr-Cyrl-RS","sr-Latn-RS","sv","sw","ta","te","th","tk","tr","tt","ug","uk","ur","uz-Latn-UZ","vi","zh-Hans","zh-Hant"],o={"ZH-CN":"zh-Hans","ZH-HK":"zh-Hant","ZH-MO":"zh-Hant","ZH-SG":"zh-Hans","ZH-TW":"zh-Hant"};n.validate=function(t){var e=t.toLocaleUpperCase();if(e in o)return o[e];for(var n=0,r=i;n<r.length;n++)if((a=r[n]).toUpperCase()===e)return a;for(var a,s=e.split("-")[0],u=0,l=i;u<l.length;u++)if((a=l[u]).toUpperCase()===s)return a;return"en"}},{}],70:[function(t,e,n){"use strict";n.__esModule=!0;var i,o,r,a,s,u=(l.InApp=((u=function(){}).UI=((o=function(){}).Picker=((i=function(){}).Shown=((r=function(){}).VALUE={name:"InApp_UI_Picker_Shown"},r),i),o.Form=((a=function(){}).Shown=((s=function(){}).VALUE={name:"InApp_UI_Form_Shown"},s),a.Submit=((r=function(){}).VALUE={name:"InApp_UI_Form_Submit"},r),a),o),u),l.Survey=((i=function(){}).UI=((s=function(){}).Prompt=((r=function(){}).Shown=((a=function(){}).VALUE={name:"Survey_UI_Prompt_Shown"},a),r),s.Form=((o=function(){}).Shown=((u=function(){}).VALUE={name:"Survey_UI_Form_Shown"},u),o.Submit=((a=function(){}).VALUE={name:"Survey_UI_Form_Submit"},a),o),s),i.Floodgate=((r=function(){}).TriggerMet=((u=function(){}).VALUE={name:"Survey_Floodgate_TriggerMet"},u),r.UserSelected=((a=function(){}).VALUE={name:"Survey_Floodgate_UserSelected"},a),r.CampaignLoad=((o=function(){}).Failed=((s=function(){}).VALUE={name:"Survey_Floodgate_CampaignLoad_Failed"},s),o),r.FileWrite=((u=function(){}).Failed=((a=function(){}).VALUE={name:"Survey_Floodgate_FileWrite_Failed"},a),u),r.FileRead=((s=function(){}).Failed=((o=function(){}).VALUE={name:"Survey_Floodgate_FileRead_Failed"},o),s),r),i),l.Shared=((a=function(){}).Upload=((u=function(){}).Failed=((o=function(){}).VALUE={name:"Shared_Upload_Failed"},o),u),a.Screenshot=((s=function(){}).Render=((r=function(){}).Failed=((i=function(){}).VALUE={name:"Shared_Screenshot_Render_Failed"},i),r.Success=((o=function(){}).VALUE={name:"Shared_Screenshot_Render_Success"},o),r),s.GetContent=((u=function(){}).Failed=((i=function(){}).DefaultImage=((o=function(){}).Returned=((r=function(){}).VALUE={name:"Shared_Screenshot_GetContent_Failed_DefaultImage_Returned"},r),o),i),u),s),a),l.WebSurfaces=((u=function(){}).Common=((s=function(){}).Error=((a=function(){}).VALUE={name:"WebSurfaces_Common_Error"},a),s.Info=((a=function(){}).VALUE={name:"WebSurfaces_Common_Info"},a),s),u.Messaging=((a=function(){}).Requests=((s=function(){}).VALUE={name:"WebSurfaces_Messaging_Requests"},s),a),u),l);function l(){}n.EventIds=u},{}],71:[function(t,e,n){"use strict";n.__esModule=!0;var i,o,r=t("./../Constants"),a=t("./Telemetry/Contracts"),s=t("./../Utils"),u=t("./Telemetry/TelemetryLoggerFactory"),l=t("../FloodgateCore/FloodgateStorageProvider"),c=t("@ms-ofb/officefloodgatecore/dist/src/Api/IFloodgateStorageProvider");t=t("./Constants");n.EventIds=t.EventIds,n.initialize=function(t,e,n,r,s,l,c,p){i=new d(u.default.create(g.getTenantToken(t),"Office_Feedback",new a.App(e,n),new a.Session(p),new a.Host(s,l,c),new a.Release(r))),o=t},n.getLogger=function(){return i};var d=(p.prototype.logEvent=function(t,e,n){if(!t)throw new Error("eventId must not be null");var i;return s.isNullorUndefined(e)||0===e?(o===r.Environment.Production&&(i="logSeverity must not be null or none",this.isConsoleLogEnabled&&console&&console.log("Floodgate event: ",p.EVENT_NAME,i),this.telemetryLogger.logEvent(p.EVENT_NAME,{ErrorMessage:i})),!1):((n=n||{})[p.EVENT_ID]=t.name,this.isLoggingEnabled(e)&&this.telemetryLogger.logEvent(p.EVENT_NAME,n),this.isConsoleLogEnabled&&console&&console.log("Floodgate event: ",p.EVENT_NAME,e,n),!0)},p.prototype.isLoggingEnabled=function(t){var e;return s.isNullorUndefined(this.logLevel)&&(e=this.getCurrentLogLevel(),this.logLevel=s.isNullorUndefined(e)?2:e),t<=this.logLevel},p.prototype.getCurrentLogLevel=function(){try{var t="undefined"!=typeof URLSearchParams&&new URLSearchParams(window.location.search);if(t&&t.get("obfconsolelog")&&(this.isConsoleLogEnabled=!0),t=t&&t.get("obfloglevel"),!s.isNullorUndefined(t))return this.isConsoleLogEnabled=!0,parseInt(t,10);if(l.default.isStorageAvailable()&&(t=(new l.default).read(c.FileType.LogLevelSettings),!s.isNullorUndefined(t)&&(t=this.parseObject(t),!s.isNullorUndefined(t)&&t.content)))return t.content.consoleLog&&(this.isConsoleLogEnabled=!0),t.content.logLevel}catch(t){return void(this.isConsoleLogEnabled&&console.log("Error while getting the current log level: ",t))}return null},p.prototype.parseObject=function(t){try{return JSON.parse(t)}catch(t){return this.isConsoleLogEnabled&&console.log("Error while parsing the json string for log level: ",t),null}},p.EVENT_NAME="SDK",p.EVENT_ID="EventId",p);function p(t){if(!t)throw new Error("telemetryLogger must not be null");this.telemetryLogger=t}n.Logger=d;var g=(f.getTenantToken=function(t){return t===r.Environment.Production?f.TENANT_TOKEN_PRODUCTION:f.TENANT_TOKEN_PRE_PRODUCTION},f.TENANT_TOKEN_PRODUCTION="d79e824386c4441cb8c1d4ae15690526-bd443309-5494-444a-aba9-0af9eef99f84-7360",f.TENANT_TOKEN_PRE_PRODUCTION="2bf6a2ffddca4a80a892a0b182132961-625cb102-8b0c-480e-af53-92e48695d08d-7736",f);function f(){}},{"../FloodgateCore/FloodgateStorageProvider":61,"./../Constants":57,"./../Utils":107,"./Constants":70,"./Telemetry/Contracts":74,"./Telemetry/TelemetryLoggerFactory":75,"@ms-ofb/officefloodgatecore/dist/src/Api/IFloodgateStorageProvider":8}],72:[function(t,e,n){"use strict";n.__esModule=!0;var i=t("./../../thirdparty/aria-webjs-compact-sdk-1.2.2");n.AWT=function(){return i.AWT}},{"./../../thirdparty/aria-webjs-compact-sdk-1.2.2":112}],73:[function(t,e,n){"use strict";n.__esModule=!0;var i=t("./Aria"),o=t("./Contracts");r.setApp=function(t,e){t["App.Name"]=e.getName(),t["App.Platform"]=e.getPlatform(),t["App.Version"]=e.getVersion()},r.setSession=function(t,e){t["Session.Id"]=e.getId()},r.setHost=function(t,e){e&&(t["Host.Id"]=e.getId(),t["Host.Version"]=e.getVersion())},r.setEvent=function(t,e){t["Event.Name"]=e.getName(),t["Event.Id"]=e.getId(),t["Event.Source"]=e.getSource(),t["Event.SchemaVersion"]=e.getSchemaVersion(),t["Event.Sequence"]=e.getSequence()},r.setRelease=function(t,e){e&&(t["Release.AudienceGroup"]=e.getAudienceGroup())},r.prototype.logEvent=function(t,e){if(!t)throw new Error("eventName must not be null");t=new o.Event(this.namespace+r.EVENT_NAME_DELIMITER+t,this.oesSession.getId(),this.sequence);var n={};if(null!=e)for(var a in e)e.hasOwnProperty(a)&&(n[r.CUSTOM_PROPERTIES_FIELD_PREFIX+a]=e[a]);r.setApp(n,this.oesApp),r.setSession(n,this.oesSession),r.setHost(n,this.oesHost),r.setRelease(n,this.oesRelease),r.setEvent(n,t),i.AWT().logEvent({name:t.getName(),properties:n}),this.sequence++},r.EVENT_NAME_DELIMITER="_",r.CUSTOM_PROPERTIES_FIELD_PREFIX="Data.",t=r;function r(t,e,n,o,r,a){if(!t)throw new Error("tenantToken must not be null");if(!e)throw new Error("namespace must not be null");if(!n)throw new Error("app must not be null");if(!o)throw new Error("session must not be null");i.AWT().initialize(t),this.namespace=e,this.oesApp=n,this.oesSession=o,this.oesHost=r,this.oesRelease=a,this.sequence=1}n.default=t},{"./Aria":72,"./Contracts":74}],74:[function(t,e,n){"use strict";n.__esModule=!0;var i=(o.prototype.getName=function(){return this.name},o.prototype.getPlatform=function(){return o.PLATFORM},o.prototype.getVersion=function(){return this.version},o.PLATFORM="Web",o);function o(t,e){if(!t)throw new Error("name must not be null");if(!e)throw new Error("version must not be null");this.name=t,this.version=e}function r(t){if(!t)throw new Error("id must not be null");this.id=t}function a(t,e,n){this.id=t,this.sessionId=e,this.version=n}function s(t,e,n){if(!t)throw new Error("name must not be null");if(!e)throw new Error("sessionId must not be null");if(!n&&0!==n||n<0)throw new Error("sequence must not be negative");this.name=t,this.id=e+s.ID_DELIMITER+n,this.sequence=n}function u(t){this.audienceGroup=t}n.App=i,r.prototype.getId=function(){return this.id},i=r,n.Session=i,a.prototype.getId=function(){return this.id},a.prototype.getSessionId=function(){return this.sessionId},a.prototype.getVersion=function(){return this.version},i=a,n.Host=i,s.prototype.getName=function(){return this.name},s.prototype.getId=function(){return this.id},s.prototype.getSource=function(){return s.SOURCE},s.prototype.getSchemaVersion=function(){return s.SCHEMA_VERSION},s.prototype.getSequence=function(){return this.sequence},s.ID_DELIMITER=".",s.SOURCE="MsoThin",s.SCHEMA_VERSION=1,i=s,n.Event=i,u.prototype.getAudienceGroup=function(){return this.audienceGroup},i=u,n.Release=i},{}],75:[function(t,e,n){"use strict";n.__esModule=!0;var i=t("./AriaTelemetryLogger");o.create=function(t,e,n,o,r,a){return new i.default(t,e,n,o,r,a)},t=o;function o(){}n.default=t},{"./AriaTelemetryLogger":73}],76:[function(t,e,n){"use strict";n.__esModule=!0;var i=t("./Window/Window");n.createScreenShot=function(){return i.get().OfficeBrowserFeedback.html2canvas()(document.body,{background:"#ffffff"})}},{"./Window/Window":111}],77:[function(t,e,n){"use strict";n.__esModule=!0;var i,o=t("es6-promise"),r=t("../Configuration/Configuration"),a=t("./TargetedMessagingClient"),s=t("../Utils"),u=(l.prototype.getCampaignDefinitions=function(){if(!this.tmsgClient)return o.Promise.resolve(null);var t=this.configuration.getCommonInitOptions(),e=this.configuration.getFloodgateInitOptions();return o.Promise.resolve(this.tmsgClient.getContent("CampaignContent",t.appId.toString(),"Web",t.build,t.originalLocale,this.extractCountryFromLocale(t.originalLocale),this.configuration.getSdkSessionId(),e.authTokenCallback,e.campaignFlights,e.campaignQueryParameters).then((function(t){return t.content})))},l.prototype.getUserGovernanceRules=function(){if(!this.tmsgClient)return o.Promise.resolve(null);var t=this.configuration.getCommonInitOptions(),e=this.configuration.getFloodgateInitOptions();return o.Promise.resolve(this.tmsgClient.getContent("UserGovernance",t.appId.toString(),"Web",t.build,t.originalLocale,this.extractCountryFromLocale(t.originalLocale),this.configuration.getSdkSessionId(),e.authTokenCallback,e.campaignFlights,e.campaignQueryParameters).then((function(t){return t.content})))},l.prototype.getMessageMetadata=function(){if(!this.tmsgClient)return o.Promise.resolve(null);var t=this.configuration.getCommonInitOptions(),e=this.configuration.getFloodgateInitOptions();return o.Promise.resolve(this.tmsgClient.getContent("MessageMetadata",t.appId.toString(),"Web",t.build,t.originalLocale,this.extractCountryFromLocale(t.originalLocale),this.configuration.getSdkSessionId(),e.authTokenCallback,e.campaignFlights,e.campaignQueryParameters).then((function(t){return t.content})))},l.prototype.setCampaignAction=function(t){var e,n;this.tmsgClient&&(e=this.configuration.getCommonInitOptions(),n=this.configuration.getFloodgateInitOptions(),this.tmsgClient.sendBeaconRequestToService(e.appId.toString(),t,"Web",e.build,e.originalLocale,this.extractCountryFromLocale(e.originalLocale),this.configuration.getSdkSessionId(),n.authTokenCallback))},l.prototype.extractCountryFromLocale=function(t){if(!s.isNullorUndefined(t))return 2===(t=t.split("-")).length?t[1]:void 0},l);function l(){var t;this.configuration=r.get(),(t=(t=this.configuration&&this.configuration.getFloodgateInitOptions())&&t.authTokenCallback)&&(t.getAuthToken||t.getUserPuid)&&(this.tmsgClient=new a.TargetedMessagingClient)}n.AssetsProvider=u,n.get=function(){return i=i||new u}},{"../Configuration/Configuration":55,"../Utils":107,"./TargetedMessagingClient":80,"es6-promise":45}],78:[function(t,e,n){"use strict";n.__esModule=!0;var i=t("../FloodgateCore/FloodgateStorageProvider"),o=t("../Utils"),r=t("@ms-ofb/officefloodgatecore/dist/src/Api/IFloodgateStorageProvider");t=function(t){this.contentType=t};function a(t){this.useLocalStorage=!1,this.initialize(t)}n.CacheItem=t,a.prototype.setItem=function(t){this.cachedItems[t.contentType]=t,this.updateItemInLocalStorage(t)},a.prototype.has=function(t){return t in this.cachedItems},a.prototype.getItem=function(t){return this.cachedItems[t]},a.prototype.initialize=function(t){this.cachedItems={},i.default.isStorageAvailable()&&(this.floodgateStorage=new i.default,this.useLocalStorage=!0,this.initCachedItemsFromLocalStorage(t))},a.prototype.initCachedItemsFromLocalStorage=function(t){if(this.useLocalStorage&&!o.isNullorUndefined(t))for(var e=0,n=t;e<n.length;e++){var i=n[e];i=this.floodgateStorage.read(this.mapContentTypeToFloodgateProviderKey(i));o.isNullorUndefined(i)||(i=this.parseObjectFromCache(i),o.isNullorUndefined(i)||(i.expiryDate="string"==typeof i.expiryDate?new Date(i.expiryDate):i.expiryDate,this.cachedItems[i.contentType]=i))}},a.prototype.updateItemInLocalStorage=function(t){this.useLocalStorage&&this.floodgateStorage.write(this.mapContentTypeToFloodgateProviderKey(t.contentType),JSON.stringify(t))},a.prototype.parseObjectFromCache=function(t){try{return JSON.parse(t)}catch(t){return null}},a.prototype.mapContentTypeToFloodgateProviderKey=function(t){switch(t){case"CampaignContent":return r.FileType.TmsCache_CampaignContent;case"MessageMetadata":return r.FileType.TmsCache_MessageMetadata;case"UserGovernance":return r.FileType.TmsCache_UserGovernance;case"DynamicSettings":return r.FileType.Tms_DynamicSettings;case"LogLevelSettings":return r.FileType.LogLevelSettings;default:throw new Error("Unmapped ContentType in TmsCache")}},t=a,n.TargetedMessagingCache=t},{"../FloodgateCore/FloodgateStorageProvider":61,"../Utils":107,"@ms-ofb/officefloodgatecore/dist/src/Api/IFloodgateStorageProvider":8}],79:[function(t,e,n){"use strict";n.__esModule=!0;var i=t("es6-promise"),o=t("@ms-ofb/officefloodgatecore/dist/src/Campaign/CampaignDefinitionProvider"),r=t("../Configuration/DynamicConfiguration"),a=t("./TargetedMessagingConstants"),s=t("./AssetsProvider");u.prototype.load=function(){return this.loadAsyncTriggered||(this.loadAsync(),this.loadAsyncTriggered=!0),this.campaignDefinitions||[]},u.prototype.loadAsync=function(){var t=this,e=s.get().getCampaignDefinitions();e.then((function(e){t.loadCampaignDefinitions(e),t.loadAsyncTriggered=!0}));var n=r.getDynamicSetting("TmsLoadTimeout",a.TMS_CAMPAIGN_LOAD_TIMEOUT),o=this.getTimeOutPromise(n,e);return new i.Promise((function(e,n){o.then((function(n){t.loadCampaignDefinitions(n),t.loadAsyncTriggered=!0,e(t.campaignDefinitions)})).catch((function(){e(t.campaignDefinitions)}))}))},u.prototype.loadCampaignDefinitions=function(t){(t=t&&t.campaigns)&&(this.campaignDefinitions=o.FilterValidCampaignDefinitions(t).result)},u.prototype.getTimeOutPromise=function(t,e){var n=new i.Promise((function(e,n){var i=setTimeout((function(){clearTimeout(i),n("Timed out in "+t+"ms.")}),t)}));return i.Promise.race([e,n])},t=u;function u(){this.loadAsyncTriggered=!1,this.campaignDefinitions=[]}n.TargetedMessagingCampaignDefinitionProvider=t},{"../Configuration/DynamicConfiguration":56,"./AssetsProvider":77,"./TargetedMessagingConstants":81,"@ms-ofb/officefloodgatecore/dist/src/Campaign/CampaignDefinitionProvider":13,"es6-promise":45}],80:[function(t,e,n){"use strict";var i=this&&this.__assign||Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},o=this&&this.__awaiter||function(t,e,n,i){return new(n=n||Promise)((function(o,r){function a(t){try{u(i.next(t))}catch(t){r(t)}}function s(t){try{u(i.throw(t))}catch(t){r(t)}}function u(t){t.done?o(t.value):new n((function(e){e(t.value)})).then(a,s)}u((i=i.apply(t,e||[])).next())}))},r=this&&this.__generator||function(t,e){var n,i,o,r={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a={next:s(0),throw:s(1),return:s(2)};return"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(o=2&a[0]?i.return:a[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,a[1])).done)return o;switch(i=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,i=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(!(o=0<(o=r.trys).length&&o[o.length-1])&&(6===a[0]||2===a[0])){r=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){r.label=a[1];break}if(6===a[0]&&r.label<o[1]){r.label=o[1],o=a;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(a);break}o[2]&&r.ops.pop(),r.trys.pop();continue}a=e.call(t,r)}catch(t){a=[6,t],i=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}};n.__esModule=!0;var a=t("es6-promise"),s=t("./TargetedMessagingTransport"),u=t("../Common/UrlUtils"),l=t("./TargetedMessagingCache"),c=t("../Constants"),d=t("../Logging/Logging"),p=t("./TargetedMessagingConstants"),g=t("../Utils"),f=t("../Configuration/DynamicConfiguration"),h=t("../FloodgateCore/FloodgateStorageProvider"),m=t("./TargetedMessagingConstants"),v=function(){};function y(){this.locale="en-us",this.country="US",this.isInit=!1}n.ContentResponse=v,y.prototype.initialize=function(t,e,n,i,s,u,c,d,p,g){return o(this,void 0,a.Promise,(function(){return r(this,(function(o){switch(o.label){case 0:return this.isInit?[2,this.isInit]:(this.locale=i,this.country=s,this.authTokenCallback=c,this.app=t,this.platform=e,this.version=n,this.sessionId=u,this.campaignFlights=d,this.campaignParameters=p,this.tmsgCache=this.tmsgCache||g||new l.TargetedMessagingCache(["MessageMetadata","UserGovernance","CampaignContent","DynamicSettings","LogLevelSettings"]),[4,this.refreshItemsInCacheFromTmsService(["MessageMetadata","UserGovernance","CampaignContent","DynamicSettings","LogLevelSettings"])]);case 1:return o.sent(),this.isInit=!0,[2,this.isInit]}}))}))},y.prototype.getContent=function(t,e,n,i,s,u,l,c,d,p){return o(this,void 0,a.Promise,(function(){return r(this,(function(o){switch(o.label){case 0:return this.isInit?[3,2]:[4,this.initialize(e,n,i,s,u,l,c,d,p)];case 1:o.sent(),o.label=2;case 2:return[2,this.retrieveCacheItemAndCreateContentResponse(t)]}}))}))},y.prototype.getMultipleContents=function(t,e,n,i,s,u,l,c,d,p){return o(this,void 0,a.Promise,(function(){var o,a,g,f,h,m;return r(this,(function(r){switch(r.label){case 0:return this.isInit?[3,2]:[4,this.initialize(e,n,i,s,u,l,c,d,p)];case 1:r.sent(),r.label=2;case 2:for(o=new Array,a=new Array,g=0,f=t;g<f.length;g++)h=f[g],m=this.tmsgCache.getItem(h),m=this.createContentResponse(h,m),o.push(m);return this.refreshItemsInCacheFromTmsService(a),[2,o]}}))}))},y.prototype.sendBeaconRequestToService=function(t,e,n,s,u,l,p,g){return o(this,void 0,a.Promise,(function(){var o,a,f,h;return r(this,(function(r){switch(r.label){case 0:return this.sessionId=p,this.authTokenCallback=g,[4,this.getAuthToken(c.GUIDs.TMSAppID)];case 1:return o=r.sent(),f=void 0,o?[3,4]:(a=this.authTokenCallback.getUserPuid)?[4,this.authTokenCallback.getUserPuid()]:[3,3];case 2:a=r.sent(),r.label=3;case 3:f=a,r.label=4;case 4:return r.trys.push([4,6,,7]),f=i({app:t},e,{country:l,locale:u,platform:n,puid:f,version:s}),[4,this.sendRequest(f,o,"TmsActionUrl",m.TMS_SERVICE_ACTION_URL)];case 5:return(h=r.sent())&&200===h.status||d.getLogger().logEvent(d.EventIds.WebSurfaces.Common.Error.VALUE,2,this.createTelemetryData(h,"Beacon")),[3,7];case 6:return h=r.sent(),d.getLogger().logEvent(d.EventIds.WebSurfaces.Common.Error.VALUE,2,i({ErrorMessage:"Error fetching from TMS SetCampaignAction endpoint"+(h&&h.message?": "+h.message:"")},this.createTelemetryData(null,"Beacon"))),[3,7];case 7:return[2]}}))}))},y.prototype.createTelemetryData=function(t,e){var n=+new Date,i=(r=t||{}).headers,o=r.status,r=(t=r.statusText,i&&i.get("X-UserSessionId"));i=i&&i.get("X-CorrelationId");return{Type:e,TimeMilliseconds:+new Date-n,SessionId:r||this.sessionId,CorrelationId:i||void 0,HttpStatusCode:o||void 0,HttpStatusText:t||void 0}},y.prototype.sendRequest=function(t,e,n,i){return o(this,void 0,void 0,(function(){var o,a;return r(this,(function(r){switch(r.label){case 0:return this.tmsgTransport=this.tmsgTransport||new s.TargetedMessagingTransport(this.sessionId),o=u.buildQueryParameters(t),a=f.getDynamicSetting(n,i),[4,this.tmsgTransport.sendGetRequest(a+o,e)];case 1:return[2,r.sent()]}}))}))},y.prototype.retrieveCacheItemAndCreateContentResponse=function(t){var e=this.tmsgCache.getItem(t),n=this.createContentResponse(t,e);return(g.isNullorUndefined(e)||e.expiryDate.getMilliseconds()>Date.now())&&this.refreshItemsInCacheFromTmsService([t]),n},y.prototype.createContentResponse=function(t,e){var n=new v;return n.content=void 0!==e?e.content:null,n.contentType=t,n},y.prototype.createCacheItem=function(t,e,n){return(e=new l.CacheItem(e)).content=t,e.lastRetrievedDate=new Date,e.expiryDate=new Date(Date.now()+n),e},y.prototype.getAuthToken=function(t){return o(this,void 0,a.Promise,(function(){var e,n,i,o,a=this;return r(this,(function(r){switch(r.label){case 0:if(!this.authTokenCallback||!this.authTokenCallback.getAuthToken)return[2,null];e=+new Date,n=function(){return+new Date-e},i=function(e){return void 0===e&&(e=void 0),{ErrorMessage:e,SessionId:a.sessionId,TimeMilliseconds:n(),Type:t}},r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.authTokenCallback.getAuthToken(t)];case 2:return o=r.sent(),d.getLogger().logEvent(d.EventIds.WebSurfaces.Common.Info.VALUE,3,i()),[2,o];case 3:return o=r.sent(),d.getLogger().logEvent(d.EventIds.WebSurfaces.Common.Error.VALUE,2,i("Error getting token "+(o&&o.message?": "+o.message:""))),[3,4];case 4:return[2,null]}}))}))},y.prototype.refreshItemsInCacheFromTmsService=function(t){return o(this,void 0,a.Promise,(function(){var e,n,o,a,s,l,f,m,v;return r(this,(function(r){switch(r.label){case 0:if(0===t.length)return[2];for(e=new Array,n=0,o=t;n<o.length;n++)a=o[n],s=this.tmsgCache.getItem(a),(g.isNullorUndefined(s)||!s.expiryDate||s.expiryDate.getMilliseconds()>Date.now())&&e.push(a);return 0===e.length?[2]:[4,this.getAuthToken(c.GUIDs.TMSAppID)];case 1:return m=r.sent(),f=void 0,m?[3,4]:(l=this.authTokenCallback.getUserPuid)?[4,this.authTokenCallback.getUserPuid()]:[3,3];case 2:l=r.sent(),r.label=3;case 3:f=l,r.label=4;case 4:return r.trys.push([4,9,,10]),l=document&&(document.documentElement||document.getElementsByTagName("body")[0]),l={hasStorage:h.default.isStorageAvailable(),pageWidth:window.innerWidth||l.clientWidth,pageHeight:window.innerHeight||l.clientHeight,screenWidth:screen?screen.width:void 0,screenHeight:screen?screen.height:void 0,colorDepth:screen?screen.colorDepth:void 0},f={country:this.country,locale:this.locale,app:this.app,platform:this.platform,version:this.version,campaignParams:u.buildQueryParameters(l)+"&more=true&"+(this.campaignParameters||""),contentType:t.join(";"),puid:f,OFC_FLIGHTS:this.campaignFlights},[4,this.sendRequest(f,m,"TmsServiceUrl",p.TMS_SERVICEURL)];case 5:return 200!==(v=r.sent()).status?[3,7]:[4,v.json()];case 6:return m=r.sent(),-1!==t.indexOf("MessageMetadata")&&void 0!==m.MessageMetadata&&this.tmsgCache.setItem(this.createCacheItem(m.MessageMetadata,"MessageMetadata",p.CACHE_EXPIRY_MESSAGEMETADATA)),-1!==t.indexOf("UserGovernance")&&void 0!==m.UserGovernanceRules&&this.tmsgCache.setItem(this.createCacheItem(m.UserGovernanceRules,"UserGovernance",p.CACHE_EXPIRY_USERGOVERNANCERULES)),-1!==t.indexOf("CampaignContent")&&void 0!==m.CampaignContent&&this.tmsgCache.setItem(this.createCacheItem(m.CampaignContent,"CampaignContent",p.CACHE_EXPIRY_CAMPAIGNCONTENT)),-1!==t.indexOf("DynamicSettings")&&void 0!==m.DynamicSettings&&this.tmsgCache.setItem(this.createCacheItem(m.DynamicSettings,"DynamicSettings",p.CACHE_EXPIRY_DYNAMICSETTINGS)),-1!==t.indexOf("LogLevelSettings")&&void 0!==m.LogLevelSettings&&this.tmsgCache.setItem(this.createCacheItem(m.LogLevelSettings,"LogLevelSettings",p.CACHE_EXPIRY_LOGLEVELSETTINGS)),d.getLogger().logEvent(d.EventIds.WebSurfaces.Messaging.Requests.VALUE,3,this.createTelemetryData(v,t.join(";"))),[3,8];case 7:d.getLogger().logEvent(d.EventIds.WebSurfaces.Common.Error.VALUE,2,this.createTelemetryData(v,t.join(";"))),r.label=8;case 8:return[3,10];case 9:return v=r.sent(),d.getLogger().logEvent(d.EventIds.WebSurfaces.Common.Error.VALUE,2,i({ErrorMessage:"Error fetching from TMS"+(v&&v.message?": "+v.message:"")},this.createTelemetryData(null,t.join(";")))),[3,10];case 10:return[2]}}))}))},t=y,n.TargetedMessagingClient=t},{"../Common/UrlUtils":54,"../Configuration/DynamicConfiguration":56,"../Constants":57,"../FloodgateCore/FloodgateStorageProvider":61,"../Logging/Logging":71,"../Utils":107,"./TargetedMessagingCache":78,"./TargetedMessagingConstants":81,"./TargetedMessagingTransport":82,"es6-promise":45}],81:[function(t,e,n){"use strict";n.__esModule=!0,n.CACHE_EXPIRY_MESSAGEMETADATA=144e5,n.CACHE_EXPIRY_USERGOVERNANCERULES=144e5,n.CACHE_EXPIRY_CAMPAIGNCONTENT=144e5,n.CACHE_EXPIRY_DYNAMICSETTINGS=144e5,n.CACHE_EXPIRY_LOGLEVELSETTINGS=144e5,n.TMS_SERVICEURL="https://messaging.office.com/lifecycle/CampaignMetadataAggregator?",n.TMS_SERVICE_ACTION_URL="https://messaging.office.com/lifecycle/SetCampaignAction?",n.TMS_CAMPAIGN_LOAD_TIMEOUT=1e3,n.TMS_FETCH_TIMEOUT=5e3},{}],82:[function(t,e,n){"use strict";var i=this&&this.__awaiter||function(t,e,n,i){return new(n=n||Promise)((function(o,r){function a(t){try{u(i.next(t))}catch(t){r(t)}}function s(t){try{u(i.throw(t))}catch(t){r(t)}}function u(t){t.done?o(t.value):new n((function(e){e(t.value)})).then(a,s)}u((i=i.apply(t,e||[])).next())}))},o=this&&this.__generator||function(t,e){var n,i,o,r={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a={next:s(0),throw:s(1),return:s(2)};return"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(o=2&a[0]?i.return:a[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,a[1])).done)return o;switch(i=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,i=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(!(o=0<(o=r.trys).length&&o[o.length-1])&&(6===a[0]||2===a[0])){r=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){r.label=a[1];break}if(6===a[0]&&r.label<o[1]){r.label=o[1],o=a;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(a);break}o[2]&&r.ops.pop(),r.trys.pop();continue}a=e.call(t,r)}catch(t){a=[6,t],i=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}};n.__esModule=!0,t("whatwg-fetch");var r=t("es6-promise"),a=t("./TargetedMessagingConstants"),s=t("../Utils");u.prototype.sendGetRequest=function(t,e){return i(this,void 0,r.Promise,(function(){return o(this,(function(n){return[2,this.timeoutFetch(t,{method:"GET",headers:this.createHeaders(e)})]}))}))},u.prototype.sendPostRequest=function(t,e,n){return i(this,void 0,r.Promise,(function(){return o(this,(function(i){return[2,fetch(t,{method:"POST",headers:this.createHeaders(n),body:e})]}))}))},u.prototype.timeoutFetch=function(t,e){return void 0===e&&(e={}),new r.Promise((function(n,i){fetch(t,e).then(n,i),setTimeout((function(){return r.Promise.reject(new Error("Service request timed out"))}),a.TMS_FETCH_TIMEOUT)}))},u.prototype.createHeaders=function(t){var e="undefined"!=typeof Headers&&new Headers;return e&&(s.isNullorUndefined(t)||e.append("Authorization","Bearer "+t),e.append("X-CorrelationId",s.guid()),this.sessionId&&e.append("X-UserSessionId",this.sessionId)),e},t=u;function u(t){this.sessionId=t}n.TargetedMessagingTransport=t},{"../Utils":107,"./TargetedMessagingConstants":81,"es6-promise":45,"whatwg-fetch":50}],83:[function(t,e,n){"use strict";n.__esModule=!0;var i=t("./Constants");n.initialize=function(t,e){void 0===t&&(t=void 0),void 0===e&&(e=void 0),t=t||"#0167B0",e=e||"#194789";var n=document.createElement("style");n.textContent="."+i.Classes.OverallAnchor+":focus { background-color: "+t+" } ."+i.Classes.OverallAnchor+":hover { background-color: "+e+" } ."+i.Classes.OverallAnchorActive+" { background-color: "+t+" } ."+i.Classes.SpinnerCircle+" { background-color: "+t+" } ."+i.Classes.ChoiceGroup+" input[type=radio]:checked+label>."+i.Classes.ChoiceGroupIcon+" { border-color: "+t+" } ."+i.Classes.ChoiceGroup+" input[type=radio]:hover+label>."+i.Classes.ChoiceGroupIcon+" { border-color: "+e+" } ."+i.Classes.ChoiceGroup+" input[type=radio]:checked+label>."+i.Classes.ChoiceGroupIcon+">span { background-color: "+t+" } ."+i.Classes.SubmitButton+" { background-color: "+t+" } ."+i.Classes.SubmitButton+":hover { background-color: "+e+" } ."+i.Classes.Link+" { color: "+t+" } ."+i.Classes.Link+":hover { color: "+e+" } #"+i.IDs.TPromptTitle+" { color: "+t+" } #"+i.IDs.TFormTitle+" { color: "+t+" } ",document.body.appendChild(n)}},{"./Constants":57}],84:[function(t,e,n){"use strict";n.__esModule=!0;var i=t("./../../Constants"),o=t("./../../Utils");r.prototype.setComment=function(t){this.manifestData.comment=t},r.prototype.setEmail=function(t){this.manifestData.email=t},r.prototype.setCategory=function(t){this.manifestData.telemetry=this.manifestData.telemetry||{},this.manifestData.telemetry.featureArea=t},r.prototype.setValues=function(t){if(t)for(var e in t)t.hasOwnProperty(e)&&(this.manifestData.hasOwnProperty(e)?this.manifestData[e]=o.overrideValues(t[e],this.manifestData[e]):this.manifestData[e]=t[e])},r.prototype.getContent=function(){return new Blob([JSON.stringify(this.manifestData)],{type:"application/json"})},t=r;function r(t,e,n,o,r,a,s,u){this.manifestData={appId:e,application:a,clientFeedbackId:r,manifestType:t,source:"Client",submitTime:n,telemetry:s,type:"Survey"===(o=o)?o:i.FeedbackType[o],web:u}}n.Manifest=t},{"./../../Constants":57,"./../../Utils":107}],85:[function(t,e,n){"use strict";n.__esModule=!0;var i=t("./../../Logging/Logging");o.prototype.getContent=function(){var t;try{t=this.screenshot.toDataURL("image/jpeg").split(",")[1]}catch(e){i.getLogger().logEvent(i.EventIds.Shared.Screenshot.GetContent.Failed.DefaultImage.Returned.VALUE,2,{ErrorMessage:e.toString()}),t="iVBORw0KGgoAAAANSUhEUgAAAN0AAAA+AQMAAACV2ox1AAAABGdBTUEAALGPC/xhBQAAAAZQTFRFAAAA////pdmf3QAAAAlwSFlzAAAOwgAADsIBFShKgAAAAjtJREFUSMfV1M1rE0EUAHDBa5r8A9vkL6giFiI0JH+Ih9KLx8TaukkJugShHgrJzYvkVPQkUqgwSePLEELaU+zBg8JKVvSQQNydlsadwCQzziRZ82ETxYMfc3gD8+MxjzcfV8T80f0vkQ8i68tAPSMSQ0PkI6QDpEPkZBHy1Wp1/zjni2lrZq2T2uikDG17A54Hr0vsvwXIl3WXt02zeIHQBSq3DxHk7VO55zIFgLLrcmaaQBGiqCwQArBVQTbNZODNBB5Ee2EEr5eGiDG4k5mcqcy+Ksh+N8K2+bRI1Z68fRMVoV+XmcFwpQJZGohpkds1WtjppGLaq51a2b8yp310UW9/H8VfRj68CIKRsWCFPCCEM419S4bSAOmPmdb3TBrQ4lmnt9n4/Hiv5fTunsOzXbJfLR2rU3Fd5ugOe9mw0lvNOCNxyDdIHkpHCv0S3a+MS0yT+4wkAKx1gBJeVxeMRhSeNZpXJfY+zqAVl+g0mCFRJMgs6oy9+MCMrWZaJJwiWFjuWcIShf+Wk2W9e59OHu21WPdsswZNLKs9wV77mJiaMVbBQ+/1jGZDofFLuOBU/jzG6OQKnkLOZ5EvwolMX2Q19TAX9MWyy/aNarewfZptechdLn8B3TatB/YXB2j4MKw3jTHKX4AO0CbqaSddMokHUbr0PpSXmFG4O4WIu86asCVihfoM6nUmse5gGkbJOyThVesX4UI0d00LBYMr55VuIZl8MkY1uOiTy9v3c+ShuXj5+NdQdL8B+5gmw8WZuREAAAAASUVORK5CYII="}for(var e=atob(t),n=[],o=0;o<e.length;o++)n.push(e.charCodeAt(o));return new Blob([new Uint8Array(n)],{type:"image/jpeg"})},t=o;function o(t){this.screenshot=t}n.Screenshot=t},{"./../../Logging/Logging":71}],86:[function(t,e,n){"use strict";n.__esModule=!0;var i=t("es6-promise");n.send=function(t,e,n,o){if(void 0===e)return i.Promise.reject(new Error("Manifest cannot be undefined"));var r,a,s,u=new FormData;return u.append("Manifest",e),n&&u.append("Screenshot",n),o&&u.append("Diagnostics",o),"POST",r=t?"https://petrol.office.microsoft.com/v1/feedback":"https://petrol-int.office.microsoft.com/v1/feedback",a=u,s=function(t,e,n){200!==t.status&&n(new Error("Non-200 response with status code: "+t.status+", response: "+t.responseText)),e()},function t(e){return new i.Promise((function(n,i){var o=new XMLHttpRequest;o.open("POST",r,!0),o.timeout=4e3,o.onload=function(){s(o,n,i)},o.ontimeout=function(){0<e?t(e-1).then(n,i):i(new Error("Request to '"+r+"' timed out. timeout: 4000"))},o.onerror=function(){0<e?t(e-1).then(n,i):i(new Error("Request to '"+r+"' errored. "+o.status+": "+o.responseText))},o.send(a)}))}(2)}},{"es6-promise":45}],87:[function(t,e,n){"use strict";n.__esModule=!0;var i=t("./../Constants"),o=t("./../Utils"),r=t("./../Logging/Logging"),a=t("./Petrol"),s=t("./Files/Screenshot"),u=t("../Configuration/Configuration"),l=t("./Files/Manifest");c.prototype.setComment=function(t){this.manifest.setComment(t)},c.prototype.setEmail=function(t){this.manifest.setEmail(t)},c.prototype.setCategory=function(t){this.manifest.setCategory(t)},c.prototype.setScreenshot=function(t){this.screenshot=new s.Screenshot(t)},c.prototype.setManifestValues=function(t){this.manifest.setValues(t)},c.prototype.submit=function(){var t=this.manifest.getContent(),e=void 0;return this.screenshot&&(e=this.screenshot.getContent()),a.send(this.environment===i.Environment.Production,t,e).catch((function(t){u.get().getCommonInitOptions().onError("Payload submission failed: "+t.message),r.getLogger().logEvent(r.EventIds.Shared.Upload.Failed.VALUE,2,{ErrorMessage:t.message})}))},t=c;function c(t,e,n,i,r,a,s){this.manifest=new l.Manifest(e,n,(new Date).toISOString(),i,o.guid(),r,a,s),this.environment=t}n.Transporter=t},{"../Configuration/Configuration":55,"./../Constants":57,"./../Logging/Logging":71,"./../Utils":107,"./Files/Manifest":84,"./Files/Screenshot":85,"./Petrol":86}],88:[function(t,e,n){"use strict";var i;n.__esModule=!0,n.setUIStrings=function(t){i=t},n.getUIStrings=function(){return i}},{}],89:[function(t,e,n){"use strict";n.__esModule=!0;var i=t("./../../Constants"),o=t("./Events"),r=t("./Layout"),a=t("./../Renderer"),s=t("./../Utils"),u=t("./../../WindowProperties"),l=t("./FormTemplates/BasicFormTemplate"),c=t("./FormTemplates/UserVoiceFormTemplate"),d=t("./../../Configuration/Configuration");function p(t){document.body.insertBefore(t,document.body.firstChild),s.setElementVisibility(i.IDs.OverlayBackground,!0),9<s.getInternetExplorerVersion()||-1===s.getInternetExplorerVersion()?setTimeout(g,900):g()}function g(){s.setElementVisibility(i.IDs.MainContentHolder,!0),document.getElementById(i.IDs.OverallSmileAnchor)?document.getElementById(i.IDs.OverallSmileAnchor).focus():document.getElementById(i.IDs.SingleFormComment)&&document.getElementById(i.IDs.SingleFormComment).focus()}n.createMulti=function(t){var e={};e[i.FeedbackType.Smile]=l,e[i.FeedbackType.Frown]=l,d.get().getInAppFeedbackInitOptions().userVoice&&"en"===d.get().getCommonInitOptions().locale?e[i.FeedbackType.Idea]=c:e[i.FeedbackType.Idea]=l,d.get().getInAppFeedbackInitOptions().bugForm&&(e[i.FeedbackType.Bug]=l),p(a.elementFromJson(r.generateMulti(e)));var n=u.isNarrow();o.registerMulti(e,n,(function(e){s.setElementVisibility(i.IDs.OverlayBackground,!1),s.deleteElementById(i.IDs.OverlayBackground),d.get().getInAppFeedbackInitOptions().onDismiss(e),t()})),n&&s.addClassById(i.IDs.OverlayBackground,i.Classes.NarrowLayout)},n.createSingle=function(t,e){p(a.elementFromJson(r.generateSingle())),o.registerSingle(e,(function(e){s.setElementVisibility(i.IDs.OverlayBackground,!1),s.deleteElementById(i.IDs.OverlayBackground),d.get().getInAppFeedbackInitOptions().onDismiss(e),t()})),s.addClassById(i.IDs.OverlayBackground,i.Classes.SingleLayout)},n.dismiss=function(){}},{"./../../Configuration/Configuration":55,"./../../Constants":57,"./../../WindowProperties":109,"./../Renderer":100,"./../Utils":106,"./Events":90,"./FormTemplates/BasicFormTemplate":91,"./FormTemplates/UserVoiceFormTemplate":94,"./Layout":95}],90:[function(t,e,n){"use strict";n.__esModule=!0;var i,o,r=t("./../../Transport/Transport"),a=t("./../../Configuration/Configuration"),s=t("./../../Constants"),u=t("./../../Logging/Logging"),l=t("./../../Screenshot"),c=t("./../SpinnerControl"),d=t("./../Utils"),p=t("./TabFocus"),g=!1,f=void 0,h=[s.IDs.OverallSmileAnchor,s.IDs.OverallFrownAnchor,s.IDs.OverallIdeaAnchor,s.IDs.OverallBugAnchor];function m(t){for(var e=0;e<h.length;e++)h[e]===t?d.setAttributeOnHtmlElement(h[e],s.AttributeName.AriaSelected,s.AttributeValue.True):d.setAttributeOnHtmlElement(h[e],s.AttributeName.AriaSelected,s.AttributeValue.False)}function v(t){d.removeEventListenerHelper(window,"keyup",T),function(){for(var t=0,e=y;t<e.length;t++){var n=e[t];d.unregisterListener(n.id,n.event,n.listener)}y=[]}(),i(t)}var y=[];function S(t,e,n){d.registerListener(t,e,n),y.push({event:e,id:t,listener:n})}function b(t){i=t,d.addEventListenerHelper(window,"keyup",T),S(s.IDs.OverlayBackground,"click",w),S(s.IDs.MainContainer,"click",I),S(s.IDs.MainContainer,"keyup",C),S(s.IDs.PrivacyStatementLink,"click",A)}function C(t){(t.keyCode||t.which)===s.Keys.Tab&&(document.activeElement.id===s.IDs.FirstTabbable&&t.shiftKey||document.activeElement.id===s.IDs.LastTabbable&&!t.shiftKey)&&(t.stopPropagation(),p.cycleTabFocus(document.activeElement))}function T(t){t.keyCode===s.Keys.Esc&&(t.preventDefault(),t.stopPropagation(),v(!1))}function w(t){t.preventDefault(),t.stopPropagation(),v(!1)}function I(t){t.stopPropagation()}function A(t){t.stopPropagation()}function E(t,e){t.preventDefault(),t.stopPropagation(),d.replaceClassesById(s.IDs.OverallSmileAnchor,s.Classes.OverallAnchorActive),d.replaceClassesById(s.IDs.OverallFrownAnchor,s.Classes.OverallAnchorActive),d.replaceClassesById(s.IDs.OverallIdeaAnchor,s.Classes.OverallAnchorActive),d.replaceClassesById(s.IDs.OverallBugAnchor,s.Classes.OverallAnchorActive),d.addClassById(e,s.Classes.OverallAnchorActive),u.getLogger().logEvent(u.EventIds.InApp.UI.Form.Shown.VALUE,1,{FeedbackType:f}),function(t){for(var e in o)o.hasOwnProperty(e)&&d.setElementVisibility(o[e].containerId,!1);g?(d.setElementVisibility(s.IDs.LeftFormContainer,!1),d.setElementVisibility(s.IDs.MiddleFormContainer,!0),d.setElementVisibility(t,!0)):(d.addClassById(s.IDs.ColumnSeparatorDiv,s.Classes.ShowRightBorder),d.setElementVisibility(s.IDs.MiddleFormContainer,!0),d.setElementVisibility(t,!0),d.addClassById(s.IDs.LeftFormContainer,s.Classes.SlideLeft),d.addClassById(s.IDs.MiddleFormContainer,s.Classes.SlideLeft))}((e=o[f]).containerId),e.onSelect(f)}function F(t){f=s.FeedbackType.Smile,m(s.IDs.OverallSmileAnchor),d.setAttributeOnHtmlElement(s.IDs.MiddleFormContainer,s.AttributeName.AriaExpanded,s.AttributeValue.True),d.setAttributeOnHtmlElement(s.IDs.MiddleFormContainer,s.AttributeName.AriaLabelledBy,s.IDs.OverallSmileAnchor),E(t,s.IDs.OverallSmileAnchor)}function _(t){f=s.FeedbackType.Frown,m(s.IDs.OverallFrownAnchor),d.setAttributeOnHtmlElement(s.IDs.MiddleFormContainer,s.AttributeName.AriaExpanded,s.AttributeValue.True),d.setAttributeOnHtmlElement(s.IDs.MiddleFormContainer,s.AttributeName.AriaLabelledBy,s.IDs.OverallFrownAnchor),E(t,s.IDs.OverallFrownAnchor)}function O(t){f=s.FeedbackType.Idea,m(s.IDs.OverallIdeaAnchor),d.setAttributeOnHtmlElement(s.IDs.MiddleFormContainer,s.AttributeName.AriaExpanded,s.AttributeValue.True),d.setAttributeOnHtmlElement(s.IDs.MiddleFormContainer,s.AttributeName.AriaLabelledBy,s.IDs.OverallIdeaAnchor),E(t,s.IDs.OverallIdeaAnchor)}function N(t){f=s.FeedbackType.Bug,m(s.IDs.OverallBugAnchor),d.setAttributeOnHtmlElement(s.IDs.MiddleFormContainer,s.AttributeName.AriaExpanded,s.AttributeValue.True),d.setAttributeOnHtmlElement(s.IDs.MiddleFormContainer,s.AttributeName.AriaLabelledBy,s.IDs.OverallBugAnchor),E(t,s.IDs.OverallBugAnchor)}function D(t,e,n,i,o,s){return function(p){p.preventDefault(),p.stopPropagation(),d.setElementVisibility(t,!1);var g=new c.Spinner(e),h=new r.Transporter(a.get().getCommonInitOptions().environment,"Sas",a.get().getCommonInitOptions().appId,f,a.get().getCommonInitOptions().applicationGroup,a.get().getCommonInitOptions().telemetryGroup,a.get().getCommonInitOptions().webGroup);(y=document.getElementById(n))&&y.value&&h.setComment(y.value),(p=(S=document.getElementById(i))&&!!S.value)&&h.setEmail(S.value);var m,y,S=(y=document.getElementById(o))&&y.checked;(y=document.getElementById(s))&&0<y.selectedIndex&&h.setCategory(y.value),u.getLogger().logEvent(u.EventIds.InApp.UI.Form.Submit.VALUE,1,{FeedbackType:f,IsEmailIncluded:p,IsScreenshotIncluded:S}),S?(m=performance.now(),l.createScreenShot().then((function(t){var e=performance.now();u.getLogger().logEvent(u.EventIds.Shared.Screenshot.Render.Success.VALUE,1,{TimeMilliseconds:e-m}),h.setScreenshot(t),h.submit()})).catch((function(t){var e=performance.now();u.getLogger().logEvent(u.EventIds.Shared.Screenshot.Render.Failed.VALUE,2,{ErrorMessage:t,TimeMilliseconds:e-m}),h.submit()}))):h.submit(),g.destroy(),v(!0)}}function x(t){t.preventDefault(),t.stopPropagation(),window.open(document.getElementById(s.IDs.UserVoiceFormGoButton).getAttribute(s.AttributeName.Source)),v(!1)}n.registerSingle=function(t,e){void 0===e&&(e=function(){}),f=t,S(s.IDs.SingleFormSubmitButton,"click",D(s.IDs.SingleFormSubmitButton,s.IDs.SingleFormSubmitButtonSpinner,s.IDs.SingleFormComment,s.IDs.SingleFormEmailInput,s.IDs.SingleFormScreenshotCheckbox,s.IDs.SingleFormCategoriesDropdown)),b(e)},n.registerMulti=function(t,e,n){void 0===n&&(n=function(){}),g=e,o=t,S(s.IDs.OverallSmileAnchor,"click",F),S(s.IDs.OverallFrownAnchor,"click",_),S(s.IDs.OverallIdeaAnchor,"click",O),S(s.IDs.OverallBugAnchor,"click",N),S(s.IDs.BasicFormSubmitButton,"click",D(s.IDs.BasicFormSubmitButton,s.IDs.BasicFormSubmitButtonSpinner,s.IDs.BasicFormComment,s.IDs.BasicFormEmailInput,s.IDs.BasicFormScreenshotCheckbox,s.IDs.BasicFormCategoriesDropdown)),S(s.IDs.UserVoiceFormGoButton,"click",x),b(n)}},{"./../../Configuration/Configuration":55,"./../../Constants":57,"./../../Logging/Logging":71,"./../../Screenshot":76,"./../../Transport/Transport":87,"./../SpinnerControl":101,"./../Utils":106,"./TabFocus":96}],91:[function(t,e,n){"use strict";n.__esModule=!0;var i=t("./../../../UIStrings/UIStrings"),o=t("./FormTemplateType"),r=t("./../../CategoriesDropdown"),a=t("./../../RatingControl"),s=t("./../../../Constants"),u=t("./../../../Configuration/Configuration");n.generate=function(){var t=u.get().getInAppFeedbackLaunchOptions().categories;return{children:[{attributes:[{name:s.AttributeName.For,value:s.IDs.BasicFormComment}],classes:[s.Classes.FontSubtitle,s.Classes.TextAlignLeft,s.Classes.FormQuestionMiddleText],id:s.IDs.BasicFormQuestionMiddleText,tag:s.Tags.Label},{attributes:[{name:s.AttributeName.Id,value:s.IDs.BasicFormCategoriesDropdown}],brs:t.show,children:r.generate(t?t.customCategories:null),classes:[s.Classes.FontSubText,s.Classes.FormCategoriesDropdown,s.Classes.TextInput],tag:s.Tags.Select},{attributes:[{name:s.AttributeName.Placeholder,value:i.getUIStrings().Form.CommentPlaceholder},{name:s.AttributeName.MaxLength,value:s.AttributeValue.TextAreaMaxLength}],classes:[s.Classes.FontSubText,s.Classes.FormComment,s.Classes.TextInput],id:s.IDs.BasicFormComment,tag:s.Tags.TextArea},{brs:!1,children:[{attributes:[{name:s.AttributeName.For,value:s.IDs.BasicFormRating}],classes:[s.Classes.FontText,s.Classes.TextAlignLeft,s.Classes.FormRatingLabel],innerText:i.getUIStrings().Form.RatingLabel,tag:s.Tags.Label},a.generate(s.IDs.BasicFormRating)],classes:[s.Classes.FormRatingContainer]},{attributes:[{name:s.AttributeName.Type,value:s.AttributeValue.Text},{name:s.AttributeName.Placeholder,value:i.getUIStrings().Form.EmailPlaceholder},{name:s.AttributeName.AriaLabel,value:i.getUIStrings().Form.EmailPlaceholder},{name:s.AttributeName.Name,value:s.IDs.BasicFormEmailInput},{name:s.AttributeName.MaxLength,value:s.AttributeValue.TextAreaMaxLength},{name:s.AttributeName.Value,value:u.get().getInAppFeedbackInitOptions().userEmail?u.get().getInAppFeedbackInitOptions().userEmail:""}],classes:[s.Classes.FontSubText,s.Classes.FormEmailInput,s.Classes.TextInput],id:s.IDs.BasicFormEmailInput,tag:s.Tags.Input},{children:[{children:[{attributes:[{name:s.AttributeName.Type,value:s.AttributeValue.Checkbox},{name:s.AttributeName.Value,value:s.AttributeValue.Unchecked}],brs:u.get().getInAppFeedbackInitOptions().screenshot,classes:[s.Classes.FormScreenshotCheckbox,s.Classes.CheckBox],id:s.IDs.BasicFormScreenshotCheckbox,tag:s.Tags.Input},{attributes:[{name:s.AttributeName.For,value:s.IDs.BasicFormScreenshotCheckbox}],brs:u.get().getInAppFeedbackInitOptions().screenshot,classes:[s.Classes.FontText,s.Classes.TextAlignLeft,s.Classes.FormScreenshotLabel],innerText:i.getUIStrings().Form.ScreenshotLabel,tag:s.Tags.Label}],classes:[s.Classes.FormScreenshotContainer]},{children:[{classes:[s.Classes.SubmitButton],id:s.IDs.BasicFormSubmitButton,innerText:i.getUIStrings().Form.Submit,tag:s.Tags.Button},{classes:[s.Classes.Spinner,s.Classes.Hidden],id:s.IDs.BasicFormSubmitButtonSpinner,tag:s.Tags.Div}],classes:[s.Classes.FormSubmitButtonContainer]}],classes:[s.Classes.FormBottomContainer]}],classes:[s.Classes.Hidden,s.Classes.MarginLeft60px],id:n.containerId}},n.containerId=s.IDs.BasicFormContainer,n.onSelect=function(t){switch(t){case s.FeedbackType.Smile:document.getElementById(s.IDs.BasicFormQuestionMiddleText).textContent=i.getUIStrings().SmileForm.Title;break;case s.FeedbackType.Frown:document.getElementById(s.IDs.BasicFormQuestionMiddleText).textContent=i.getUIStrings().FrownForm.Title;break;case s.FeedbackType.Idea:document.getElementById(s.IDs.BasicFormQuestionMiddleText).textContent=i.getUIStrings().IdeaForm.Title;break;case s.FeedbackType.Bug:document.getElementById(s.IDs.BasicFormQuestionMiddleText).textContent=i.getUIStrings().BugForm.Title}document.getElementById(s.IDs.BasicFormComment).focus()},n.type=o.FormTemplateType.Basic},{"./../../../Configuration/Configuration":55,"./../../../Constants":57,"./../../../UIStrings/UIStrings":88,"./../../CategoriesDropdown":97,"./../../RatingControl":99,"./FormTemplateType":92}],92:[function(t,e,n){"use strict";n.__esModule=!0,(n=n.FormTemplateType||(n.FormTemplateType={}))[n.Single=0]="Single",n[n.Basic=1]="Basic",n[n.UserVoice=2]="UserVoice"},{}],93:[function(t,e,n){"use strict";n.__esModule=!0;var i=t("./../../../UIStrings/UIStrings"),o=t("./FormTemplateType"),r=t("./../../CategoriesDropdown"),a=t("./../../RatingControl"),s=t("./../../../Configuration/Configuration"),u=t("./../../../Constants");n.generate=function(){var t=s.get().getInAppFeedbackLaunchOptions().categories;return{children:[{attributes:[{name:u.AttributeName.For,value:u.IDs.SingleFormComment}],classes:[u.Classes.FontSubtitle,u.Classes.TextAlignLeft,u.Classes.FormQuestionMiddleText],id:u.IDs.SingleFormQuestionMiddleText,innerText:i.getUIStrings().SingleForm.Title,tag:u.Tags.Label},{attributes:[{name:u.AttributeName.Id,value:u.IDs.SingleFormCategoriesDropdown}],brs:t.show,children:r.generate(t?t.customCategories:null),classes:[u.Classes.FontSubText,u.Classes.FormCategoriesDropdown,u.Classes.TextInput],tag:u.Tags.Select},{attributes:[{name:u.AttributeName.Placeholder,value:i.getUIStrings().Form.CommentPlaceholder},{name:u.AttributeName.MaxLength,value:u.AttributeValue.TextAreaMaxLength}],classes:[u.Classes.FontSubText,u.Classes.FormComment,u.Classes.TextInput],id:u.IDs.SingleFormComment,tag:u.Tags.TextArea},{brs:!1,children:[{attributes:[{name:u.AttributeName.For,value:u.IDs.SingleFormRating}],classes:[u.Classes.FontSubText,u.Classes.TextAlignLeft,u.Classes.FormRatingLabel],innerText:i.getUIStrings().Form.RatingLabel,tag:u.Tags.Label},a.generate(u.IDs.SingleFormRating)],classes:[u.Classes.FormRatingContainer]},{attributes:[{name:u.AttributeName.Type,value:u.AttributeValue.Text},{name:u.AttributeName.Placeholder,value:i.getUIStrings().Form.EmailPlaceholder},{name:u.AttributeName.AriaLabel,value:i.getUIStrings().Form.EmailPlaceholder},{name:u.AttributeName.Name,value:u.IDs.SingleFormEmailInput},{name:u.AttributeName.MaxLength,value:u.AttributeValue.TextAreaMaxLength},{name:u.AttributeName.Value,value:s.get().getInAppFeedbackInitOptions().userEmail?s.get().getInAppFeedbackInitOptions().userEmail:""}],classes:[u.Classes.FontSubText,u.Classes.FormEmailInput,u.Classes.TextInput],id:u.IDs.SingleFormEmailInput,tag:u.Tags.Input},{children:[{attributes:[{name:u.AttributeName.HRef,value:u.Urls.PrivacyStatementLink},{name:u.AttributeName.Target,value:u.AttributeValue.BlankWindow},{name:u.AttributeName.Rel,value:u.AttributeValue.NoReferrer}],classes:[u.Classes.Link],id:u.IDs.PrivacyStatementLink,innerText:i.getUIStrings().PrivacyStatement,tag:u.Tags.Anchor}],classes:[u.Classes.FontSubSubText,u.Classes.TextAlignLeft,u.Classes.PrivacyStatementLinkDiv]},{children:[{children:[{attributes:[{name:u.AttributeName.Type,value:u.AttributeValue.Checkbox},{name:u.AttributeName.Value,value:u.AttributeValue.Unchecked}],brs:s.get().getInAppFeedbackInitOptions().screenshot,classes:[u.Classes.FormScreenshotCheckbox,u.Classes.CheckBox],id:u.IDs.SingleFormScreenshotCheckbox,tag:u.Tags.Input},{attributes:[{name:u.AttributeName.For,value:u.IDs.SingleFormScreenshotCheckbox}],brs:s.get().getInAppFeedbackInitOptions().screenshot,classes:[u.Classes.FontText,u.Classes.TextAlignLeft,u.Classes.FormScreenshotLabel],innerText:i.getUIStrings().Form.ScreenshotLabel,tag:u.Tags.Label}],classes:[u.Classes.FormScreenshotContainer]},{children:[{classes:[u.Classes.SubmitButton],id:u.IDs.SingleFormSubmitButton,innerText:i.getUIStrings().Form.Submit,tag:u.Tags.Button},{classes:[u.Classes.Spinner,u.Classes.Hidden],id:u.IDs.SingleFormSubmitButtonSpinner,tag:u.Tags.Div}],classes:[u.Classes.FormSubmitButtonContainer]}],classes:[u.Classes.FormBottomContainer]}],id:n.containerId}},n.containerId=u.IDs.SingleFormContainer,n.onSelect=function(t){document.getElementById(u.IDs.SingleFormComment).focus()},n.type=o.FormTemplateType.Single},{"./../../../Configuration/Configuration":55,"./../../../Constants":57,"./../../../UIStrings/UIStrings":88,"./../../CategoriesDropdown":97,"./../../RatingControl":99,"./FormTemplateType":92}],94:[function(t,e,n){"use strict";n.__esModule=!0;var i=t("./../../../UIStrings/UIStrings"),o=t("./FormTemplateType"),r=t("./../../../Constants"),a=t("./../../../Configuration/Configuration");n.generate=function(){var t=a.get().getInAppFeedbackInitOptions().userVoice;return{children:[{classes:[r.Classes.FontSubtitle,r.Classes.TextAlignLeft,r.Classes.FormQuestionMiddleText],innerText:i.getUIStrings().UserVoiceForm.Title},{classes:[r.Classes.FontText,r.Classes.TextAlignLeft,r.Classes.FormMiddleText],innerText:i.getUIStrings().UserVoiceForm.Text},{children:[{children:[{attributes:[{name:r.AttributeName.Source,value:t.url}],classes:[r.Classes.SubmitButton],id:r.IDs.UserVoiceFormGoButton,innerText:i.getUIStrings().UserVoiceForm.Button,tag:r.Tags.Button}],classes:[r.Classes.FormSubmitButtonContainer]}],classes:[r.Classes.FormBottomContainer]}],classes:[r.Classes.Hidden,r.Classes.MarginLeft60px],id:n.containerId}},n.containerId=r.IDs.UserVoiceFormContainer,n.onSelect=function(t){document.getElementById(r.IDs.UserVoiceFormGoButton).focus()},n.type=o.FormTemplateType.UserVoice},{"./../../../Configuration/Configuration":55,"./../../../Constants":57,"./../../../UIStrings/UIStrings":88,"./FormTemplateType":92}],95:[function(t,e,n){"use strict";n.__esModule=!0;var i=t("./../../Constants"),o=t("./../../UIStrings/UIStrings"),r=t("./../Utils"),a=t("./FormTemplates/SingleFormTemplate");function s(t,e,n,o,r){return{attributes:[{name:i.AttributeName.Type,value:i.AttributeValue.Button},{name:i.AttributeName.Role,value:i.AttributeValue.Tab},{name:i.AttributeName.AriaLabel,value:r},{name:i.AttributeName.AriaSelected,value:i.AttributeValue.False}],children:[{classes:[i.Classes.OverallImage],id:e,innerHTML:n,tag:i.Tags.Div},{classes:[i.Classes.FontSubtitle,i.Classes.OverallText],id:o,innerText:r}],classes:[i.Classes.OverallAnchor,i.Classes.TextAlignLeft],id:t,tag:i.Tags.Button}}n.generateMulti=function(t){return{attributes:[{name:i.AttributeName.DataHtml2CanvasIgnore,value:i.AttributeValue.True}],children:[{attributes:[{name:i.AttributeName.Role,value:i.AttributeValue.Dialog},{name:i.AttributeName.AriaModal,value:i.AttributeValue.True}],children:[{attributes:[{name:i.AttributeName.Role,value:i.AttributeValue.TabList},{name:i.AttributeName.AriaDescribedBy,value:i.IDs.QuestionLeftText},{name:i.AttributeName.AriaLabel,value:o.getUIStrings().FeedbackSubtitle},{name:i.AttributeName.AriaOrientation,value:i.AttributeValue.AriaOrientationValueVertical}],children:[{attributes:[{name:i.AttributeName.TabIndex,value:i.AttributeValue.Zero}],id:i.IDs.FirstTabbable},{children:[{children:[{classes:[i.Classes.FontSubtitle,i.Classes.TextAlignLeft],id:i.IDs.QuestionLeftText,innerText:o.getUIStrings().FeedbackSubtitle},{children:[{children:function(t){var e={children:[]};return i.FeedbackType.Smile in t&&e.children.push(s(i.IDs.OverallSmileAnchor,i.IDs.OverallSmileImage,'<svg viewBox="0 0 72 72" width="24px" height="24px" focusable="false"><path d="M36 1C16.7 1 1 16.7 1 36s15.7 35 35 35c19.3 0 35-15.7 35-35S55.3 1 36 1ZM49.3 18.3c2.3 0 4.2 2.7 4.2 6 0 3.3-1.9 6-4.2 6 -2.3 0-4.2-2.7-4.2-6C45.1 21 47 18.3 49.3 18.3ZM22.9 18.3c2.3 0 4.2 2.7 4.2 6 0 3.3-1.9 6-4.2 6 -2.3 0-4.2-2.7-4.2-6C18.7 21 20.6 18.3 22.9 18.3ZM36 58.6c-8.5 0-16-4.1-20.9-10.4l3.5-3.6c3.5 4.5 9.9 7.6 17.4 7.6 7.4 0 13.9-3.1 17.4-7.6l3.6 3.6C52.1 54.4 44.4 58.6 36 58.6Z"/></svg>',i.IDs.OverallSmileText,o.getUIStrings().SmileForm.Anchor)),i.FeedbackType.Frown in t&&e.children.push(s(i.IDs.OverallFrownAnchor,i.IDs.OverallFrownImage,'<svg viewBox="0 0 72 72" width="24px" height="24px" focusable="false"><path d="M36 1C16.7 1 1 16.7 1 36s15.7 35 35 35c19.3 0 35-15.7 35-35S55.3 1 36 1ZM49.3 18.3c2.3 0 4.2 2.7 4.2 6 0 3.3-1.9 6-4.2 6 -2.3 0-4.2-2.7-4.2-6C45.1 21 47 18.3 49.3 18.3ZM22.9 18.3c2.3 0 4.2 2.7 4.2 6 0 3.3-1.9 6-4.2 6 -2.3 0-4.2-2.7-4.2-6C18.7 21 20.6 18.3 22.9 18.3ZM52.8 57.9c-3.3-4.4-9.6-7.3-16.7-7.3 -7.2 0-13.4 3-16.7 7.3l-3.4-3.4c4.7-6.1 11.9-10 20.1-10 8.2 0 15.5 4 20.2 10L52.8 57.9Z"/></svg>',i.IDs.OverallFrownText,o.getUIStrings().FrownForm.Anchor)),i.FeedbackType.Idea in t&&e.children.push(s(i.IDs.OverallIdeaAnchor,i.IDs.OverallIdeaImage,'<svg viewBox="0 0 72 72" width="24px" height="24px" focusable="false"><path d="M42.3 62H29.2c-1.1 0-2 0.9-2 2s1.9 2 3 2h11.1c1.1 0 3-0.9 3-2S43.4 62 42.3 62ZM36 1.1C25 1.1 14.8 7 14.8 20.6c0 2.2 0.8 4.4 0.7 4.1 1.2 2.9 2.7 5.6 6.3 10.9 4.2 6.3 4.7 7.6 4.8 11.1v1.3c0 1.3 1 3 2.7 3h13.5c1.7 0 2.8-1.7 2.8-3v-1.5c0.1-3.5 0.1-4.7 4.2-10.9 3.6-5.4 5.7-8.4 6.8-11 0 0 0.6-1.6 0.6-4.1C57.2 6.9 47 1.1 36 1.1ZM31.9 11.9c-3.2 0-5.6 4.2-5.5 6.2 0.2 4-4.4 3.8-4.4 0.6 0-5.3 2.8-10.3 8.5-10.9C34.6 7.3 34.6 11.9 31.9 11.9ZM43.6 55h-15c-1.1 0-2 0.9-2 2v1c0 1.1 0.9 2 2 2h15c1.1 0 2-0.9 2-2v-1C45.6 55.9 44.7 55 43.6 55ZM39.1 68h-6c-0.8 0-1.5 0.7-1.5 1.5s1.2 1.5 2 1.5h5c0.8 0 2-0.7 2-1.5S39.9 68 39.1 68Z"/></svg>',i.IDs.OverallIdeaText,o.getUIStrings().IdeaForm.Anchor)),i.FeedbackType.Bug in t&&e.children.push(s(i.IDs.OverallBugAnchor,i.IDs.OverallBugImage,'<svg viewBox="150 100 1748 1748" width="24px" height="24px" focusable="false"><path d="M1824 1088q0 26-19 45t-45 19h-224q0 171-67 290l208 209q19 19 19 45t-19 45q-18 19-45 19t-45-19l-198-197q-5 5-15 13t-42 28.5-65 36.5-82 29-97 13v-896h-128v896q-51 0-101.5-13.5t-87-33-66-39-43.5-32.5l-15-14-183 207q-20 21-48 21-24 0-43-16-19-18-20.5-44.5t15.5-46.5l202-227q-58-114-58-274h-224q-26 0-45-19t-19-45 19-45 45-19h224v-294l-173-173q-19-19-19-45t19-45 45-19 45 19l173 173h844l173-173q19-19 45-19t45 19 19 45-19 45l-173 173v294h224q26 0 45 19t19 45zm-480-576h-640q0-133 93.5-226.5t226.5-93.5 226.5 93.5 93.5 226.5z"/></svg>',i.IDs.OverallBugText,o.getUIStrings().BugForm.Anchor)),e.children}(t),id:i.IDs.OverallAnchorsContainer}],id:i.IDs.ColumnSeparatorDiv},{children:[{attributes:[{name:i.AttributeName.HRef,value:i.Urls.PrivacyStatementLink},{name:i.AttributeName.Target,value:i.AttributeValue.BlankWindow},{name:i.AttributeName.Rel,value:i.AttributeValue.NoReferrer}],classes:[i.Classes.Link],id:i.IDs.PrivacyStatementLink,innerText:o.getUIStrings().PrivacyStatement,tag:i.Tags.Anchor}],classes:[i.Classes.FontSubSubText,i.Classes.TextAlignLeft,i.Classes.PrivacyStatementLinkDiv]}],classes:[i.Classes.FormContainer],id:i.IDs.LeftFormContainer},{children:function(t){var e,n={children:[]},i={};for(e in t)!t.hasOwnProperty(e)||t[e].containerId in i||(n.children.push(t[e].generate()),i[t[e].containerId]=!0);return n.children}(t),classes:[i.Classes.FormContainer,i.Classes.Hidden],attributes:[{name:i.AttributeName.Role,value:i.AttributeValue.TabPanel},{name:i.AttributeName.AriaExpanded,value:i.AttributeValue.False}],id:i.IDs.MiddleFormContainer}],classes:[i.Classes.Hidden],id:i.IDs.MainContentHolder,tag:i.Tags.Form},{attributes:[{name:i.AttributeName.TabIndex,value:i.AttributeValue.Zero}],id:i.IDs.LastTabbable}],id:i.IDs.MainContainer}],classes:[r.isRightToLeft()?i.Classes.Rtl:""],id:i.IDs.OverlayBackground}]}},n.generateSingle=function(){return{attributes:[{name:i.AttributeName.DataHtml2CanvasIgnore,value:i.AttributeValue.True}],children:[{children:[{attributes:[{name:i.AttributeName.TabIndex,value:i.AttributeValue.Zero}],id:i.IDs.FirstTabbable},{children:[{children:[a.generate()],classes:[i.Classes.FormContainer],id:i.IDs.MiddleFormContainer}],classes:[i.Classes.Hidden],id:i.IDs.MainContentHolder,tag:i.Tags.Form},{attributes:[{name:i.AttributeName.TabIndex,value:i.AttributeValue.Zero}],id:i.IDs.LastTabbable}],id:i.IDs.MainContainer}],classes:[i.Classes.SingleLayout,r.isRightToLeft()?i.Classes.Rtl:""],id:i.IDs.OverlayBackground}}},{"./../../Constants":57,"./../../UIStrings/UIStrings":88,"./../Utils":106,"./FormTemplates/SingleFormTemplate":93}],96:[function(t,e,n){"use strict";n.__esModule=!0;var i=t("./../../Constants");function o(t){if(!t.parentElement)return!1;if(/\S/.test(t.parentElement.id)){if(0<=t.parentElement.className.indexOf(i.Classes.Visible))return!0;if(0<=t.parentElement.className.indexOf(i.Classes.Hidden))return!1}return o(t.parentElement)}n.cycleTabFocus=function(t){var e=document.getElementById(i.IDs.MainContainer).querySelectorAll("a[href], area[href], input:not([disabled]):not([tabindex='-1']), button:not([disabled]):not([tabindex='-1']), select:not([disabled]):not([tabindex='-1']), textarea:not([disabled]):not([tabindex ='-1']), object, *[tabindex]:not([tabindex='-1']), *[contenteditable=true]");if(t.id===i.IDs.LastTabbable){for(var n=0;n<e.length;n++)if((r=e[n]).id!==i.IDs.FirstTabbable&&o(r))return void r.focus()}else if(t.id===i.IDs.FirstTabbable){var r;for(n=e.length-1;0<=n;n--)if((r=e[n]).id!==i.IDs.LastTabbable&&o(r))return void r.focus()}}},{"./../../Constants":57}],97:[function(t,e,n){"use strict";n.__esModule=!0;var i=t("./../UIStrings/UIStrings"),o=t("./../Constants");n.generate=function(t){t=t||[];for(var e=[{attributes:[{name:"selected",value:"true"}],innerText:i.getUIStrings().Form.CategoryPlaceholder,tag:o.Tags.Option}],n=0,r=t;n<r.length;n++){var a=r[n];e.push({innerText:a,tag:o.Tags.Option})}return e}},{"./../Constants":57,"./../UIStrings/UIStrings":88}],98:[function(t,e,n){"use strict";n.__esModule=!0;var i=t("./../Constants");n.generateRadioGroup=function(t,e,n){for(var o,r,a={children:[{classes:[i.Classes.FontSubText],id:i.IDs.TFormRatingQuestion,innerText:e,tag:i.Tags.Legend,attributes:[{name:"tabindex",value:"0"}]}],tag:i.Tags.FieldSet},s=0,u=n;s<u.length;s++){var l=u[s];Array.prototype.push.apply(a.children,(o=l[0].toString(),r=l[1],l=t,[{attributes:[{name:i.AttributeName.Type,value:i.AttributeValue.Radio},{name:i.AttributeName.Value,value:o},{name:i.AttributeName.Name,value:l}],id:o,tag:i.Tags.Input},{attributes:[{name:i.AttributeName.For,value:o}],children:[{children:[{tag:i.Tags.Span}],classes:[i.Classes.ChoiceGroupIcon],tag:i.Tags.Span},{classes:["obf-ChoiceGroupLabel"],innerHTML:r,tag:i.Tags.Span}],classes:[i.Classes.FontSubText],tag:i.Tags.Label}]))}return{children:[a],classes:[i.Classes.ChoiceGroup],id:t}}},{"./../Constants":57}],99:[function(t,e,n){"use strict";n.__esModule=!0;var i=t("./../Constants"),o="obf-star",r={children:[{attributes:[{name:i.AttributeName.Id,value:o},{name:i.AttributeName.X,value:"0"},{name:i.AttributeName.Y,value:"0"},{name:i.AttributeName.Width,value:"105"},{name:i.AttributeName.Height,value:"100"},{name:i.AttributeName.Points,value:"52.5, 80.3 84, 100 76.3, 63 105, 38 67.2, 35 52.5, 0 37.8, 35 0, 38 28.7, 63 20, 100 52.5, 80.3"}],id:o,tag:i.Tags.Polygon}],tag:i.Tags.Defs},a={attributes:[{name:i.AttributeName.xlinkHref,value:"#"+o}],tag:i.Tags.Use},s={attributes:[{name:i.AttributeName.xlinkHref,value:"#"+o},{name:i.AttributeName.Transform,value:"translate(105 0)"}],tag:i.Tags.Use},u={attributes:[{name:i.AttributeName.xlinkHref,value:"#"+o},{name:i.AttributeName.Transform,value:"translate(210 0)"}],tag:i.Tags.Use},l=(t={attributes:[{name:i.AttributeName.xlinkHref,value:"#"+o},{name:i.AttributeName.Transform,value:"translate(315 0)"}],tag:i.Tags.Use},o={attributes:[{name:i.AttributeName.xlinkHref,value:"#"+o},{name:i.AttributeName.Transform,value:"translate(420 0)"}],tag:i.Tags.Use},{attributes:[{name:i.AttributeName.ViewBox,value:"0 0 525 100"}],children:[r,a,s,u,t,o],classes:[i.Classes.RatingGraphic],tag:i.Tags.Svg}),c={attributes:[{name:i.AttributeName.ViewBox,value:"0 0 105 100"}],children:[r,a],classes:[i.Classes.RatingGraphic,i.Classes.RatingGraphicFilled],tag:i.Tags.Svg},d={attributes:[{name:i.AttributeName.ViewBox,value:"0 0 210 100"}],children:[r,a,s],classes:[i.Classes.RatingGraphic,i.Classes.RatingGraphicFilled],tag:i.Tags.Svg},p={attributes:[{name:i.AttributeName.ViewBox,value:"0 0 315 100"}],children:[r,a,s,u],classes:[i.Classes.RatingGraphic,i.Classes.RatingGraphicFilled],tag:i.Tags.Svg},g={attributes:[{name:i.AttributeName.ViewBox,value:"0 0 420 100"}],children:[r,a,s,u,t],classes:[i.Classes.RatingGraphic,i.Classes.RatingGraphicFilled],tag:i.Tags.Svg},f={attributes:[{name:i.AttributeName.ViewBox,value:"0 0 525 100"}],children:[r,a,s,u,t,o],classes:[i.Classes.RatingGraphic,i.Classes.RatingGraphicFilled],tag:i.Tags.Svg};n.generate=function(t){return{children:[l,{attributes:[{name:i.AttributeName.Type,value:"radio"},{name:i.AttributeName.Name,value:t},{name:i.AttributeName.Value,value:"1"}],tag:i.Tags.Input},c,{attributes:[{name:i.AttributeName.Type,value:"radio"},{name:i.AttributeName.Name,value:t},{name:i.AttributeName.Value,value:"2"}],tag:i.Tags.Input},d,{attributes:[{name:i.AttributeName.Type,value:"radio"},{name:i.AttributeName.Name,value:t},{name:i.AttributeName.Value,value:"3"}],tag:i.Tags.Input},p,{attributes:[{name:i.AttributeName.Type,value:"radio"},{name:i.AttributeName.Name,value:t},{name:i.AttributeName.Value,value:"4"}],tag:i.Tags.Input},g,{attributes:[{name:i.AttributeName.Type,value:"radio"},{name:i.AttributeName.Name,value:t},{name:i.AttributeName.Value,value:"5"}],tag:i.Tags.Input},f],classes:[i.Classes.Rating],id:t,tag:i.Tags.Span}}},{"./../Constants":57}],100:[function(t,e,n){"use strict";n.__esModule=!0;var i=t("./../Constants");n.elementFromJson=function t(e,n){if(void 0===e.brs&&(e.brs=!0),!e.brs)return null;var o,r;if(e.tag||(e.tag=i.Tags.Div),e.tag===i.Tags.Svg&&(n=!0),o=n?document.createElementNS("http://www.w3.org/2000/svg",e.tag):document.createElement(e.tag),e.attributes)for(var a,s=0;s<e.attributes.length;s++)(a=e.attributes[s]).name===i.AttributeName.xlinkHref?o.setAttributeNS("http://www.w3.org/1999/xlink",i.AttributeName.HRef,a.value):o.setAttribute(a.name,a.value);if(e.id&&(o.id=e.id),e.classes&&(r=e.classes.join(" "),n?o.setAttribute(i.AttributeName.Class,r):o.className=r),e.innerText&&!n&&(o.textContent=e.innerText),e.innerHTML&&!n&&(o.innerHTML=e.innerHTML),e.children)for(s=0;s<e.children.length;s++){var u=e.children[s];!u||(u=t(u,n))&&o.appendChild(u)}return o}},{"./../Constants":57}],101:[function(t,e,n){"use strict";n.__esModule=!0;var i=t("./../Constants"),o=t("./Utils");r.prototype.destroy=function(){o.setElementVisibility(this.spinnerId,!1),this.stop()},r.prototype.start=function(){var t=this;this.stop(),this.interval=setInterval((function(){for(var e=t.circleObjects.length;e--;)!function(t){var e=function(t){return parseFloat(window.getComputedStyle(t).getPropertyValue("opacity"))}(t.element)-.125;e<=0&&(e=1),a(t.element,e)}(t.circleObjects[e])}),90)},r.prototype.stop=function(){clearInterval(this.interval)},r.prototype.createCirclesAndArrange=function(){for(var t=0,e=34*.2,n=2*Math.PI/8,o=8;o--;){var r=(s=void 0,(s=document.createElement("div")).classList.add(i.Classes.SpinnerCircle),s.style.width=s.style.height=34*.2+"px",s),a=Math.round(17+13.6*Math.cos(t)-.5*r.clientWidth)-.5*e,s=Math.round(17+13.6*Math.sin(t)-.5*r.clientHeight)-.5*e;this.spinner.appendChild(r),r.style.left=a+"px",r.style.top=s+"px",t+=n,r={element:r,j:o},this.circleObjects.push(r)}},r.prototype.initializeOpacities=function(){for(var t=0,e=1;t<8;t++){var n=.125*e++;a(this.circleObjects[t].element,n)}},t=r;function r(t){this.circleObjects=[],this.spinnerId=t,this.spinner=document.getElementById(this.spinnerId),this.createCirclesAndArrange(),this.initializeOpacities(),this.start(),o.setElementVisibility(t,!0)}function a(t,e){t.style.opacity=e.toString()}n.Spinner=t},{"./../Constants":57,"./Utils":106}],102:[function(t,e,n){"use strict";n.__esModule=!0;var i,o,r=t("./../../Transport/Transport"),a=t("./../../Constants"),s=t("./../Utils"),u=t("./../SpinnerControl"),l=t("./../../Logging/Logging"),c=t("./../../Configuration/Configuration"),d=t("@ms-ofb/officefloodgatecore/dist/src/Api/Api");function p(t){!function(){for(var t=0,e=g;t<e.length;t++){var n=e[t];s.unregisterListener(n.id,n.event,n.listener)}g=[]}(),i(t)}var g=[];function f(t,e,n){s.registerListener(t,e,n),g.push({event:e,id:t,listener:n})}function h(t){var e,n=document.getElementById(a.IDs.TFormEmailCheckBox);n&&((e=document.getElementById(a.IDs.TFormEmailTextBox)).value=n.checked?c.get().getCommonInitOptions().userEmail:null,e.disabled=!n.checked)}function m(t){t.keyCode===a.Keys.Esc&&(t.preventDefault(),t.stopPropagation(),p(!1))}function v(t){t.preventDefault(),t.stopPropagation(),p(!1)}function y(t){t.preventDefault(),t.stopPropagation(),S()}function S(){o=!1,s.setElementVisibility(a.IDs.TPromptContainer,!1),s.setElementVisibility(a.IDs.TFormContainer,!0),document.getElementById(a.IDs.TFormRatingQuestion)&&document.getElementById(a.IDs.TFormRatingQuestion).focus(),l.getLogger().logEvent(l.EventIds.Survey.UI.Form.Shown.VALUE,1,{CampaignId:c.get().getFloodgateSurvey().getCampaignId(),SurveyId:c.get().getFloodgateSurvey().getId(),SurveyType:c.get().getFloodgateSurvey().getSurveyType()})}function b(t){document.getElementById(a.IDs.TFormSubmitButton).disabled=!1}function C(t){t.preventDefault(),t.stopPropagation(),s.setElementVisibility(a.IDs.TFormSubmitButton,!1);var e=new u.Spinner(a.IDs.TFormSubmitButtonSpinner),n=new r.Transporter(c.get().getCommonInitOptions().environment,d.ISurvey.Type[c.get().getFloodgateSurvey().getSurveyType()],c.get().getCommonInitOptions().appId,"Survey",c.get().getCommonInitOptions().applicationGroup,c.get().getCommonInitOptions().telemetryGroup,c.get().getCommonInitOptions().webGroup),i=document.getElementById(a.IDs.TFormComment),o=i&&!!i.value;t=document.querySelector('input[name="'+a.IDs.TFormRating+'"]:checked');c.get().getFloodgateSurvey().setValues(Number(t.value),o?i.value:""),n.setManifestValues(c.get().getFloodgateSurvey().getJsonElements()),o=document.getElementById(a.IDs.TFormEmailCheckBox),i=document.getElementById(a.IDs.TFormEmailTextBox),o&&o.checked&&""!==i.value&&n.setEmail(i.value),n.submit(),e.destroy(),p(!0),l.getLogger().logEvent(l.EventIds.Survey.UI.Form.Submit.VALUE,1,{CampaignId:c.get().getFloodgateSurvey().getCampaignId(),SurveyId:c.get().getFloodgateSurvey().getId(),SurveyType:c.get().getFloodgateSurvey().getSurveyType()})}n.register=function(t){void 0===t&&(t=function(){}),i=t,o=!0,f(a.IDs.ToastContainer,"keyup",m),f(a.IDs.ToastCancel,"click",v),f(a.IDs.TPromptContainer,"click",y),f(a.IDs.TFormSubmitButton,"click",C),f(a.IDs.TFormEmailCheckBox,"click",h),h();for(var e=document.querySelectorAll('input[name="'+a.IDs.TFormRating+'"]'),n=0;n<e.length;++n)s.registerListenerToElement(e[n],"click",b);if(c.get().getFloodgateSurvey().showPrompt?l.getLogger().logEvent(l.EventIds.Survey.UI.Prompt.Shown.VALUE,1,{CampaignId:c.get().getFloodgateSurvey().getCampaignId(),SurveyId:c.get().getFloodgateSurvey().getId(),SurveyType:c.get().getFloodgateSurvey().getSurveyType()}):S(),(t=c.get().getFloodgateInitOptions().autoDismiss)!==a.AutoDismissValues.NoAutoDismiss){var r=void 0;switch(t){case a.AutoDismissValues.SevenSeconds:r=7e3;break;case a.AutoDismissValues.FourteenSeconds:r=14e3;break;case a.AutoDismissValues.TwentyOneSeconds:r=21e3;break;case a.AutoDismissValues.TwentyEightSeconds:r=28e3}void 0!==r&&setTimeout((function(){o&&p(!1)}),r)}}},{"./../../Configuration/Configuration":55,"./../../Constants":57,"./../../Logging/Logging":71,"./../../Transport/Transport":87,"./../SpinnerControl":101,"./../Utils":106,"@ms-ofb/officefloodgatecore/dist/src/Api/Api":5}],103:[function(t,e,n){"use strict";n.__esModule=!0;var i=t("./../ChoiceGroupControl"),o=t("./../../Configuration/Configuration"),r=t("./../../Constants"),a=t("./../../UIStrings/UIStrings"),s=t("./../Utils"),u=t("./../../Constants");n.generate=function(){return{attributes:[{name:r.AttributeName.DataHtml2CanvasIgnore,value:r.AttributeValue.True},{name:r.AttributeName.Role,value:"alert"},{name:"aria-labelledby",value:r.IDs.TPromptTitle},{name:"aria-describedby",value:r.IDs.TPromptText}],children:[{attributes:[{name:r.AttributeName.Type,value:r.AttributeValue.Button},{name:r.AttributeName.AriaLabel,value:a.getUIStrings().CloseLabel}],id:r.IDs.ToastCancel,innerHTML:'<svg viewBox="4 4 16 16" width="16px" height="16px" focusable="false"><path d="M19,6.41L17.59,5 12,10.59 6.41,5 5,6.41 10.59,12 5,17.59 6.41,19 12,13.41 17.59,19 19,17.59 13.41,12z" fill="#000"/></svg>',tag:r.Tags.Button},{attributes:[{name:"aria-labelledby",value:r.IDs.TPromptTitle}],children:[{classes:[r.Classes.FontText,r.Classes.TextAlignLeft],id:r.IDs.TPromptTitle,innerText:o.get().getFloodgateSurvey().getTitle()},{classes:[r.Classes.FontSubText,r.Classes.TextAlignLeft],id:r.IDs.TPromptText,innerText:o.get().getFloodgateSurvey().getPromptQuestion()}],id:r.IDs.TPromptContainer,tag:r.Tags.Button},{children:[{classes:[r.Classes.FontText,r.Classes.TextAlignLeft],id:r.IDs.TFormTitle,innerText:o.get().getFloodgateSurvey().getTitle()},function(){for(var t=[],e=0,n=0,a=o.get().getFloodgateSurvey().getRatingValuesAscending();n<a.length;n++){var s=a[n];t.push([e,s]),e++}return i.generateRadioGroup(r.IDs.TFormRating,o.get().getFloodgateSurvey().getRatingQuestion(),t.reverse())}(),{attributes:[{name:r.AttributeName.Placeholder,value:o.get().getFloodgateSurvey().getCommentQuestion()},{name:r.AttributeName.AriaLabel,value:o.get().getFloodgateSurvey().getCommentQuestion()},{name:r.AttributeName.MaxLength,value:r.AttributeValue.TextAreaMaxLength}],classes:[r.Classes.FontSubText,r.Classes.TextInput],id:r.IDs.TFormComment,tag:r.Tags.TextArea},{brs:o.get().getFloodgateSurvey().showEmailRequest,children:[{attributes:[{name:u.AttributeName.Type,value:u.AttributeValue.Checkbox},{name:o.get().getCommonInitOptions().userEmailConsentDefault?u.AttributeValue.Checked:u.AttributeValue.Unchecked,value:""}],classes:[u.Classes.TFormEmailCheckbox,u.Classes.CheckBox],id:u.IDs.TFormEmailCheckBox,tag:u.Tags.Input},{attributes:[{name:u.AttributeName.For,value:u.IDs.TFormEmailCheckBox}],classes:[u.Classes.FontSubText,u.Classes.TextAlignLeft,u.Classes.TFormEmailLabel],innerText:a.getUIStrings().Form.EmailCheckBoxLabel,tag:u.Tags.Label},{attributes:[{name:u.AttributeName.Type,value:u.AttributeValue.Text},{name:u.AttributeName.Placeholder,value:a.getUIStrings().Form.EmailPlaceholder},{name:u.AttributeName.AriaLabel,value:a.getUIStrings().Form.EmailPlaceholder},{name:u.AttributeName.Name,value:u.IDs.BasicFormEmailInput},{name:u.AttributeName.MaxLength,value:u.AttributeValue.TextAreaMaxLength},{name:u.AttributeName.Value,value:o.get().getCommonInitOptions().userEmailConsentDefault?o.get().getCommonInitOptions().userEmail:""}],classes:[u.Classes.FontSubText,u.Classes.FormEmailInput,u.Classes.TextInput],id:u.IDs.TFormEmailTextBox,tag:u.Tags.Input}]},{children:[{attributes:[{name:r.AttributeName.HRef,value:r.Urls.PrivacyStatementLink},{name:r.AttributeName.Target,value:r.AttributeValue.BlankWindow},{name:r.AttributeName.Rel,value:r.AttributeValue.NoReferrer}],classes:[r.Classes.Link],innerText:a.getUIStrings().PrivacyStatement,tag:r.Tags.Anchor}],classes:[r.Classes.FontSubSubText,r.Classes.TextAlignLeft,r.Classes.PrivacyStatementLinkDiv]},{children:[{attributes:[{name:r.AttributeName.Disabled,value:r.AttributeValue.True}],classes:[r.Classes.FontSubText,r.Classes.SubmitButton],id:r.IDs.TFormSubmitButton,innerText:a.getUIStrings().Form.Submit,tag:r.Tags.Button},{classes:[r.Classes.Spinner,r.Classes.Hidden],id:r.IDs.TFormSubmitButtonSpinner,tag:r.Tags.Div}],id:r.IDs.TFormSubmitButtonContainer}],classes:[r.Classes.Hidden],id:r.IDs.TFormContainer}],classes:[r.Classes.Toast,s.isRightToLeft()?r.Classes.Rtl:""],id:r.IDs.ToastContainer}}},{"./../../Configuration/Configuration":55,"./../../Constants":57,"./../../UIStrings/UIStrings":88,"./../ChoiceGroupControl":98,"./../Utils":106}],104:[function(t,e,n){"use strict";n.__esModule=!0;var i=t("./../../Constants"),o=t("./Events"),r=t("./Layout"),a=t("./../Renderer"),s=t("./../Utils"),u=t("./../../Configuration/Configuration");n.createSurvey=function(t){var e;e=a.elementFromJson(r.generate()),document.body.insertBefore(e,document.body.firstChild),s.setElementVisibility(i.IDs.ToastContainer,!0),o.register((function(e){s.setElementVisibility(i.IDs.ToastContainer,!1),s.deleteElementById(i.IDs.ToastContainer),u.get().getFloodgateInitOptions().onDismiss(u.get().getFloodgateSurvey().getCampaignId(),e),t()}))}},{"./../../Configuration/Configuration":55,"./../../Constants":57,"./../Renderer":100,"./../Utils":106,"./Events":102,"./Layout":103}],105:[function(t,e,n){"use strict";n.__esModule=!0;var i=t("./BellyBand/BellyBand");n.createBellyBandMulti=i.createMulti,i=t("./BellyBand/BellyBand"),n.createBellyBandSingle=i.createSingle,t=t("./Toast/Toast"),n.createSurvey=t.createSurvey},{"./BellyBand/BellyBand":89,"./Toast/Toast":104}],106:[function(t,e,n){"use strict";n.__esModule=!0;var i=t("./../Constants");function o(t,e){(t=document.getElementById(t))&&(t.className.match(new RegExp("\\b"+e+"\\b"))||(t.className=t.className+" "+e))}function r(t,e){(t=document.getElementById(t))&&(t.className=t.className.split(new RegExp("\\b"+e+"\\b","i")).join(" "),t.className=t.className.split(/\s+/).join(" "))}function a(t,e,n){r(t,e),o(t,n)}function s(t,e,n){t.addEventListener?t.addEventListener(e,n,!1):t.attachEvent&&t.attachEvent("on"+e,n)}function u(t,e,n){t.removeEventListener?t.removeEventListener(e,n,!1):t.detachEvent&&t.detachEvent("on"+e,n)}n.setElementVisibility=function(t,e){a(t,e?i.Classes.Hidden:i.Classes.Visible,e?i.Classes.Visible:i.Classes.Hidden)},n.deleteElementById=function(t){null!=(t=document.getElementById(t))&&null!=t.parentNode&&t.parentNode.removeChild(t)},n.addClassById=o,n.deleteClassById=r,n.replaceClassesById=a,n.setAttributeOnHtmlElement=function(t,e,n){(t=document.getElementById(t))&&t.setAttribute(e,n)},n.addEventListenerHelper=s,n.removeEventListenerHelper=u,n.registerListener=function(t,e,n){(t=document.getElementById(t))&&s(t,e,n)},n.registerListenerToElement=function(t,e,n){t&&s(t,e,n)},n.unregisterListener=function(t,e,n){(t=document.getElementById(t))&&u(t,e,n)},n.getInternetExplorerVersion=function(){var t=-1,e=window.navigator.userAgent;return-1<e.indexOf("Trident")&&null!=new RegExp("Trident/([0-9]{1,}[.0-9]{0,})").exec(e)&&(t=parseFloat(RegExp.$1),t+=4),t},n.isRightToLeft=function(){return"rtl"===getComputedStyle(document.documentElement).direction}},{"./../Constants":57}],107:[function(t,e,n){"use strict";function i(t){return"string"==typeof t}function o(t){return"boolean"==typeof t}function a(t){return null==t}function s(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}n.__esModule=!0,n.isInteger=function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t},n.isBoolean=o,n.isNullorUndefined=a,n.expectObject=function(t,e){if(a(n=t)||"object"!==r(n))throw e+" is not an object: "+t;var n},n.expectNumber=function(t,e){if("number"!=typeof t)throw e+" is not a number: "+t},n.expectString=function(t,e){if(!i(t))throw e+" is not a string: "+t},n.expectBoolean=function(t,e){if(!o(t))throw e+" is not a boolean: "+t},n.expectGuid=function(t,e){if(!i(n=t)||!/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/.test(n))throw e+" is not a guid: "+t;var n},n.expectArray=function(t,e){if(!Array.isArray(t))throw e+" is not an array: "+t},n.guid=function(){return(s()+s()+"-"+s()+"-4"+s().substr(0,3)+"-"+s()+"-"+s()+s()+s()).toLowerCase()},n.overrideValues=function(t,e){if(!e)return e;var n=e;if(t)for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);return n}},{}],108:[function(t,e,n){"use strict";n.__esModule=!0,n.default="1.4.6"},{}],109:[function(t,e,n){"use strict";n.__esModule=!0,n.isNarrow=function(){return!window.innerWidth||window.innerWidth<800}},{}],110:[function(t,e,n){"use strict";n.__esModule=!0;var i=t("es6-promise");n.loadStylesheet=function(t){var e=document.createElement("link");e.rel="stylesheet",e.type="text/css",e.href=t,(t=document.getElementsByTagName("script")[0]).parentNode.insertBefore(e,t)},n.loadScript=function(t,e){return void 0===e&&(e=window.origin),new i.Promise((function(n,i){var o=document.createElement("script");o.async=!0,o.readyState?o.onreadystatechange=function(){"loaded"!==o.readyState&&"complete"!==o.readyState||(o.onreadystatechange=null,n())}:o.onload=function(){n()},o.onerror=function(){i()},o.src=t,e&&"null"!==e&&(o.crossOrigin="anonymous");var r=document.getElementsByTagName("script")[0];r.parentNode.insertBefore(o,r)}))}},{"es6-promise":45}],111:[function(t,e,n){"use strict";n.__esModule=!0,n.get=function(){return window},n.setSetUiStrings=function(t){window.OfficeBrowserFeedback=window.OfficeBrowserFeedback||{},window.OfficeBrowserFeedback.setUiStrings=t},n.setSingleFeedback=function(t){window.OfficeBrowserFeedback=window.OfficeBrowserFeedback||{},window.OfficeBrowserFeedback.singleFeedback=t},n.setMultiFeedback=function(t){window.OfficeBrowserFeedback=window.OfficeBrowserFeedback||{},window.OfficeBrowserFeedback.multiFeedback=t},n.setFloodgateShowSurvey=function(t){window.OfficeBrowserFeedback=window.OfficeBrowserFeedback||{},window.OfficeBrowserFeedback.floodgate=window.OfficeBrowserFeedback.floodgate||{},window.OfficeBrowserFeedback.floodgate.showSurvey=t},n.setFloodgateShowCustomSurvey=function(t){window.OfficeBrowserFeedback=window.OfficeBrowserFeedback||{},window.OfficeBrowserFeedback.floodgate=window.OfficeBrowserFeedback.floodgate||{},window.OfficeBrowserFeedback.floodgate.showCustomSurvey=t},n.setFloodgateInitialize=function(t){window.OfficeBrowserFeedback=window.OfficeBrowserFeedback||{},window.OfficeBrowserFeedback.floodgate=window.OfficeBrowserFeedback.floodgate||{},window.OfficeBrowserFeedback.floodgate.initialize=t},n.setFloodgateStart=function(t){window.OfficeBrowserFeedback=window.OfficeBrowserFeedback||{},window.OfficeBrowserFeedback.floodgate=window.OfficeBrowserFeedback.floodgate||{},window.OfficeBrowserFeedback.floodgate.start=t},n.setFloodgateStop=function(t){window.OfficeBrowserFeedback=window.OfficeBrowserFeedback||{},window.OfficeBrowserFeedback.floodgate=window.OfficeBrowserFeedback.floodgate||{},window.OfficeBrowserFeedback.floodgate.stop=t},n.setFloodgateGetEngine=function(t){window.OfficeBrowserFeedback=window.OfficeBrowserFeedback||{},window.OfficeBrowserFeedback.floodgate=window.OfficeBrowserFeedback.floodgate||{},window.OfficeBrowserFeedback.floodgate.getEngine=t},n.getSettingIdMap=function(t){window.OfficeBrowserFeedback=window.OfficeBrowserFeedback||{},window.OfficeBrowserFeedback.floodgate=window.OfficeBrowserFeedback.floodgate||{},window.OfficeBrowserFeedback.floodgate.getSettingIdMap=t}},{}],112:[function(t,n,a){var s;s=function(){return n={},t.m=e=[function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=(o.prototype.Equals=function(t){return t=new o(t),this.low===t.low&&this.high===t.high},o);function o(t){this.low=0,this.high=0,this.low=parseInt(t,10),this.low<0&&(this.high=-1)}function r(t){this.low=0,this.high=0,this.low=parseInt(t,10)}function a(){}e.Int64=i,r.prototype.Equals=function(t){return t=new r(t),this.low===t.low&&this.high===t.high},i=r,e.UInt64=i,a.ToByte=function(t){return this.ToUInt8(t)},a.ToInt16=function(t){return 32767&t|(32768&t)<<16>>16},a.ToInt32=function(t){return 2147483647&t|2147483648&t},a.ToUInt8=function(t){return 255&t},a.ToUInt32=function(t){return 4294967295&t},i=a,e.Number=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),(e=e.AWTPiiKind||(e.AWTPiiKind={}))[e.NotSet=0]="NotSet",e[e.DistinguishedName=1]="DistinguishedName",e[e.GenericData=2]="GenericData",e[e.IPV4Address=3]="IPV4Address",e[e.IPv6Address=4]="IPv6Address",e[e.MailSubject=5]="MailSubject",e[e.PhoneNumber=6]="PhoneNumber",e[e.QueryString=7]="QueryString",e[e.SipAddress=8]="SipAddress",e[e.SmtpAddress=9]="SmtpAddress",e[e.Identity=10]="Identity",e[e.Uri=11]="Uri",e[e.Fqdn=12]="Fqdn",e[e.IPV4AddressLegacy=13]="IPV4AddressLegacy"},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(9),o=n(1),r=n(3);a.getPayloadBlob=function(t,e){var n=new i.IO.MemoryStream,o=new i.CompactBinaryProtocolWriter(n);return o.WriteFieldBegin(i.BondDataType.BT_MAP,3),o.WriteMapContainerBegin(e,i.BondDataType.BT_STRING,i.BondDataType.BT_LIST),Object.keys(t).forEach((function(e){o.WriteString(e);var n=t[e];o.WriteContainerBegin(1,i.BondDataType.BT_STRUCT),o.WriteFieldBegin(i.BondDataType.BT_STRING,2),o.WriteString("act_default_source"),o.WriteFieldBegin(i.BondDataType.BT_STRING,5),o.WriteString(r.newGuid()),o.WriteFieldBegin(i.BondDataType.BT_INT64,6),o.WriteInt64(r.numberToBondInt64(Date.now())),o.WriteFieldBegin(i.BondDataType.BT_LIST,8),o.WriteContainerBegin(n.length,i.BondDataType.BT_STRUCT);for(var a=0;a<n.length;++a)o.WriteBlob(n[a]);o.WriteStructEnd(!1)})),o.WriteStructEnd(!1),n.GetBuffer()},a.getEventBlob=function(t){var e=new i.IO.MemoryStream,n=new i.CompactBinaryProtocolWriter(e);n.WriteFieldBegin(i.BondDataType.BT_STRING,1),n.WriteString(t.id),n.WriteFieldBegin(i.BondDataType.BT_INT64,3),n.WriteInt64(r.numberToBondInt64(t.timestamp)),n.WriteFieldBegin(i.BondDataType.BT_STRING,5),n.WriteString(t.type),n.WriteFieldBegin(i.BondDataType.BT_STRING,6),n.WriteString(t.name);var a=[],s=[];return Object.keys(t.properties).forEach((function(e){(t.properties[e].pii===o.AWTPiiKind.NotSet?a:s).push(e)})),a.length&&(n.WriteFieldBegin(i.BondDataType.BT_MAP,13),n.WriteMapContainerBegin(a.length,i.BondDataType.BT_STRING,i.BondDataType.BT_STRING),a.forEach((function(e){n.WriteString(e),n.WriteString(t.properties[e].value)}))),s.length&&(n.WriteFieldBegin(i.BondDataType.BT_MAP,30),n.WriteMapContainerBegin(s.length,i.BondDataType.BT_STRING,i.BondDataType.BT_STRUCT),s.forEach((function(e){n.WriteString(e),n.WriteFieldBegin(i.BondDataType.BT_INT32,1),n.WriteInt32(1),n.WriteFieldBegin(i.BondDataType.BT_INT32,2),n.WriteInt32(t.properties[e].pii),n.WriteFieldBegin(i.BondDataType.BT_STRING,3),n.WriteString(t.properties[e].value),n.WriteStructEnd(!1)}))),n.WriteStructEnd(!1),e.GetBuffer()},a.base64Encode=function(t){return i.Encoding.Base64.GetString(t)},n=a;function a(){}e.default=n},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(0),o=/[xy]/g;e.numberToBondInt64=function(t){var e=new i.Int64("0");return e.low=4294967295&t,e.high=Math.floor(t/4294967296),e},e.newGuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(o,(function(t){var e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)}))},e.isPii=function(t){return!isNaN(t)&&null!==t&&0<=t&&t<=13}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Version="1.2.2",e.FullVersionString="AWT-Web-CJS-"+e.Version},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(1);e.AWTPiiKind=i.AWTPiiKind,n=n(13),e.AWT=n.default,e.AWT_COLLECTOR_URL_UNITED_STATES="https://us.pipe.aria.microsoft.com/Collector/3.0/",e.AWT_COLLECTOR_URL_GERMANY="https://de.pipe.aria.microsoft.com/Collector/3.0/",e.AWT_COLLECTOR_URL_JAPAN="https://jp.pipe.aria.microsoft.com/Collector/3.0/",e.AWT_COLLECTOR_URL_AUSTRALIA="https://au.pipe.aria.microsoft.com/Collector/3.0/",e.AWT_COLLECTOR_URL_EUROPE="https://eu.pipe.aria.microsoft.com/Collector/3.0/"},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),(e=e.BondDataType||(e.BondDataType={}))[e.BT_STOP=0]="BT_STOP",e[e.BT_STOP_BASE=1]="BT_STOP_BASE",e[e.BT_UINT8=3]="BT_UINT8",e[e.BT_UINT32=5]="BT_UINT32",e[e.BT_UINT64=6]="BT_UINT64",e[e.BT_STRING=9]="BT_STRING",e[e.BT_STRUCT=10]="BT_STRUCT",e[e.BT_LIST=11]="BT_LIST",e[e.BT_MAP=13]="BT_MAP",e[e.BT_INT32=16]="BT_INT32",e[e.BT_INT64=17]="BT_INT64",e[e.BT_UNAVAILABLE=127]="BT_UNAVAILABLE"},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(0);o.GetBytes=function(t){for(var e=[],n=0;n<t.length;++n){var i=t.charCodeAt(n);i<128?e.push(i):i<2048?e.push(192|i>>6,128|63&i):i<55296||57344<=i?e.push(224|i>>12,128|i>>6&63,128|63&i):(i=65536+((1023&i)<<10|1023&t.charCodeAt(++n)),e.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|63&i))}return e},n=o;function o(){}function r(){}function a(){}function s(){}function u(){}e.Utf8=n,r.GetString=function(t){for(var e,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=[],o=t.length%3,r=0,a=t.length-o;r<a;r+=3){var s=(t[r]<<16)+(t[r+1]<<8)+t[r+2];i.push([n.charAt((e=s)>>18&63),n.charAt(e>>12&63),n.charAt(e>>6&63),n.charAt(63&e)].join(""))}switch(o){case 1:s=t[t.length-1],i.push(n.charAt(s>>2)),i.push(n.charAt(s<<4&63)),i.push("==");break;case 2:var u=(t[t.length-2]<<8)+t[t.length-1];i.push(n.charAt(u>>10)),i.push(n.charAt(u>>4&63)),i.push(n.charAt(u<<2&63)),i.push("=")}return i.join("")},n=r,e.Base64=n,a.GetBytes=function(t){for(var e=[];4294967168&t;)e.push(127&t|128),t>>>=7;return e.push(127&t),e},n=a,e.Varint=n,s.GetBytes=function(t){for(var e=t.low,n=t.high,i=[];n||4294967168&e;)i.push(127&e|128),e=(127&n)<<25|e>>>7,n>>>=7;return i.push(127&e),i},n=s,e.Varint64=n,u.EncodeZigzag32=function(t){return(t=i.Number.ToInt32(t))<<1^t>>31},u.EncodeZigzag64=function(t){var e=t.low,n=t.high;t=n<<1|e>>>31,e<<=1;return 2147483648&n&&(t=~t,e=~e),(n=new i.UInt64("0")).low=e,n.high=t,n},n=u,e.Zigzag=n},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(0);o.prototype.WriteByte=function(t){this._buffer.push(i.Number.ToByte(t))},o.prototype.Write=function(t,e,n){for(;n--;)this.WriteByte(t[e++])},o.prototype.GetBuffer=function(){return this._buffer},n=o;function o(){this._buffer=[]}e.MemoryStream=n},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(6);e.BondDataType=i.BondDataType;var o=n(7);e.Encoding=o;var r=n(8);e.IO=r;var a=n(0);function s(t){this._stream=t}e.Int64=a.Int64,e.UInt64=a.UInt64,e.Number=a.Number,s.prototype.WriteBlob=function(t){this._stream.Write(t,0,t.length)},s.prototype.WriteContainerBegin=function(t,e){this.WriteUInt8(e),this.WriteUInt32(t)},s.prototype.WriteMapContainerBegin=function(t,e,n){this.WriteUInt8(e),this.WriteUInt8(n),this.WriteUInt32(t)},s.prototype.WriteFieldBegin=function(t,e){e<=5?this._stream.WriteByte(t|e<<5):e<=255?(this._stream.WriteByte(192|t),this._stream.WriteByte(e)):(this._stream.WriteByte(224|t),this._stream.WriteByte(e),this._stream.WriteByte(e>>8))},s.prototype.WriteInt32=function(t){t=o.Zigzag.EncodeZigzag32(t),this.WriteUInt32(t)},s.prototype.WriteInt64=function(t){this.WriteUInt64(o.Zigzag.EncodeZigzag64(t))},s.prototype.WriteString=function(t){""===t?this.WriteUInt32(0):(t=o.Utf8.GetBytes(t),this.WriteUInt32(t.length),this._stream.Write(t,0,t.length))},s.prototype.WriteStructEnd=function(t){this.WriteUInt8(t?i.BondDataType.BT_STOP_BASE:i.BondDataType.BT_STOP)},s.prototype.WriteUInt32=function(t){t=o.Varint.GetBytes(a.Number.ToUInt32(t)),this._stream.Write(t,0,t.length)},s.prototype.WriteUInt64=function(t){t=o.Varint64.GetBytes(t),this._stream.Write(t,0,t.length)},s.prototype.WriteUInt8=function(t){this._stream.WriteByte(a.Number.ToUInt8(t))},n=s,e.CompactBinaryProtocolWriter=n},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=(o.prototype.setKillSwitchTenants=function(t,e){var n=this;if(t&&e)try{var i=t.split(",");if("this-request-only"===e)return i;var o=1e3*parseInt(e,10);i.forEach((function(t){n._killedTokenDictionary[t]=Date.now()+o}))}catch(t){return[]}return[]},o.prototype.isTenantKilled=function(t){return void 0!==this._killedTokenDictionary[t]&&this._killedTokenDictionary[t]>Date.now()||(delete this._killedTokenDictionary[t],!1)},o);function o(){this._killedTokenDictionary={}}e.default=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(2);o.prototype.addEventToBatch=function(t){var e=i.default.getEventBlob(t);e.length>this._maxRequestSize||(this._currentBatchSize+e.length>this._maxRequestSize?this.flushBatch():(void 0===this._currentBatch[t.tenantToken]&&(this._currentBatch[t.tenantToken]=[]),this._currentBatch[t.tenantToken].push(e),this._currentBatchSize+=e.length))},o.prototype.flushBatch=function(){0<this._currentBatchSize&&(this._outboundQueue.push(this._currentBatch),this._currentBatch={},this._currentBatchSize=0)},n=o;function o(t,e){this._maxRequestSize=t,this._outboundQueue=e,this._currentBatch={},this._currentBatchSize=0}e.default=n},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=(o.shouldRetryForStatus=function(t){return!(300<=t&&t<500&&408!==t||501===t||505===t)},o.getMillisToBackoffForRetry=function(t){var e=Math.floor(1200*Math.random())+2400,n=Math.pow(4,t)*e;return Math.min(n,12e4)},o);function o(){}e.default=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(1),o=n(14),r=n(3),a=n(4),s=/^[a-zA-Z0-9]([a-zA-Z0-9]|_){2,98}[a-zA-Z0-9]$/,u=/\./g,l=/^[a-zA-Z0-9](([a-zA-Z0-9|_|\.]){0,98}[a-zA-Z0-9])?$/;c.initialize=function(t,e){if(void 0===e&&(e={}),this._isInitialized)throw"Already Initialized";this._defaultTenantToken=t,this._overrideValuesFromConfig(e),o.default.initialize(this._config),this._isInitialized=!0},c.flush=function(t){this._isInitialized&&!this._isDestroyed&&o.default.flush(t)},c.flushAndTeardown=function(){this._isInitialized&&!this._isDestroyed&&(this._isDestroyed=!0,o.default.flushAndTeardown())},c.setContext=function(t,e,n){void 0===n&&(n="allTkns"),null!==(e=this._sanitizeProperty(t,e))&&(this._contextProperties[n]||(this._contextProperties[n]={}),this._contextProperties[n][t]=e)},c.logEvent=function(t){var e,n=this;this._isInitialized&&t.name&&t.properties&&(t.name=t.name.toLowerCase(),t.name.replace(u,"_"),e="",t.type?(t.type.toLowerCase(),e="custom."):t.type="custom",s.test(t.name)&&s.test(t.type)&&(t.type=e+t.type,isNaN(t.timestamp)&&(t.timestamp=(new Date).getTime()),t.tenantToken||(t.tenantToken=this._defaultTenantToken),t.id=r.newGuid(),Object.keys(t.properties).forEach((function(e){t.properties[e]=n._sanitizeProperty(e,t.properties[e]),null===t.properties[e]&&delete t.properties[e]})),this._addContextIfAbsent(t,t.tenantToken),this._addContextIfAbsent(t,"allTkns"),0!==Object.keys(t.properties).length&&(this._setDefaultProperty(t,"EventInfo.InitId",this._getInitId(t.tenantToken)),this._setDefaultProperty(t,"EventInfo.Sequence",this._getSequenceId(t.tenantToken)),this._setDefaultProperty(t,"EventInfo.SdkVersion",a.FullVersionString),this._setDefaultProperty(t,"EventInfo.Name",t.name),this._setDefaultProperty(t,"EventInfo.Time",new Date(t.timestamp).toISOString()),o.default.sendEvent(t))))},c._overrideValuesFromConfig=function(t){t.collectorUrl&&(this._config.collectorUrl=t.collectorUrl),1e3<t.sendingTimer&&(this._config.sendingTimer=t.sendingTimer)},c._getInitId=function(t){return void 0===this._initIdMap[t]&&(this._initIdMap[t]=r.newGuid()),this._initIdMap[t]},c._getSequenceId=function(t){return void 0===this._sequenceIdMap[t]&&(this._sequenceIdMap[t]=0),(++this._sequenceIdMap[t]).toString()},c._setDefaultProperty=function(t,e,n){t.properties[e]={value:n,pii:i.AWTPiiKind.NotSet}},c._addContextIfAbsent=function(t,e){var n;this._contextProperties[e]&&(n=this._contextProperties[e],Object.keys(n).forEach((function(e){t.properties[e]||(t.properties[e]=n[e])})))},c._sanitizeProperty=function(t,e){return"string"!=typeof e&&"number"!=typeof e&&"boolean"!=typeof e||(e={value:e}),l.test(t)&&null!=e&&null!==e.value&&void 0!==e.value&&""!==e.value?(void 0===e.pii&&(e.pii=i.AWTPiiKind.NotSet),e.value=e.value.toString(),r.isPii(e.pii)?e:null):null},c._isInitialized=!1,c._isDestroyed=!1,c._contextProperties={},c._sequenceIdMap={},c._initIdMap={},c._config={collectorUrl:"https://browser.pipe.aria.microsoft.com/Collector/3.0/",sendingTimer:1e3},n=c;function c(){}e.default=n},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(11),o=n(2),r=n(12),a=n(10);n=n(4),s.initialize=function(t){this._inboundQueues.push([]),this._recordBatcher=new i.default(2936012,this._outboundQueue),this._newEventsAllowed=!0,"undefined"==typeof Uint8Array&&(this._urlString+="&content-encoding=base64"),this._sendingTimer=t.sendingTimer,this._urlString=t.collectorUrl+this._urlString+"&x-apikey="},s.sendEvent=function(t){var e=this;this._newEventsAllowed&&(this._inboundQueues[this._inboundQueues.length-1].push(t),!this._running&&this._timeout<0&&!this._isCurrentlyFlushing&&(this._timeout=setTimeout((function(){return e._batchAndSendEvents(!1)}),this._sendingTimer)))},s.flushAndTeardown=function(){this._newEventsAllowed=!1,this._batchAndSendEvents(!0)},s.flush=function(t){this._inboundQueues.push([]),this._isCurrentlyFlushing?this._flushQueue.push(t):(this._isCurrentlyFlushing=!0,this._flush(t))},s._batchAndSendEvents=function(t){for(this._running=!0;0<this._inboundQueues[0].length&&this._outboundQueue.length<1;)this._recordBatcher.addEventToBatch(this._inboundQueues[0].pop());0===this._outboundQueue.length&&this._recordBatcher.flushBatch(),this._sendRequest(this._outboundQueue.pop(),0,t)},s._retryRequestIfNeeded=function(t,e,n,i,o){var a=this,s=!0;t&&void 0!==t.status&&(this._killSwitch.setKillSwitchTenants(t.getResponseHeader("kill-tokens"),t.getResponseHeader("kill-duration-seconds")).forEach((function(t){delete e[t],n--})),(!r.default.shouldRetryForStatus(t.status)||n<=0)&&(s=!1)),s&&o<4?setTimeout((function(){return a._sendRequest(e,o+1,!1)}),r.default.getMillisToBackoffForRetry(o)):this._handleRequestFinished(null)},s._sendRequest=function(t,e,n){var i=this;try{var r,a=new XMLHttpRequest,s=0,u="";Object.keys(t).forEach((function(e){i._killSwitch.isTenantKilled(e)?delete t[e]:(0<u.length&&(u+=","),u+=e,s++)})),a.open("POST",this._urlString+u,!n),n||(a.ontimeout=function(){i._retryRequestIfNeeded(a,t,s,u,e)},a.onerror=function(){i._retryRequestIfNeeded(a,t,s,u,e)},a.onload=function(){i._handleRequestFinished(a)}),0<s?(r=o.default.getPayloadBlob(t,s),"undefined"==typeof Uint8Array?a.send(o.default.base64Encode(r)):a.send(new Uint8Array(r))):n&&this._handleRequestFinished(null)}catch(e){this._handleRequestFinished(null)}},s._handleRequestFinished=function(t){var e=this;t&&this._killSwitch.setKillSwitchTenants(t.getResponseHeader("kill-tokens"),t.getResponseHeader("kill-duration-seconds")),0<this._inboundQueues[0].length?this._timeout=setTimeout((function(){return e._batchAndSendEvents(!1)}),this._sendingTimer):(this._timeout=-1,this._running=!1)},s._flush=function(t){var e=this;this._running||(-1<this._timeout&&(clearTimeout(this._timeout),this._timeout=-1),0<this._inboundQueues[0].length&&this._batchAndSendEvents(!1)),this._checkPrimaryInboundQueueEmpty((function(){e._inboundQueues.shift(),null!=t&&t(),0<e._flushQueue.length?setTimeout((function(){return e._flush(e._flushQueue.shift())}),e._sendingTimer):(e._isCurrentlyFlushing=!1,0<e._inboundQueues[0].length&&(e._timeout=setTimeout((function(){return e._batchAndSendEvents(!1)}),e._sendingTimer)))}))},s._checkPrimaryInboundQueueEmpty=function(t){var e=this;0===this._inboundQueues[0].length?this._checkOutboundQueueEmptyAndSent(t):setTimeout((function(){return e._checkPrimaryInboundQueueEmpty(t)}),250)},s._checkOutboundQueueEmptyAndSent=function(t){var e=this;this._running?setTimeout((function(){return e._checkOutboundQueueEmptyAndSent(t)}),250):t()},s._outboundQueue=[],s._inboundQueues=[],s._newEventsAllowed=!1,s._killSwitch=new a.default,s._isCurrentlyFlushing=!1,s._flushQueue=[],s._running=!1,s._timeout=-1,s._urlString="?qsp=true&content-type=application%2Fbond-compact-binary&client-id=NO_AUTH&sdk-version="+n.FullVersionString,n=s;function s(){}e.default=n},function(t,e,n){t.exports=n(5)}],t.c=n,t.i=function(t){return t},t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:i})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},t.p="",t(t.s=15);function t(i){if(n[i])return n[i].exports;var o=n[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var e,n},"object"===r(a)&&"object"===r(n)?n.exports=s():(i=[],void 0===(o="function"==typeof(e=s)?e.apply(a,i):e)||(n.exports=o))},{}],113:[function(e,n,i){(function(t){var n=e("es6-promise").Promise;window.OfficeBrowserFeedback.html2canvas=function(){return function t(n,i,o){function r(s,u){if(!i[s]){if(!n[s]){var l="function"==typeof e&&e;if(!u&&l)return l(s,!0);if(a)return a(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var d=i[s]={exports:{}};n[s][0].call(d.exports,(function(t){var e=n[s][1][t];return r(e||t)}),d,d.exports,t,n,i,o)}return i[s].exports}for(var a="function"==typeof e&&e,s=0;s<o.length;s++)r(o[s]);return r}({1:[function(e,n,i){(function(t){!function(e){var o="object"==r(i)&&i,a="object"==r(n)&&n&&n.exports==o&&n,s="object"==r(t)&&t;s.global!==s&&s.window!==s||(e=s);var u,l,c=2147483647,d=36,p=/^xn--/,g=/[^ -~]/,f=/\x2E|\u3002|\uFF0E|\uFF61/g,h={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},m=Math.floor,v=String.fromCharCode;function y(t){throw RangeError(h[t])}function S(t,e){for(var n=t.length;n--;)t[n]=e(t[n]);return t}function b(t,e){return S(t.split(f),e).join(".")}function C(t){for(var e,n,i=[],o=0,r=t.length;o<r;)(e=t.charCodeAt(o++))>=55296&&e<=56319&&o<r?56320==(64512&(n=t.charCodeAt(o++)))?i.push(((1023&e)<<10)+(1023&n)+65536):(i.push(e),o--):i.push(e);return i}function T(t){return S(t,(function(t){var e="";return t>65535&&(e+=v((t-=65536)>>>10&1023|55296),t=56320|1023&t),e+=v(t)})).join("")}function w(t){return t-48<10?t-22:t-65<26?t-65:t-97<26?t-97:d}function I(t,e){return t+22+75*(t<26)-((0!=e)<<5)}function A(t,e,n){var i=0;for(t=n?m(t/700):t>>1,t+=m(t/e);t>455;i+=d)t=m(t/35);return m(i+36*t/(t+38))}function E(t){var e,n,i,o,r,a,s,u,l,p,g=[],f=t.length,h=0,v=128,S=72;for((n=t.lastIndexOf("-"))<0&&(n=0),i=0;i<n;++i)t.charCodeAt(i)>=128&&y("not-basic"),g.push(t.charCodeAt(i));for(o=n>0?n+1:0;o<f;){for(r=h,a=1,s=d;o>=f&&y("invalid-input"),((u=w(t.charCodeAt(o++)))>=d||u>m((c-h)/a))&&y("overflow"),h+=u*a,!(u<(l=s<=S?1:s>=S+26?26:s-S));s+=d)a>m(c/(p=d-l))&&y("overflow"),a*=p;S=A(h-r,e=g.length+1,0==r),m(h/e)>c-v&&y("overflow"),v+=m(h/e),h%=e,g.splice(h++,0,v)}return T(g)}function F(t){var e,n,i,o,r,a,s,u,l,p,g,f,h,S,b,T=[];for(f=(t=C(t)).length,e=128,n=0,r=72,a=0;a<f;++a)(g=t[a])<128&&T.push(v(g));for(i=o=T.length,o&&T.push("-");i<f;){for(s=c,a=0;a<f;++a)(g=t[a])>=e&&g<s&&(s=g);for(s-e>m((c-n)/(h=i+1))&&y("overflow"),n+=(s-e)*h,e=s,a=0;a<f;++a)if((g=t[a])<e&&++n>c&&y("overflow"),g==e){for(u=n,l=d;!(u<(p=l<=r?1:l>=r+26?26:l-r));l+=d)b=u-p,S=d-p,T.push(v(I(p+b%S,0))),u=m(b/S);T.push(v(I(u,0))),r=A(n,h,i==o),n=0,++i}++n,++e}return T.join("")}if(u={version:"1.2.4",ucs2:{decode:C,encode:T},decode:E,encode:F,toASCII:function(t){return b(t,(function(t){return g.test(t)?"xn--"+F(t):t}))},toUnicode:function(t){return b(t,(function(t){return p.test(t)?E(t.slice(4).toLowerCase()):t}))}},o&&!o.nodeType)if(a)a.exports=u;else for(l in u)u.hasOwnProperty(l)&&(o[l]=u[l]);else e.punycode=u}(this)}).call(this,void 0!==t?t:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(t,e,i){var o=t("./log");function r(t,e){try{e&&(e.width=t.width,e.height=t.height,e.getContext("2d").putImageData(t.getContext("2d").getImageData(0,0,t.width,t.height),0,0))}catch(e){o("Unable to copy canvas content from",t,e)}}function a(t,e){for(var n=3===t.nodeType?document.createTextNode(t.nodeValue):t.cloneNode(!1),i=t.firstChild;i;)!0!==e&&1===i.nodeType&&"SCRIPT"===i.nodeName||n.appendChild(a(i,e)),i=i.nextSibling;return 1===t.nodeType&&(n._scrollTop=t.scrollTop,n._scrollLeft=t.scrollLeft,"CANVAS"===t.nodeName?r(t,n):"TEXTAREA"!==t.nodeName&&"SELECT"!==t.nodeName||(n.value=t.value)),n}function s(t){if(1===t.nodeType){t.scrollTop=t._scrollTop,t.scrollLeft=t._scrollLeft;for(var e=t.firstChild;e;)s(e),e=e.nextSibling}}e.exports=function(t,e,i,o,r,u,l){var c=a(t.documentElement,r.javascriptEnabled),d=e.createElement("iframe");return d.className="html2canvas-container",d.style.visibility="hidden",d.style.position="fixed",d.style.left="-10000px",d.style.top="0px",d.style.border="0",d.width=i,d.height=o,d.scrolling="no",e.body.appendChild(d),new n((function(e){var n=d.contentWindow.document;d.contentWindow.onload=d.onload=function(){var t=setInterval((function(){n.body.childNodes.length>0&&(s(n.documentElement),clearInterval(t),"view"===r.type&&(d.contentWindow.scrollTo(u,l),!/(iPad|iPhone|iPod)/g.test(navigator.userAgent)||d.contentWindow.scrollY===l&&d.contentWindow.scrollX===u||(n.documentElement.style.top=-l+"px",n.documentElement.style.left=-u+"px",n.documentElement.style.position="absolute")),e(d))}),50)},n.open(),n.write("<!DOCTYPE html><html></html>"),function(t,e,n){!t.defaultView||e===t.defaultView.pageXOffset&&n===t.defaultView.pageYOffset||t.defaultView.scrollTo(e,n)}(t,u,l),n.replaceChild(n.adoptNode(c),n.documentElement),n.close()}))}},{"./log":13}],3:[function(t,e,n){function i(t){this.r=0,this.g=0,this.b=0,this.a=null;this.fromArray(t)||this.namedColor(t)||this.rgb(t)||this.rgba(t)||this.hex6(t)||this.hex3(t)}i.prototype.darken=function(t){var e=1-t;return new i([Math.round(this.r*e),Math.round(this.g*e),Math.round(this.b*e),this.a])},i.prototype.isTransparent=function(){return 0===this.a},i.prototype.isBlack=function(){return 0===this.r&&0===this.g&&0===this.b},i.prototype.fromArray=function(t){return Array.isArray(t)&&(this.r=Math.min(t[0],255),this.g=Math.min(t[1],255),this.b=Math.min(t[2],255),t.length>3&&(this.a=t[3])),Array.isArray(t)};var o=/^#([a-f0-9]{3})$/i;i.prototype.hex3=function(t){var e;return null!==(e=t.match(o))&&(this.r=parseInt(e[1][0]+e[1][0],16),this.g=parseInt(e[1][1]+e[1][1],16),this.b=parseInt(e[1][2]+e[1][2],16)),null!==e};var r=/^#([a-f0-9]{6})$/i;i.prototype.hex6=function(t){var e=null;return null!==(e=t.match(r))&&(this.r=parseInt(e[1].substring(0,2),16),this.g=parseInt(e[1].substring(2,4),16),this.b=parseInt(e[1].substring(4,6),16)),null!==e};var a=/^rgb\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*\)$/;i.prototype.rgb=function(t){var e;return null!==(e=t.match(a))&&(this.r=Number(e[1]),this.g=Number(e[2]),this.b=Number(e[3])),null!==e};var s=/^rgba\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d?\.?\d+)\s*\)$/;i.prototype.rgba=function(t){var e;return null!==(e=t.match(s))&&(this.r=Number(e[1]),this.g=Number(e[2]),this.b=Number(e[3]),this.a=Number(e[4])),null!==e},i.prototype.toString=function(){return null!==this.a&&1!==this.a?"rgba("+[this.r,this.g,this.b,this.a].join(",")+")":"rgb("+[this.r,this.g,this.b].join(",")+")"},i.prototype.namedColor=function(t){t=t.toLowerCase();var e=u[t];if(e)this.r=e[0],this.g=e[1],this.b=e[2];else if("transparent"===t)return this.r=this.g=this.b=this.a=0,!0;return!!e},i.prototype.isColor=!0;var u={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};e.exports=i},{}],4:[function(t,e,i){var o=t("./support"),r=t("./renderers/canvas"),a=t("./imageloader"),s=t("./nodeparser"),u=t("./nodecontainer"),l=t("./log"),c=t("./utils"),d=t("./clone"),p=t("./proxy").loadUrlDocument,g=c.getBounds,f="data-html2canvas-node",h=0;function m(t,e){var i=h++;if((e=e||{}).logging&&(l.options.logging=!0,l.options.start=Date.now()),e.async=void 0===e.async||e.async,e.allowTaint=void 0!==e.allowTaint&&e.allowTaint,e.removeContainer=void 0===e.removeContainer||e.removeContainer,e.javascriptEnabled=void 0!==e.javascriptEnabled&&e.javascriptEnabled,e.imageTimeout=void 0===e.imageTimeout?1e4:e.imageTimeout,e.renderer="function"==typeof e.renderer?e.renderer:r,e.strict=!!e.strict,"string"==typeof t){if("string"!=typeof e.proxy)return n.reject("Proxy must be used when rendering url");var o=null!=e.width?e.width:window.innerWidth,a=null!=e.height?e.height:window.innerHeight;return p(function(t){var e=document.createElement("a");return e.href=t,e.href=e.href,e}(t),e.proxy,document,o,a,e).then((function(t){return S(t.contentWindow.document.documentElement,t,e,o,a)}))}var s=(void 0===t?[document.documentElement]:t.length?t:[t])[0];return s.setAttribute(f+i,i),y(s.ownerDocument,e,s.ownerDocument.defaultView.innerWidth,s.ownerDocument.defaultView.innerHeight,i).then((function(t){return"function"==typeof e.onrendered&&(l("options.onrendered is deprecated, html2canvas returns a Promise containing the canvas"),e.onrendered(t)),t}))}m.CanvasRenderer=r,m.NodeContainer=u,m.log=l,m.utils=c;var v="undefined"==typeof document||"function"!=typeof Object.create||"function"!=typeof document.createElement("canvas").getContext?function(){return n.reject("No canvas support")}:m;function y(t,e,i,o,r){return d(t,t,i,o,e,t.defaultView.pageXOffset,t.defaultView.pageYOffset).then((function(a){l("Document cloned");var s=f+r,u="["+s+"='"+r+"']";t.querySelector(u).removeAttribute(s);var c=a.contentWindow,d=c.document.querySelector(u);return("function"==typeof e.onclone?n.resolve(e.onclone(c.document)):n.resolve(!0)).then((function(){return S(d,a,e,i,o)}))}))}function S(t,e,n,i,r){var u=e.contentWindow,c=new o(u.document),d=new a(n,c),p=g(t),f="view"===n.type?i:function(t){return Math.max(Math.max(t.body.scrollWidth,t.documentElement.scrollWidth),Math.max(t.body.offsetWidth,t.documentElement.offsetWidth),Math.max(t.body.clientWidth,t.documentElement.clientWidth))}(u.document),h="view"===n.type?r:function(t){return Math.max(Math.max(t.body.scrollHeight,t.documentElement.scrollHeight),Math.max(t.body.offsetHeight,t.documentElement.offsetHeight),Math.max(t.body.clientHeight,t.documentElement.clientHeight))}(u.document),m=new n.renderer(f,h,d,n,document);return new s(t,m,c,d,n).ready.then((function(){var i;return l("Finished rendering"),i="view"===n.type?b(m.canvas,{width:m.canvas.width,height:m.canvas.height,top:0,left:0,x:0,y:0}):t===u.document.body||t===u.document.documentElement||null!=n.canvas?m.canvas:b(m.canvas,{width:null!=n.width?n.width:p.width,height:null!=n.height?n.height:p.height,top:p.top,left:p.left,x:0,y:0}),function(t,e){e.removeContainer&&(t.parentNode.removeChild(t),l("Cleaned up container"))}(e,n),i}))}function b(t,e){var n=document.createElement("canvas"),i=Math.min(t.width-1,Math.max(0,e.left)),o=Math.min(t.width,Math.max(1,e.left+e.width)),r=Math.min(t.height-1,Math.max(0,e.top)),a=Math.min(t.height,Math.max(1,e.top+e.height));n.width=e.width,n.height=e.height;var s=o-i,u=a-r;return l("Cropping canvas at:","left:",e.left,"top:",e.top,"width:",s,"height:",u),l("Resulting crop with width",e.width,"and height",e.height,"with x",i,"and y",r),n.getContext("2d").drawImage(t,i,r,s,u,e.x,e.y,s,u),n}e.exports=v},{"./clone":2,"./imageloader":11,"./log":13,"./nodecontainer":14,"./nodeparser":15,"./proxy":16,"./renderers/canvas":20,"./support":22,"./utils":26}],5:[function(t,e,i){var o=t("./log"),r=t("./utils").smallImage;e.exports=function t(e){if(this.src=e,o("DummyImageContainer for",e),!this.promise||!this.image){o("Initiating DummyImageContainer"),t.prototype.image=new Image;var i=this.image;t.prototype.promise=new n((function(t,e){i.onload=t,i.onerror=e,i.src=r(),!0===i.complete&&t(i)}))}}},{"./log":13,"./utils":26}],6:[function(t,e,n){var i=t("./utils").smallImage;e.exports=function(t,e){var n,o,r=document.createElement("div"),a=document.createElement("img"),s=document.createElement("span"),u="Hidden Text";r.style.visibility="hidden",r.style.fontFamily=t,r.style.fontSize=e,r.style.margin=0,r.style.padding=0,document.body.appendChild(r),a.src=i(),a.width=1,a.height=1,a.style.margin=0,a.style.padding=0,a.style.verticalAlign="baseline",s.style.fontFamily=t,s.style.fontSize=e,s.style.margin=0,s.style.padding=0,s.appendChild(document.createTextNode(u)),r.appendChild(s),r.appendChild(a),n=a.offsetTop-s.offsetTop+1,r.removeChild(s),r.appendChild(document.createTextNode(u)),r.style.lineHeight="normal",a.style.verticalAlign="super",o=a.offsetTop-r.offsetTop+1,document.body.removeChild(r),this.baseline=n,this.lineWidth=1,this.middle=o}},{"./utils":26}],7:[function(t,e,n){var i=t("./font");function o(){this.data={}}o.prototype.getMetrics=function(t,e){return void 0===this.data[t+"-"+e]&&(this.data[t+"-"+e]=new i(t,e)),this.data[t+"-"+e]},e.exports=o},{"./font":6}],8:[function(t,e,i){var o=t("./utils").getBounds,r=t("./proxy").loadUrlDocument;function a(e,i,r){this.image=null,this.src=e;var a=this,s=o(e);this.promise=(i?new n((function(t){"about:blank"===e.contentWindow.document.URL||null==e.contentWindow.document.documentElement?e.contentWindow.onload=e.onload=function(){t(e)}:t(e)})):this.proxyLoad(r.proxy,s,r)).then((function(e){return t("./core")(e.contentWindow.document.documentElement,{type:"view",width:e.width,height:e.height,proxy:r.proxy,javascriptEnabled:r.javascriptEnabled,removeContainer:r.removeContainer,allowTaint:r.allowTaint,imageTimeout:r.imageTimeout/2})})).then((function(t){return a.image=t}))}a.prototype.proxyLoad=function(t,e,n){var i=this.src;return r(i.src,t,i.ownerDocument,e.width,e.height,n)},e.exports=a},{"./core":4,"./proxy":16,"./utils":26}],9:[function(t,e,i){function o(t){this.src=t.value,this.colorStops=[],this.type=null,this.x0=.5,this.y0=.5,this.x1=.5,this.y1=.5,this.promise=n.resolve(!0)}o.TYPES={LINEAR:1,RADIAL:2},o.REGEXP_COLORSTOP=/^\s*(rgba?\(\s*\d{1,3},\s*\d{1,3},\s*\d{1,3}(?:,\s*[0-9\.]+)?\s*\)|[a-z]{3,20}|#[a-f0-9]{3,6})(?:\s+(\d{1,3}(?:\.\d+)?)(%|px)?)?(?:\s|$)/i,e.exports=o},{}],10:[function(t,e,i){e.exports=function(t,e){this.src=t,this.image=new Image;var i=this;this.tainted=null,this.promise=new n((function(n,o){i.image.onload=n,i.image.onerror=o,e&&(i.image.crossOrigin="anonymous"),i.image.src=t,!0===i.image.complete&&n(i.image)}))}},{}],11:[function(t,e,i){var o=t("./log"),r=t("./imagecontainer"),a=t("./dummyimagecontainer"),s=t("./proxyimagecontainer"),u=t("./framecontainer"),l=t("./svgcontainer"),c=t("./svgnodecontainer"),d=t("./lineargradientcontainer"),p=t("./webkitgradientcontainer"),g=t("./utils").bind;function f(t,e){this.link=null,this.options=t,this.support=e,this.origin=this.getOrigin(window.location.href)}f.prototype.findImages=function(t){var e=[];return t.reduce((function(t,e){switch(e.node.nodeName){case"IMG":return t.concat([{args:[e.node.src],method:"url"}]);case"svg":case"IFRAME":return t.concat([{args:[e.node],method:e.node.nodeName}])}return t}),[]).forEach(this.addImage(e,this.loadImage),this),e},f.prototype.findBackgroundImage=function(t,e){return e.parseBackgroundImages().filter(this.hasImageBackground).forEach(this.addImage(t,this.loadImage),this),t},f.prototype.addImage=function(t,e){return function(n){n.args.forEach((function(i){this.imageExists(t,i)||(t.splice(0,0,e.call(this,n)),o("Added image #"+t.length,"string"==typeof i?i.substring(0,100):i))}),this)}},f.prototype.hasImageBackground=function(t){return"none"!==t.method},f.prototype.loadImage=function(t){if("url"===t.method){var e=t.args[0];return!this.isSVG(e)||this.support.svg||this.options.allowTaint?e.match(/data:image\/.*;base64,/i)?new r(e.replace(/url\(['"]{0,}|['"]{0,}\)$/gi,""),!1):this.isSameOrigin(e)||!0===this.options.allowTaint||this.isSVG(e)?new r(e,!1):this.support.cors&&!this.options.allowTaint&&this.options.useCORS?new r(e,!0):this.options.proxy?new s(e,this.options.proxy):new a(e):new l(e)}return"linear-gradient"===t.method?new d(t):"gradient"===t.method?new p(t):"svg"===t.method?new c(t.args[0],this.support.svg):"IFRAME"===t.method?new u(t.args[0],this.isSameOrigin(t.args[0].src),this.options):new a(t)},f.prototype.isSVG=function(t){return"svg"===t.substring(t.length-3).toLowerCase()||l.prototype.isInline(t)},f.prototype.imageExists=function(t,e){return t.some((function(t){return t.src===e}))},f.prototype.isSameOrigin=function(t){return this.getOrigin(t)===this.origin},f.prototype.getOrigin=function(t){var e=this.link||(this.link=document.createElement("a"));return e.href=t,e.href=e.href,e.protocol+e.hostname+e.port},f.prototype.getPromise=function(t){return this.timeout(t,this.options.imageTimeout).catch((function(){return new a(t.src).promise.then((function(e){t.image=e}))}))},f.prototype.get=function(t){var e=null;return this.images.some((function(n){return(e=n).src===t}))?e:null},f.prototype.fetch=function(t){return this.images=t.reduce(g(this.findBackgroundImage,this),this.findImages(t)),this.images.forEach((function(t,e){t.promise.then((function(){o("Succesfully loaded image #"+(e+1),t)}),(function(n){o("Failed loading image #"+(e+1),t,n)}))})),this.ready=n.all(this.images.map(this.getPromise,this)),o("Finished searching images"),this},f.prototype.timeout=function(t,e){var i,r=n.race([t.promise,new n((function(n,r){i=setTimeout((function(){o("Timed out loading image",t),r(t)}),e)}))]).then((function(t){return clearTimeout(i),t}));return r.catch((function(){clearTimeout(i)})),r},e.exports=f},{"./dummyimagecontainer":5,"./framecontainer":8,"./imagecontainer":10,"./lineargradientcontainer":12,"./log":13,"./proxyimagecontainer":17,"./svgcontainer":23,"./svgnodecontainer":24,"./utils":26,"./webkitgradientcontainer":27}],12:[function(t,e,n){var i=t("./gradientcontainer"),o=t("./color");function r(t){i.apply(this,arguments),this.type=i.TYPES.LINEAR;var e=r.REGEXP_DIRECTION.test(t.args[0])||!i.REGEXP_COLORSTOP.test(t.args[0]);e?t.args[0].split(/\s+/).reverse().forEach((function(t,e){switch(t){case"left":this.x0=0,this.x1=1;break;case"top":this.y0=0,this.y1=1;break;case"right":this.x0=1,this.x1=0;break;case"bottom":this.y0=1,this.y1=0;break;case"to":var n=this.y0,i=this.x0;this.y0=this.y1,this.x0=this.x1,this.x1=i,this.y1=n;break;case"center":break;default:var o=.01*parseFloat(t,10);if(isNaN(o))break;0===e?(this.y0=o,this.y1=1-this.y0):(this.x0=o,this.x1=1-this.x0)}}),this):(this.y0=0,this.y1=1),this.colorStops=t.args.slice(e?1:0).map((function(t){var e=t.match(i.REGEXP_COLORSTOP),n=+e[2],r=0===n?"%":e[3];return{color:new o(e[1]),stop:"%"===r?n/100:null}})),null===this.colorStops[0].stop&&(this.colorStops[0].stop=0),null===this.colorStops[this.colorStops.length-1].stop&&(this.colorStops[this.colorStops.length-1].stop=1),this.colorStops.forEach((function(t,e){null===t.stop&&this.colorStops.slice(e).some((function(n,i){return null!==n.stop&&(t.stop=(n.stop-this.colorStops[e-1].stop)/(i+1)+this.colorStops[e-1].stop,!0)}),this)}),this)}r.prototype=Object.create(i.prototype),r.REGEXP_DIRECTION=/^\s*(?:to|left|right|top|bottom|center|\d{1,3}(?:\.\d+)?%?)(?:\s|$)/i,e.exports=r},{"./color":3,"./gradientcontainer":9}],13:[function(t,e,n){var i=function t(){t.options.logging&&window.console&&window.console.log&&Function.prototype.bind.call(window.console.log,window.console).apply(window.console,[Date.now()-t.options.start+"ms","html2canvas:"].concat([].slice.call(arguments,0)))};i.options={logging:!1},e.exports=i},{}],14:[function(t,e,n){var i=t("./color"),o=t("./utils"),r=o.getBounds,a=o.parseBackgrounds,s=o.offsetBounds;function u(t,e){this.node=t,this.parent=e,this.stack=null,this.bounds=null,this.borders=null,this.clip=[],this.backgroundClip=[],this.offsetBounds=null,this.visible=null,this.computedStyles=null,this.colors={},this.styles={},this.backgroundImages=null,this.transformData=null,this.transformMatrix=null,this.isPseudoElement=!1,this.opacity=null}function l(t){return-1!==t.toString().indexOf("%")}function c(t){return t.replace("px","")}function d(t){return parseFloat(t)}u.prototype.cloneTo=function(t){t.visible=this.visible,t.borders=this.borders,t.bounds=this.bounds,t.clip=this.clip,t.backgroundClip=this.backgroundClip,t.computedStyles=this.computedStyles,t.styles=this.styles,t.backgroundImages=this.backgroundImages,t.opacity=this.opacity},u.prototype.getOpacity=function(){return null===this.opacity?this.opacity=this.cssFloat("opacity"):this.opacity},u.prototype.assignStack=function(t){this.stack=t,t.children.push(this)},u.prototype.isElementVisible=function(){return this.node.nodeType===Node.TEXT_NODE?this.parent.visible:"none"!==this.css("display")&&"hidden"!==this.css("visibility")&&!this.node.hasAttribute("data-html2canvas-ignore")&&("INPUT"!==this.node.nodeName||"hidden"!==this.node.getAttribute("type"))},u.prototype.css=function(t){return this.computedStyles||(this.computedStyles=this.isPseudoElement?this.parent.computedStyle(this.before?":before":":after"):this.computedStyle(null)),this.styles[t]||(this.styles[t]=this.computedStyles[t])},u.prototype.prefixedCss=function(t){var e=this.css(t);return void 0===e&&["webkit","moz","ms","o"].some((function(n){return void 0!==(e=this.css(n+t.substr(0,1).toUpperCase()+t.substr(1)))}),this),void 0===e?null:e},u.prototype.computedStyle=function(t){return this.node.ownerDocument.defaultView.getComputedStyle(this.node,t)},u.prototype.cssInt=function(t){var e=parseInt(this.css(t),10);return isNaN(e)?0:e},u.prototype.color=function(t){return this.colors[t]||(this.colors[t]=new i(this.css(t)))},u.prototype.cssFloat=function(t){var e=parseFloat(this.css(t));return isNaN(e)?0:e},u.prototype.fontWeight=function(){var t=this.css("fontWeight");switch(parseInt(t,10)){case 401:t="bold";break;case 400:t="normal"}return t},u.prototype.parseClip=function(){var t=this.css("clip").match(this.CLIP);return t?{top:parseInt(t[1],10),right:parseInt(t[2],10),bottom:parseInt(t[3],10),left:parseInt(t[4],10)}:null},u.prototype.parseBackgroundImages=function(){return this.backgroundImages||(this.backgroundImages=a(this.css("backgroundImage")))},u.prototype.cssList=function(t,e){var n=(this.css(t)||"").split(",");return 1===(n=(n=n[e||0]||n[0]||"auto").trim().split(" ")).length&&(n=[n[0],l(n[0])?"auto":n[0]]),n},u.prototype.parseBackgroundSize=function(t,e,n){var i,o,r=this.cssList("backgroundSize",n);if(l(r[0]))i=t.width*parseFloat(r[0])/100;else{if(/contain|cover/.test(r[0])){var a=t.width/t.height,s=e.width/e.height;return a<s^"contain"===r[0]?{width:t.height*s,height:t.height}:{width:t.width,height:t.width/s}}i=parseInt(r[0],10)}return o="auto"===r[0]&&"auto"===r[1]?e.height:"auto"===r[1]?i/e.width*e.height:l(r[1])?t.height*parseFloat(r[1])/100:parseInt(r[1],10),"auto"===r[0]&&(i=o/e.height*e.width),{width:i,height:o}},u.prototype.parseBackgroundPosition=function(t,e,n,i){var o,r,a=this.cssList("backgroundPosition",n);return o=l(a[0])?(t.width-(i||e).width)*(parseFloat(a[0])/100):parseInt(a[0],10),r="auto"===a[1]?o/e.width*e.height:l(a[1])?(t.height-(i||e).height)*parseFloat(a[1])/100:parseInt(a[1],10),"auto"===a[0]&&(o=r/e.height*e.width),{left:o,top:r}},u.prototype.parseBackgroundRepeat=function(t){return this.cssList("backgroundRepeat",t)[0]},u.prototype.parseTextShadows=function(){var t=this.css("textShadow"),e=[];if(t&&"none"!==t)for(var n=t.match(this.TEXT_SHADOW_PROPERTY),o=0;n&&o<n.length;o++){var r=n[o].match(this.TEXT_SHADOW_VALUES);e.push({color:new i(r[0]),offsetX:r[1]?parseFloat(r[1].replace("px","")):0,offsetY:r[2]?parseFloat(r[2].replace("px","")):0,blur:r[3]?r[3].replace("px",""):0})}return e},u.prototype.parseTransform=function(){if(!this.transformData)if(this.hasTransform()){var t=this.parseBounds(),e=this.prefixedCss("transformOrigin").split(" ").map(c).map(d);e[0]+=t.left,e[1]+=t.top,this.transformData={origin:e,matrix:this.parseTransformMatrix()}}else this.transformData={origin:[0,0],matrix:[1,0,0,1,0,0]};return this.transformData},u.prototype.parseTransformMatrix=function(){if(!this.transformMatrix){var t=this.prefixedCss("transform"),e=t?function(t){if(t&&"matrix"===t[1])return t[2].split(",").map((function(t){return parseFloat(t.trim())}));if(t&&"matrix3d"===t[1]){var e=t[2].split(",").map((function(t){return parseFloat(t.trim())}));return[e[0],e[1],e[4],e[5],e[12],e[13]]}}(t.match(this.MATRIX_PROPERTY)):null;this.transformMatrix=e||[1,0,0,1,0,0]}return this.transformMatrix},u.prototype.parseBounds=function(){return this.bounds||(this.bounds=this.hasTransform()?s(this.node):r(this.node))},u.prototype.hasTransform=function(){return"1,0,0,1,0,0"!==this.parseTransformMatrix().join(",")||this.parent&&this.parent.hasTransform()},u.prototype.getValue=function(){var t=this.node.value||"";return"SELECT"===this.node.tagName?t=function(t){var e=t.options[t.selectedIndex||0];return e&&e.text||""}(this.node):"password"===this.node.type&&(t=Array(t.length+1).join("•")),0===t.length?this.node.placeholder||"":t},u.prototype.MATRIX_PROPERTY=/(matrix|matrix3d)\((.+)\)/,u.prototype.TEXT_SHADOW_PROPERTY=/((rgba|rgb)\([^\)]+\)(\s-?\d+px){0,})/g,u.prototype.TEXT_SHADOW_VALUES=/(-?\d+px)|(#.+)|(rgb\(.+\))|(rgba\(.+\))/g,u.prototype.CLIP=/^rect\((\d+)px,? (\d+)px,? (\d+)px,? (\d+)px\)$/,e.exports=u},{"./color":3,"./utils":26}],15:[function(t,e,i){var o=t("./log"),r=t("punycode"),a=t("./nodecontainer"),s=t("./textcontainer"),u=t("./pseudoelementcontainer"),l=t("./fontmetrics"),c=t("./color"),d=t("./stackingcontext"),p=t("./utils"),g=p.bind,f=p.getBounds,h=p.parseBackgrounds,m=p.offsetBounds;function v(t,e,i,r,s){o("Starting NodeParser"),this.renderer=e,this.options=s,this.range=null,this.support=i,this.renderQueue=[],this.stack=new d(!0,1,t.ownerDocument,null);var u=new a(t,null);if(s.background&&e.rectangle(0,0,e.width,e.height,new c(s.background)),t===t.ownerDocument.documentElement){var p=new a(u.color("backgroundColor").isTransparent()?t.ownerDocument.body:t.ownerDocument.documentElement,null);e.rectangle(0,0,e.width,e.height,p.color("backgroundColor"))}u.visibile=u.isElementVisible(),this.createPseudoHideStyles(t.ownerDocument),this.disableAnimations(t.ownerDocument),this.nodes=W([u].concat(this.getChildren(u)).filter((function(t){return t.visible=t.isElementVisible()})).map(this.getPseudoElements,this)),this.fontMetrics=new l,o("Fetched nodes, total:",this.nodes.length),o("Calculate overflow clips"),this.calculateOverflowClips(),o("Start fetching images"),this.images=r.fetch(this.nodes.filter(M)),this.ready=this.images.ready.then(g((function(){return o("Images loaded, starting parsing"),o("Creating stacking contexts"),this.createStackingContexts(),o("Sorting stacking contexts"),this.sortStackingContexts(this.stack),this.parse(this.stack),o("Render queue created with "+this.renderQueue.length+" items"),new n(g((function(t){s.async?"function"==typeof s.async?s.async.call(this,this.renderQueue,t):this.renderQueue.length>0?(this.renderIndex=0,this.asyncRenderer(this.renderQueue,t)):t():(this.renderQueue.forEach(this.paint,this),t())}),this))}),this))}function y(t){return t.parent&&t.parent.clip.length}function S(t){return t.replace(/(\-[a-z])/g,(function(t){return t.toUpperCase().replace("-","")}))}function b(){}v.prototype.calculateOverflowClips=function(){this.nodes.forEach((function(t){if(M(t)){R(t)&&t.appendToDOM(),t.borders=this.parseBorders(t);var e="hidden"===t.css("overflow")?[t.borders.clip]:[],n=t.parseClip();n&&-1!==["absolute","fixed"].indexOf(t.css("position"))&&e.push([["rect",t.bounds.left+n.left,t.bounds.top+n.top,n.right-n.left,n.bottom-n.top]]),t.clip=y(t)?t.parent.clip.concat(e):e,t.backgroundClip="hidden"!==t.css("overflow")?t.clip.concat([t.borders.clip]):t.clip,R(t)&&t.cleanDOM()}else V(t)&&(t.clip=y(t)?t.parent.clip:[]);R(t)||(t.bounds=null)}),this)},v.prototype.asyncRenderer=function(t,e,n){n=n||Date.now(),this.paint(t[this.renderIndex++]),t.length===this.renderIndex?e():n+20>Date.now()?this.asyncRenderer(t,e,n):setTimeout(g((function(){this.asyncRenderer(t,e)}),this),0)},v.prototype.createPseudoHideStyles=function(t){this.createStyles(t,"."+u.prototype.PSEUDO_HIDE_ELEMENT_CLASS_BEFORE+':before { content: "" !important; display: none !important; }.'+u.prototype.PSEUDO_HIDE_ELEMENT_CLASS_AFTER+':after { content: "" !important; display: none !important; }')},v.prototype.disableAnimations=function(t){this.createStyles(t,"* { -webkit-animation: none !important; -moz-animation: none !important; -o-animation: none !important; animation: none !important; -webkit-transition: none !important; -moz-transition: none !important; -o-transition: none !important; transition: none !important;}")},v.prototype.createStyles=function(t,e){var n=t.createElement("style");n.innerHTML=e,t.body.appendChild(n)},v.prototype.getPseudoElements=function(t){var e=[[t]];if(t.node.nodeType===Node.ELEMENT_NODE){var n=this.getPseudoElement(t,":before"),i=this.getPseudoElement(t,":after");n&&e.push(n),i&&e.push(i)}return W(e)},v.prototype.getPseudoElement=function(t,e){var n=t.computedStyle(e);if(!n||!n.content||"none"===n.content||"-moz-alt-content"===n.content||"none"===n.display)return null;for(var i=function(t){var e=t.substr(0,1);return e===t.substr(t.length-1)&&e.match(/'|"/)?t.substr(1,t.length-2):t}(n.content),o="url"===i.substr(0,3),r=document.createElement(o?"img":"html2canvaspseudoelement"),a=new u(r,t,e),l=n.length-1;l>=0;l--){var c=S(n.item(l));r.style[c]=n[c]}if(r.className=u.prototype.PSEUDO_HIDE_ELEMENT_CLASS_BEFORE+" "+u.prototype.PSEUDO_HIDE_ELEMENT_CLASS_AFTER,o)return r.src=h(i)[0].args[0],[a];var d=document.createTextNode(i);return r.appendChild(d),[a,new s(d,a)]},v.prototype.getChildren=function(t){return W([].filter.call(t.node.childNodes,L).map((function(e){var n=[e.nodeType===Node.TEXT_NODE?new s(e,t):new a(e,t)].filter(z);return e.nodeType===Node.ELEMENT_NODE&&n.length&&"TEXTAREA"!==e.tagName?n[0].isElementVisible()?n.concat(this.getChildren(n[0])):[]:n}),this))},v.prototype.newStackingContext=function(t,e){var n=new d(e,t.getOpacity(),t.node,t.parent);t.cloneTo(n),(e?n.getParentStack(this):n.parent.stack).contexts.push(n),t.stack=n},v.prototype.createStackingContexts=function(){this.nodes.forEach((function(t){M(t)&&(this.isRootElement(t)||function(t){return t.getOpacity()<1}(t)||function(t){var e=t.css("position");return"auto"!==(-1!==["absolute","relative","fixed"].indexOf(e)?t.css("zIndex"):"auto")}(t)||this.isBodyWithTransparentRoot(t)||t.hasTransform())?this.newStackingContext(t,!0):M(t)&&(U(t)&&N(t)||function(t){return-1!==["inline-block","inline-table"].indexOf(t.css("display"))}(t)||k(t))?this.newStackingContext(t,!1):t.assignStack(t.parent.stack)}),this)},v.prototype.isBodyWithTransparentRoot=function(t){return"BODY"===t.node.nodeName&&t.parent.color("backgroundColor").isTransparent()},v.prototype.isRootElement=function(t){return null===t.parent},v.prototype.sortStackingContexts=function(t){t.contexts.sort(function(t){return function(e,n){return e.cssInt("zIndex")+t.indexOf(e)/t.length-(n.cssInt("zIndex")+t.indexOf(n)/t.length)}}(t.contexts.slice(0))),t.contexts.forEach(this.sortStackingContexts,this)},v.prototype.parseTextBounds=function(t){return function(e,n,i){if("none"!==t.parent.css("textDecoration").substr(0,4)||0!==e.trim().length){if(this.support.rangeBounds&&!t.parent.hasTransform()){var o=i.slice(0,n).join("").length;return this.getRangeBounds(t.node,o,e.length)}if(t.node&&"string"==typeof t.node.data){var r=t.node.splitText(e.length),a=this.getWrapperBounds(t.node,t.parent.hasTransform());return t.node=r,a}}else this.support.rangeBounds&&!t.parent.hasTransform()||(t.node=t.node.splitText(e.length));return{}}},v.prototype.getWrapperBounds=function(t,e){var n=t.ownerDocument.createElement("html2canvaswrapper"),i=t.parentNode,o=t.cloneNode(!0);n.appendChild(t.cloneNode(!0)),i.replaceChild(n,t);var r=e?m(n):f(n);return i.replaceChild(o,n),r},v.prototype.getRangeBounds=function(t,e,n){var i=this.range||(this.range=t.ownerDocument.createRange());return i.setStart(t,e),i.setEnd(t,e+n),i.getBoundingClientRect()},v.prototype.parse=function(t){var e=t.contexts.filter(_),n=t.children.filter(M),i=n.filter(B(k)),o=i.filter(B(U)).filter(B(D)),r=n.filter(B(U)).filter(k),a=i.filter(B(U)).filter(D),s=t.contexts.concat(i.filter(U)).filter(N),u=t.children.filter(V).filter(P),l=t.contexts.filter(O);e.concat(o).concat(r).concat(a).concat(s).concat(u).concat(l).forEach((function(t){this.renderQueue.push(t),x(t)&&(this.parse(t),this.renderQueue.push(new b))}),this)},v.prototype.paint=function(t){try{t instanceof b?this.renderer.ctx.restore():V(t)?(R(t.parent)&&t.parent.appendToDOM(),this.paintText(t),R(t.parent)&&t.parent.cleanDOM()):this.paintNode(t)}catch(t){if(o(t),this.options.strict)throw t}},v.prototype.paintNode=function(t){x(t)&&(this.renderer.setOpacity(t.opacity),this.renderer.ctx.save(),t.hasTransform()&&this.renderer.setTransform(t.parseTransform())),"INPUT"===t.node.nodeName&&"checkbox"===t.node.type?this.paintCheckbox(t):"INPUT"===t.node.nodeName&&"radio"===t.node.type?this.paintRadio(t):this.paintElement(t)},v.prototype.paintElement=function(t){var e=t.parseBounds();this.renderer.clip(t.backgroundClip,(function(){this.renderer.renderBackground(t,e,t.borders.borders.map(j))}),this),this.renderer.clip(t.clip,(function(){this.renderer.renderBorders(t.borders.borders)}),this),this.renderer.clip(t.backgroundClip,(function(){switch(t.node.nodeName){case"svg":case"IFRAME":var n=this.images.get(t.node);n?this.renderer.renderImage(t,e,t.borders,n):o("Error loading <"+t.node.nodeName+">",t.node);break;case"IMG":var i=this.images.get(t.node.src);i?this.renderer.renderImage(t,e,t.borders,i):o("Error loading <img>",t.node.src);break;case"CANVAS":this.renderer.renderImage(t,e,t.borders,{image:t.node});break;case"SELECT":case"INPUT":case"TEXTAREA":this.paintFormValue(t)}}),this)},v.prototype.paintCheckbox=function(t){var e=t.parseBounds(),n=Math.min(e.width,e.height),i={width:n-1,height:n-1,top:e.top,left:e.left},o=[3,3],r=[o,o,o,o],a=[1,1,1,1].map((function(t){return{color:new c("#A5A5A5"),width:t}})),s=I(i,r,a);this.renderer.clip(t.backgroundClip,(function(){this.renderer.rectangle(i.left+1,i.top+1,i.width-2,i.height-2,new c("#DEDEDE")),this.renderer.renderBorders(T(a,i,s,r)),t.node.checked&&(this.renderer.font(new c("#424242"),"normal","normal","bold",n-3+"px","arial"),this.renderer.text("✔",i.left+n/6,i.top+n-1))}),this)},v.prototype.paintRadio=function(t){var e=t.parseBounds(),n=Math.min(e.width,e.height)-2;this.renderer.clip(t.backgroundClip,(function(){this.renderer.circleStroke(e.left+1,e.top+1,n,new c("#DEDEDE"),1,new c("#A5A5A5")),t.node.checked&&this.renderer.circle(Math.ceil(e.left+n/4)+1,Math.ceil(e.top+n/4)+1,Math.floor(n/2),new c("#424242"))}),this)},v.prototype.paintFormValue=function(t){var e=t.getValue();if(e.length>0){var n=t.node.ownerDocument,i=n.createElement("html2canvaswrapper");["lineHeight","textAlign","fontFamily","fontWeight","fontSize","color","paddingLeft","paddingTop","paddingRight","paddingBottom","width","height","borderLeftStyle","borderTopStyle","borderLeftWidth","borderTopWidth","boxSizing","whiteSpace","wordWrap"].forEach((function(e){try{i.style[e]=t.css(e)}catch(e){o("html2canvas: Parse: Exception caught in renderFormValue: "+e.message)}}));var r=t.parseBounds();i.style.position="fixed",i.style.left=r.left+"px",i.style.top=r.top+"px",i.textContent=e,n.body.appendChild(i),this.paintText(new s(i.firstChild,t)),n.body.removeChild(i)}},v.prototype.paintText=function(t){t.applyTextTransform();var e=r.ucs2.decode(t.node.data),n=this.options.letterRendering&&!function(t){return/^(normal|none|0px)$/.test(t.parent.css("letterSpacing"))}(t)||function(t){return/[^\u0000-\u00ff]/.test(t)}(t.node.data)?e.map((function(t){return r.ucs2.encode([t])})):function(t){var e,n=[],i=0,o=!1;for(;t.length;)q(t[i])===o?((e=t.splice(0,i)).length&&n.push(r.ucs2.encode(e)),o=!o,i=0):i++,i>=t.length&&(e=t.splice(0,i)).length&&n.push(r.ucs2.encode(e));return n}(e),i=t.parent.fontWeight(),o=t.parent.css("fontSize"),a=t.parent.css("fontFamily"),s=t.parent.parseTextShadows();this.renderer.font(t.parent.color("color"),t.parent.css("fontStyle"),t.parent.css("fontVariant"),i,o,a),s.length?this.renderer.fontShadow(s[0].color,s[0].offsetX,s[0].offsetY,s[0].blur):this.renderer.clearShadow(),this.renderer.clip(t.parent.clip,(function(){n.map(this.parseTextBounds(t),this).forEach((function(e,i){e&&(this.renderer.text(n[i],e.left,e.bottom),this.renderTextDecoration(t.parent,e,this.fontMetrics.getMetrics(a,o)))}),this)}),this)},v.prototype.renderTextDecoration=function(t,e,n){switch(t.css("textDecoration").split(" ")[0]){case"underline":this.renderer.rectangle(e.left,Math.round(e.top+n.baseline+n.lineWidth),e.width,1,t.color("color"));break;case"overline":this.renderer.rectangle(e.left,Math.round(e.top),e.width,1,t.color("color"));break;case"line-through":this.renderer.rectangle(e.left,Math.ceil(e.top+n.middle+n.lineWidth),e.width,1,t.color("color"))}};var C={inset:[["darken",.6],["darken",.1],["darken",.1],["darken",.6]]};function T(t,e,n,i){return t.map((function(o,r){if(o.width>0){var a=e.left,s=e.top,u=e.width,l=e.height-t[2].width;switch(r){case 0:l=t[0].width,o.args=E({c1:[a,s],c2:[a+u,s],c3:[a+u-t[1].width,s+l],c4:[a+t[3].width,s+l]},i[0],i[1],n.topLeftOuter,n.topLeftInner,n.topRightOuter,n.topRightInner);break;case 1:a=e.left+e.width-t[1].width,u=t[1].width,o.args=E({c1:[a+u,s],c2:[a+u,s+l+t[2].width],c3:[a,s+l],c4:[a,s+t[0].width]},i[1],i[2],n.topRightOuter,n.topRightInner,n.bottomRightOuter,n.bottomRightInner);break;case 2:s=s+e.height-t[2].width,l=t[2].width,o.args=E({c1:[a+u,s+l],c2:[a,s+l],c3:[a+t[3].width,s],c4:[a+u-t[3].width,s]},i[2],i[3],n.bottomRightOuter,n.bottomRightInner,n.bottomLeftOuter,n.bottomLeftInner);break;case 3:u=t[3].width,o.args=E({c1:[a,s+l+t[2].width],c2:[a,s],c3:[a+u,s+t[0].width],c4:[a+u,s+l]},i[3],i[0],n.bottomLeftOuter,n.bottomLeftInner,n.topLeftOuter,n.topLeftInner)}}return o}))}function w(t,e,n,i){var o=(Math.sqrt(2)-1)/3*4,r=n*o,a=i*o,s=t+n,u=e+i;return{topLeft:A({x:t,y:u},{x:t,y:u-a},{x:s-r,y:e},{x:s,y:e}),topRight:A({x:t,y:e},{x:t+r,y:e},{x:s,y:u-a},{x:s,y:u}),bottomRight:A({x:s,y:e},{x:s,y:e+a},{x:t+r,y:u},{x:t,y:u}),bottomLeft:A({x:s,y:u},{x:s-r,y:u},{x:t,y:e+a},{x:t,y:e})}}function I(t,e,n){var i=t.left,o=t.top,r=t.width,a=t.height,s=e[0][0]<r/2?e[0][0]:r/2,u=e[0][1]<a/2?e[0][1]:a/2,l=e[1][0]<r/2?e[1][0]:r/2,c=e[1][1]<a/2?e[1][1]:a/2,d=e[2][0]<r/2?e[2][0]:r/2,p=e[2][1]<a/2?e[2][1]:a/2,g=e[3][0]<r/2?e[3][0]:r/2,f=e[3][1]<a/2?e[3][1]:a/2,h=r-l,m=a-p,v=r-d,y=a-f;return{topLeftOuter:w(i,o,s,u).topLeft.subdivide(.5),topLeftInner:w(i+n[3].width,o+n[0].width,Math.max(0,s-n[3].width),Math.max(0,u-n[0].width)).topLeft.subdivide(.5),topRightOuter:w(i+h,o,l,c).topRight.subdivide(.5),topRightInner:w(i+Math.min(h,r+n[3].width),o+n[0].width,h>r+n[3].width?0:l-n[3].width,c-n[0].width).topRight.subdivide(.5),bottomRightOuter:w(i+v,o+m,d,p).bottomRight.subdivide(.5),bottomRightInner:w(i+Math.min(v,r-n[3].width),o+Math.min(m,a+n[0].width),Math.max(0,d-n[1].width),p-n[2].width).bottomRight.subdivide(.5),bottomLeftOuter:w(i,o+y,g,f).bottomLeft.subdivide(.5),bottomLeftInner:w(i+n[3].width,o+y,Math.max(0,g-n[3].width),f-n[2].width).bottomLeft.subdivide(.5)}}function A(t,e,n,i){var o=function(t,e,n){return{x:t.x+(e.x-t.x)*n,y:t.y+(e.y-t.y)*n}};return{start:t,startControl:e,endControl:n,end:i,subdivide:function(r){var a=o(t,e,r),s=o(e,n,r),u=o(n,i,r),l=o(a,s,r),c=o(s,u,r),d=o(l,c,r);return[A(t,a,l,d),A(d,c,u,i)]},curveTo:function(t){t.push(["bezierCurve",e.x,e.y,n.x,n.y,i.x,i.y])},curveToReversed:function(i){i.push(["bezierCurve",n.x,n.y,e.x,e.y,t.x,t.y])}}}function E(t,e,n,i,o,r,a){var s=[];return e[0]>0||e[1]>0?(s.push(["line",i[1].start.x,i[1].start.y]),i[1].curveTo(s)):s.push(["line",t.c1[0],t.c1[1]]),n[0]>0||n[1]>0?(s.push(["line",r[0].start.x,r[0].start.y]),r[0].curveTo(s),s.push(["line",a[0].end.x,a[0].end.y]),a[0].curveToReversed(s)):(s.push(["line",t.c2[0],t.c2[1]]),s.push(["line",t.c3[0],t.c3[1]])),e[0]>0||e[1]>0?(s.push(["line",o[1].end.x,o[1].end.y]),o[1].curveToReversed(s)):s.push(["line",t.c4[0],t.c4[1]]),s}function F(t,e,n,i,o,r,a){e[0]>0||e[1]>0?(t.push(["line",i[0].start.x,i[0].start.y]),i[0].curveTo(t),i[1].curveTo(t)):t.push(["line",r,a]),(n[0]>0||n[1]>0)&&t.push(["line",o[0].start.x,o[0].start.y])}function _(t){return t.cssInt("zIndex")<0}function O(t){return t.cssInt("zIndex")>0}function N(t){return 0===t.cssInt("zIndex")}function D(t){return-1!==["inline","inline-block","inline-table"].indexOf(t.css("display"))}function x(t){return t instanceof d}function P(t){return t.node.data.trim().length>0}function L(t){return t.nodeType===Node.TEXT_NODE||t.nodeType===Node.ELEMENT_NODE}function U(t){return"static"!==t.css("position")}function k(t){return"none"!==t.css("float")}function B(t){var e=this;return function(){return!t.apply(e,arguments)}}function M(t){return t.node.nodeType===Node.ELEMENT_NODE}function R(t){return!0===t.isPseudoElement}function V(t){return t.node.nodeType===Node.TEXT_NODE}function G(t){return parseInt(t,10)}function j(t){return t.width}function z(t){return t.node.nodeType!==Node.ELEMENT_NODE||-1===["SCRIPT","HEAD","TITLE","OBJECT","BR","OPTION"].indexOf(t.node.nodeName)}function W(t){return[].concat.apply([],t)}function q(t){return-1!==[32,13,10,9,45].indexOf(t)}v.prototype.parseBorders=function(t){var e=t.parseBounds(),n=function(t){return["TopLeft","TopRight","BottomRight","BottomLeft"].map((function(e){var n=t.css("border"+e+"Radius").split(" ");return n.length<=1&&(n[1]=n[0]),n.map(G)}))}(t),i=["Top","Right","Bottom","Left"].map((function(e,n){var i=t.css("border"+e+"Style"),o=t.color("border"+e+"Color");"inset"===i&&o.isBlack()&&(o=new c([255,255,255,o.a]));var r=C[i]?C[i][n]:null;return{width:t.cssInt("border"+e+"Width"),color:r?o[r[0]](r[1]):o,args:null}})),o=I(e,n,i);return{clip:this.parseBackgroundClip(t,o,i,n,e),borders:T(i,e,o,n)}},v.prototype.parseBackgroundClip=function(t,e,n,i,o){var r=[];switch(t.css("backgroundClip")){case"content-box":case"padding-box":F(r,i[0],i[1],e.topLeftInner,e.topRightInner,o.left+n[3].width,o.top+n[0].width),F(r,i[1],i[2],e.topRightInner,e.bottomRightInner,o.left+o.width-n[1].width,o.top+n[0].width),F(r,i[2],i[3],e.bottomRightInner,e.bottomLeftInner,o.left+o.width-n[1].width,o.top+o.height-n[2].width),F(r,i[3],i[0],e.bottomLeftInner,e.topLeftInner,o.left+n[3].width,o.top+o.height-n[2].width);break;default:F(r,i[0],i[1],e.topLeftOuter,e.topRightOuter,o.left,o.top),F(r,i[1],i[2],e.topRightOuter,e.bottomRightOuter,o.left+o.width,o.top),F(r,i[2],i[3],e.bottomRightOuter,e.bottomLeftOuter,o.left+o.width,o.top+o.height),F(r,i[3],i[0],e.bottomLeftOuter,e.topLeftOuter,o.left,o.top+o.height)}return r},e.exports=v},{"./color":3,"./fontmetrics":7,"./log":13,"./nodecontainer":14,"./pseudoelementcontainer":18,"./stackingcontext":21,"./textcontainer":25,"./utils":26,punycode:1}],16:[function(t,e,i){var o=t("./xhr"),r=t("./utils"),a=t("./log"),s=t("./clone"),u=r.decode64;function l(t,e,i){var r="withCredentials"in new XMLHttpRequest;if(!e)return n.reject("No proxy configured");var a=p(r),s=g(e,t,a);return r?o(s):d(i,s,a).then((function(t){return u(t.content)}))}var c=0;function d(t,e,i){return new n((function(n,o){var r=t.createElement("script"),a=function(){delete window.OfficeBrowserFeedback.html2canvas.proxy[i],t.body.removeChild(r)};window.OfficeBrowserFeedback.html2canvas.proxy[i]=function(t){a(),n(t)},r.src=e,r.onerror=function(t){a(),o(t)},t.body.appendChild(r)}))}function p(t){return t?"":"html2canvas_"+Date.now()+"_"+ ++c+"_"+Math.round(1e5*Math.random())}function g(t,e,n){return t+"?url="+encodeURIComponent(e)+(n.length?"&callback=html2canvas.proxy."+n:"")}i.Proxy=l,i.ProxyURL=function(t,e,i){var o="crossOrigin"in new Image,r=p(o),a=g(e,t,r);return o?n.resolve(a):d(i,a,r).then((function(t){return"data:"+t.type+";base64,"+t.content}))},i.loadUrlDocument=function(t,e,n,i,o,r){return new l(t,e,window.document).then(function(t){return function(e){var n,i=new DOMParser;try{n=i.parseFromString(e,"text/html")}catch(i){a("DOMParser not supported, falling back to createHTMLDocument"),n=document.implementation.createHTMLDocument("");try{n.open(),n.write(e),n.close()}catch(i){a("createHTMLDocument write not supported, falling back to document.body.innerHTML"),n.body.innerHTML=e}}var o=n.querySelector("base");if(!o||!o.href.host){var r=n.createElement("base");r.href=t,n.head.insertBefore(r,n.head.firstChild)}return n}}(t)).then((function(t){return s(t,n,i,o,r,0,0)}))}},{"./clone":2,"./log":13,"./utils":26,"./xhr":28}],17:[function(t,e,i){var o=t("./proxy").ProxyURL;e.exports=function(t,e){var i=document.createElement("a");i.href=t,t=i.href,this.src=t,this.image=new Image;var r=this;this.promise=new n((function(n,i){r.image.crossOrigin="Anonymous",r.image.onload=n,r.image.onerror=i,new o(t,e,document).then((function(t){r.image.src=t})).catch(i)}))}},{"./proxy":16}],18:[function(t,e,n){var i=t("./nodecontainer");function o(t,e,n){i.call(this,t,e),this.isPseudoElement=!0,this.before=":before"===n}o.prototype.cloneTo=function(t){o.prototype.cloneTo.call(this,t),t.isPseudoElement=!0,t.before=this.before},o.prototype=Object.create(i.prototype),o.prototype.appendToDOM=function(){this.before?this.parent.node.insertBefore(this.node,this.parent.node.firstChild):this.parent.node.appendChild(this.node),this.parent.node.className+=" "+this.getHideClass()},o.prototype.cleanDOM=function(){this.node.parentNode.removeChild(this.node),this.parent.node.className=this.parent.node.className.replace(this.getHideClass(),"")},o.prototype.getHideClass=function(){return this["PSEUDO_HIDE_ELEMENT_CLASS_"+(this.before?"BEFORE":"AFTER")]},o.prototype.PSEUDO_HIDE_ELEMENT_CLASS_BEFORE="___html2canvas___pseudoelement_before",o.prototype.PSEUDO_HIDE_ELEMENT_CLASS_AFTER="___html2canvas___pseudoelement_after",e.exports=o},{"./nodecontainer":14}],19:[function(t,e,n){var i=t("./log");function o(t,e,n,i,o){this.width=t,this.height=e,this.images=n,this.options=i,this.document=o}o.prototype.renderImage=function(t,e,n,i){var o=t.cssInt("paddingLeft"),r=t.cssInt("paddingTop"),a=t.cssInt("paddingRight"),s=t.cssInt("paddingBottom"),u=n.borders,l=e.width-(u[1].width+u[3].width+o+a),c=e.height-(u[0].width+u[2].width+r+s);this.drawImage(i,0,0,i.image.width||l,i.image.height||c,e.left+o+u[3].width,e.top+r+u[0].width,l,c)},o.prototype.renderBackground=function(t,e,n){e.height>0&&e.width>0&&(this.renderBackgroundColor(t,e),this.renderBackgroundImage(t,e,n))},o.prototype.renderBackgroundColor=function(t,e){var n=t.color("backgroundColor");n.isTransparent()||this.rectangle(e.left,e.top,e.width,e.height,n)},o.prototype.renderBorders=function(t){t.forEach(this.renderBorder,this)},o.prototype.renderBorder=function(t){t.color.isTransparent()||null===t.args||this.drawShape(t.args,t.color)},o.prototype.renderBackgroundImage=function(t,e,n){t.parseBackgroundImages().reverse().forEach((function(o,r,a){switch(o.method){case"url":var s=this.images.get(o.args[0]);s?this.renderBackgroundRepeating(t,e,s,a.length-(r+1),n):i("Error loading background-image",o.args[0]);break;case"linear-gradient":case"gradient":var u=this.images.get(o.value);u?this.renderBackgroundGradient(u,e,n):i("Error loading background-image",o.args[0]);break;case"none":break;default:i("Unknown background-image type",o.args[0])}}),this)},o.prototype.renderBackgroundRepeating=function(t,e,n,i,o){var r=t.parseBackgroundSize(e,n.image,i),a=t.parseBackgroundPosition(e,n.image,i,r);switch(t.parseBackgroundRepeat(i)){case"repeat-x":case"repeat no-repeat":this.backgroundRepeatShape(n,a,r,e,e.left+o[3],e.top+a.top+o[0],99999,r.height,o);break;case"repeat-y":case"no-repeat repeat":this.backgroundRepeatShape(n,a,r,e,e.left+a.left+o[3],e.top+o[0],r.width,99999,o);break;case"no-repeat":this.backgroundRepeatShape(n,a,r,e,e.left+a.left+o[3],e.top+a.top+o[0],r.width,r.height,o);break;default:this.renderBackgroundRepeat(n,a,r,{top:e.top,left:e.left},o[3],o[0])}},e.exports=o},{"./log":13}],20:[function(t,e,n){var i=t("../renderer"),o=t("../lineargradientcontainer"),a=t("../log");function s(t,e){i.apply(this,arguments),this.canvas=this.options.canvas||this.document.createElement("canvas"),this.options.canvas||(this.canvas.width=t,this.canvas.height=e),this.ctx=this.canvas.getContext("2d"),this.taintCtx=this.document.createElement("canvas").getContext("2d"),this.ctx.textBaseline="bottom",this.variables={},a("Initialized CanvasRenderer with size",t,"x",e)}function u(t){return t.length>0}s.prototype=Object.create(i.prototype),s.prototype.setFillStyle=function(t){return this.ctx.fillStyle="object"===r(t)&&t.isColor?t.toString():t,this.ctx},s.prototype.rectangle=function(t,e,n,i,o){this.setFillStyle(o).fillRect(t,e,n,i)},s.prototype.circle=function(t,e,n,i){this.setFillStyle(i),this.ctx.beginPath(),this.ctx.arc(t+n/2,e+n/2,n/2,0,2*Math.PI,!0),this.ctx.closePath(),this.ctx.fill()},s.prototype.circleStroke=function(t,e,n,i,o,r){this.circle(t,e,n,i),this.ctx.strokeStyle=r.toString(),this.ctx.stroke()},s.prototype.drawShape=function(t,e){this.shape(t),this.setFillStyle(e).fill()},s.prototype.taints=function(t){if(null===t.tainted){this.taintCtx.drawImage(t.image,0,0);try{this.taintCtx.getImageData(0,0,1,1),t.tainted=!1}catch(e){this.taintCtx=document.createElement("canvas").getContext("2d"),t.tainted=!0}}return t.tainted},s.prototype.drawImage=function(t,e,n,i,o,r,a,s,u){this.taints(t)&&!this.options.allowTaint||this.ctx.drawImage(t.image,e,n,i,o,r,a,s,u)},s.prototype.clip=function(t,e,n){this.ctx.save(),t.filter(u).forEach((function(t){this.shape(t).clip()}),this),e.call(n),this.ctx.restore()},s.prototype.shape=function(t){return this.ctx.beginPath(),t.forEach((function(t,e){"rect"===t[0]?this.ctx.rect.apply(this.ctx,t.slice(1)):this.ctx[0===e?"moveTo":t[0]+"To"].apply(this.ctx,t.slice(1))}),this),this.ctx.closePath(),this.ctx},s.prototype.font=function(t,e,n,i,o,r){this.setFillStyle(t).font=[e,n,i,o,r].join(" ").split(",")[0]},s.prototype.fontShadow=function(t,e,n,i){this.setVariable("shadowColor",t.toString()).setVariable("shadowOffsetY",e).setVariable("shadowOffsetX",n).setVariable("shadowBlur",i)},s.prototype.clearShadow=function(){this.setVariable("shadowColor","rgba(0,0,0,0)")},s.prototype.setOpacity=function(t){this.ctx.globalAlpha=t},s.prototype.setTransform=function(t){this.ctx.translate(t.origin[0],t.origin[1]),this.ctx.transform.apply(this.ctx,t.matrix),this.ctx.translate(-t.origin[0],-t.origin[1])},s.prototype.setVariable=function(t,e){return this.variables[t]!==e&&(this.variables[t]=this.ctx[t]=e),this},s.prototype.text=function(t,e,n){this.ctx.fillText(t,e,n)},s.prototype.backgroundRepeatShape=function(t,e,n,i,o,r,a,s,u){var l=[["line",Math.round(o),Math.round(r)],["line",Math.round(o+a),Math.round(r)],["line",Math.round(o+a),Math.round(s+r)],["line",Math.round(o),Math.round(s+r)]];this.clip([l],(function(){this.renderBackgroundRepeat(t,e,n,i,u[3],u[0])}),this)},s.prototype.renderBackgroundRepeat=function(t,e,n,i,o,r){var a=Math.round(i.left+e.left+o),s=Math.round(i.top+e.top+r);this.setFillStyle(this.ctx.createPattern(this.resizeImage(t,n),"repeat")),this.ctx.translate(a,s),this.ctx.fill(),this.ctx.translate(-a,-s)},s.prototype.renderBackgroundGradient=function(t,e){if(t instanceof o){var n=this.ctx.createLinearGradient(e.left+e.width*t.x0,e.top+e.height*t.y0,e.left+e.width*t.x1,e.top+e.height*t.y1);t.colorStops.forEach((function(t){n.addColorStop(t.stop,t.color.toString())})),this.rectangle(e.left,e.top,e.width,e.height,n)}},s.prototype.resizeImage=function(t,e){var n=t.image;if(n.width===e.width&&n.height===e.height)return n;var i=document.createElement("canvas");return i.width=e.width,i.height=e.height,i.getContext("2d").drawImage(n,0,0,n.width,n.height,0,0,e.width,e.height),i},e.exports=s},{"../lineargradientcontainer":12,"../log":13,"../renderer":19}],21:[function(t,e,n){var i=t("./nodecontainer");function o(t,e,n,o){i.call(this,n,o),this.ownStacking=t,this.contexts=[],this.children=[],this.opacity=(this.parent?this.parent.stack.opacity:1)*e}o.prototype=Object.create(i.prototype),o.prototype.getParentStack=function(t){var e=this.parent?this.parent.stack:null;return e?e.ownStacking?e:e.getParentStack(t):t.stack},e.exports=o},{"./nodecontainer":14}],22:[function(t,e,n){function i(t){this.rangeBounds=this.testRangeBounds(t),this.cors=this.testCORS(),this.svg=this.testSVG()}i.prototype.testRangeBounds=function(t){var e,n,i=!1;return t.createRange&&(e=t.createRange()).getBoundingClientRect&&((n=t.createElement("boundtest")).style.height="123px",n.style.display="block",t.body.appendChild(n),e.selectNode(n),123===e.getBoundingClientRect().height&&(i=!0),t.body.removeChild(n)),i},i.prototype.testCORS=function(){return void 0!==(new Image).crossOrigin},i.prototype.testSVG=function(){var t=new Image,e=document.createElement("canvas"),n=e.getContext("2d");t.src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'></svg>";try{n.drawImage(t,0,0),e.toDataURL()}catch(t){return!1}return!0},e.exports=i},{}],23:[function(t,e,i){var o=t("./xhr"),r=t("./utils").decode64;function a(t){this.src=t,this.image=null;var e=this;this.promise=this.hasFabric().then((function(){return e.isInline(t)?n.resolve(e.inlineFormatting(t)):o(t)})).then((function(t){return new n((function(n){window.OfficeBrowserFeedback.html2canvas.svg.fabric.loadSVGFromString(t,e.createCanvas.call(e,n))}))}))}a.prototype.hasFabric=function(){return window.OfficeBrowserFeedback.html2canvas.svg&&window.OfficeBrowserFeedback.html2canvas.svg.fabric?n.resolve():n.reject(new Error("html2canvas.svg.js is not loaded, cannot render svg"))},a.prototype.inlineFormatting=function(t){return/^data:image\/svg\+xml;base64,/.test(t)?this.decode64(this.removeContentType(t)):this.removeContentType(t)},a.prototype.removeContentType=function(t){return t.replace(/^data:image\/svg\+xml(;base64)?,/,"")},a.prototype.isInline=function(t){return/^data:image\/svg\+xml/i.test(t)},a.prototype.createCanvas=function(t){var e=this;return function(n,i){var o=new window.OfficeBrowserFeedback.html2canvas.svg.fabric.StaticCanvas("c");e.image=o.lowerCanvasEl,o.setWidth(i.width).setHeight(i.height).add(window.OfficeBrowserFeedback.html2canvas.svg.fabric.util.groupSVGElements(n,i)).renderAll(),t(o.lowerCanvasEl)}},a.prototype.decode64=function(t){return"function"==typeof window.atob?window.atob(t):r(t)},e.exports=a},{"./utils":26,"./xhr":28}],24:[function(t,e,i){var o=t("./svgcontainer");function r(t,e){this.src=t,this.image=null;var i=this;this.promise=e?new n((function(e,n){i.image=new Image,i.image.onload=e,i.image.onerror=n,i.image.src="data:image/svg+xml,"+(new XMLSerializer).serializeToString(t),!0===i.image.complete&&e(i.image)})):this.hasFabric().then((function(){return new n((function(e){window.OfficeBrowserFeedback.html2canvas.svg.fabric.parseSVGDocument(t,i.createCanvas.call(i,e))}))}))}r.prototype=Object.create(o.prototype),e.exports=r},{"./svgcontainer":23}],25:[function(t,e,n){var i=t("./nodecontainer");function o(t,e){i.call(this,t,e)}function r(t,e,n){if(t.length>0)return e+n.toUpperCase()}o.prototype=Object.create(i.prototype),o.prototype.applyTextTransform=function(){this.node.data=this.transform(this.parent.css("textTransform"))},o.prototype.transform=function(t){var e=this.node.data;switch(t){case"lowercase":return e.toLowerCase();case"capitalize":return e.replace(/(^|\s|:|-|\(|\))([a-z])/g,r);case"uppercase":return e.toUpperCase();default:return e}},e.exports=o},{"./nodecontainer":14}],26:[function(t,e,n){n.smallImage=function(){return"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"},n.bind=function(t,e){return function(){return t.apply(e,arguments)}},n.decode64=function(t){var e,n,i,o,r,a,s,u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",l=t.length,c="";for(e=0;e<l;e+=4)r=u.indexOf(t[e])<<2|(n=u.indexOf(t[e+1]))>>4,a=(15&n)<<4|(i=u.indexOf(t[e+2]))>>2,s=(3&i)<<6|(o=u.indexOf(t[e+3])),c+=64===i?String.fromCharCode(r):64===o||-1===o?String.fromCharCode(r,a):String.fromCharCode(r,a,s);return c},n.getBounds=function(t){if(t.getBoundingClientRect){var e=t.getBoundingClientRect(),n=null==t.offsetWidth?e.width:t.offsetWidth;return{top:e.top,bottom:e.bottom||e.top+e.height,right:e.left+n,left:e.left,width:n,height:null==t.offsetHeight?e.height:t.offsetHeight}}return{}},n.offsetBounds=function(t){var e=t.offsetParent?n.offsetBounds(t.offsetParent):{top:0,left:0};return{top:t.offsetTop+e.top,bottom:t.offsetTop+t.offsetHeight+e.top,right:t.offsetLeft+e.left+t.offsetWidth,left:t.offsetLeft+e.left,width:t.offsetWidth,height:t.offsetHeight}},n.parseBackgrounds=function(t){var e,n,i,o,r,a,s,u=[],l=0,c=0,d=function(){e&&('"'===n.substr(0,1)&&(n=n.substr(1,n.length-2)),n&&s.push(n),"-"===e.substr(0,1)&&(o=e.indexOf("-",1)+1)>0&&(i=e.substr(0,o),e=e.substr(o)),u.push({prefix:i,method:e.toLowerCase(),value:r,args:s,image:null})),s=[],e=i=n=r=""};return s=[],e=i=n=r="",t.split("").forEach((function(t){if(!(0===l&&" \r\n\t".indexOf(t)>-1)){switch(t){case'"':a?a===t&&(a=null):a=t;break;case"(":if(a)break;if(0===l)return l=1,void(r+=t);c++;break;case")":if(a)break;if(1===l){if(0===c)return l=0,r+=t,void d();c--}break;case",":if(a)break;if(0===l)return void d();if(1===l&&0===c&&!e.match(/^url$/i))return s.push(n),n="",void(r+=t)}r+=t,0===l?e+=t:n+=t}})),d(),u}},{}],27:[function(t,e,n){var i=t("./gradientcontainer");function o(t){i.apply(this,arguments),this.type="linear"===t.args[0]?i.TYPES.LINEAR:i.TYPES.RADIAL}o.prototype=Object.create(i.prototype),e.exports=o},{"./gradientcontainer":9}],28:[function(t,e,i){e.exports=function(t){return new n((function(e,n){var i=new XMLHttpRequest;i.open("GET",t),i.onload=function(){200===i.status?e(i.responseText):n(new Error(i.statusText))},i.onerror=function(){n(new Error("Network Error"))},i.send()}))}},{}]},{},[4])(4)}}).call(this,void 0!==t?t:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"es6-promise":45}]},{},[52,53,113])}).call(this,n("./node_modules/webpack-stream/node_modules/webpack/buildin/global.js"))}})},t.exports=i()}},t.c=n,t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:i})},t.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(t.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var o in e)t.d(i,o,function(t){return e[t]}.bind(null,o));return i},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},t.p="",Object.defineProperty(t,"p",{get:function(){try{if("string"!=typeof streamFullStaticPath)throw new Error("WebpackRequireFrom: 'streamFullStaticPath' is not a string or not available at runtime. See https://github.com/agoldis/webpack-require-from#troubleshooting");return streamFullStaticPath}catch(t){return""}}}),t(t.s=132);function t(i){if(n[i])return n[i].exports;var o=n[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var e,n}));